----------------------------------------------------------------
File: .env.example
----------------------------------------------------------------
NEXT_PUBLIC_API_URL=http://localhost:3001/api


----------------------------------------------------------------
File: .env.local
----------------------------------------------------------------
NEXT_PUBLIC_API_URL=http://localhost:3001/api


----------------------------------------------------------------
File: next-env.d.ts
----------------------------------------------------------------
/// <reference types="next" />
/// <reference types="next/image-types/global" />
import "./.next/dev/types/routes.d.ts";

// NOTE: This file should not be edited
// see https://nextjs.org/docs/app/api-reference/config/typescript for more information.


----------------------------------------------------------------
File: package.json
----------------------------------------------------------------
{
  "dependencies": {
    "@radix-ui/react-slot": "^1.2.4",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "framer-motion": "^12.34.0",
    "lucide-react": "^0.563.0",
    "next": "^16.1.6",
    "react": "^19.2.4",
    "react-dom": "^19.2.4",
    "tailwind-merge": "^3.4.0",
    "typeorm": "^0.3.28",
    "zod": "^4.3.6",
    "zustand": "^5.0.11"
  },
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint"
  },
  "devDependencies": {
    "@types/node": "^25.2.3",
    "@types/react": "^19.2.14",
    "autoprefixer": "^10.4.24",
    "eslint": "^9.39.2",
    "eslint-config-next": "^16.1.6",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.17",
    "typescript": "^5.9.3"
  }
}


----------------------------------------------------------------
File: postcss.config.js
----------------------------------------------------------------
module.exports = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}


----------------------------------------------------------------
File: scripts\verify-scoring.ts
----------------------------------------------------------------

import { calculateGap, normalizeGap } from '../src/lib/scoring/number';
import { calculatePriorityScore } from '../src/lib/scoring/compute';

console.log('--- Verifying Scoring Logic ---');

const testCases = [
  { target: 3, current: 2, expectedGap: 1, desc: 'Gap 1.0 (Underperforming)' },
  { target: 3, current: 3, expectedGap: 0, desc: 'Gap 0.0 (On Target)' },
  { target: 3, current: 4, expectedGap: 0, desc: 'Gap -1.0 (Overperforming -> 0)' },
  { target: 3, current: 5, expectedGap: 0, desc: 'Gap -2.0 (Overperforming -> 0)' },
];

let failed = false;

testCases.forEach(({ target, current, expectedGap, desc }) => {
  const gap = calculateGap(target, current);
  if (gap !== expectedGap) {
    console.error(`[FAIL] ${desc}: Expected ${expectedGap}, got ${gap}`);
    failed = true;
  } else {
    console.log(`[PASS] ${desc}`);
  }
});

const priority = calculatePriorityScore(5, 3, 0); // Current 5, Target 3, Gap 0
console.log(`Priority (Current=5, Target=3, Gap=0): ${priority}`);
if (priority > 1.0) { // Should be low priority
    console.warn('[WARN] Priority seems high for over-performing item');
}

if (failed) {
  console.error('--- Verification FAILED ---');
  process.exit(1);
} else {
  console.log('--- Verification PASSED ---');
}


----------------------------------------------------------------
File: src\app\admin\analytics\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState, useCallback } from 'react';
import { AnalyticsAPI, DashboardAPI } from '@/lib/api/adminEndpoints';
import { AnalyticsData, AnalyticsDimensionBreakdown, DashboardStats } from '@/lib/api/adminTypes';
import { StatCard } from '@/components/admin/StatCard';
import { 
  ClipboardList, 
  Users, 
  TrendingUp, 
  Target,
  Download,
  BarChart3,
  Activity,
  AlertCircle
} from 'lucide-react';

export default function AdminAnalyticsPage() {
  const [analyticsData, setAnalyticsData] = useState<AnalyticsData | null>(null);
  const [dimensionBreakdown, setDimensionBreakdown] = useState<AnalyticsDimensionBreakdown[]>([]);
  const [dashboardStats, setDashboardStats] = useState<DashboardStats | null>(null);
  const [isLoadingAnalytics, setIsLoadingAnalytics] = useState(true);
  const [isLoadingDimensions, setIsLoadingDimensions] = useState(true);
  const [isLoadingStats, setIsLoadingStats] = useState(true);
  const [isExporting, setIsExporting] = useState(false);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const fetchAnalyticsData = async () => {
      try {
        setIsLoadingAnalytics(true);
        const data = await AnalyticsAPI.getOverview();
        setAnalyticsData(data);
      } catch (err) {
        console.error('Failed to fetch analytics:', err);
        setError('Failed to load analytics data');
      } finally {
        setIsLoadingAnalytics(false);
      }
    };

    const fetchDimensionBreakdown = async () => {
      try {
        setIsLoadingDimensions(true);
        const data = await AnalyticsAPI.getDimensionBreakdown();
        setDimensionBreakdown(data);
      } catch (err) {
        console.error('Failed to fetch dimension breakdown:', err);
      } finally {
        setIsLoadingDimensions(false);
      }
    };

    const fetchDashboardStats = async () => {
      try {
        setIsLoadingStats(true);
        const data = await DashboardAPI.getStats('all');
        setDashboardStats(data.overview);
      } catch (err) {
        console.error('Failed to fetch dashboard stats:', err);
      } finally {
        setIsLoadingStats(false);
      }
    };

    fetchAnalyticsData();
    fetchDimensionBreakdown();
    fetchDashboardStats();
  }, []);

  const handleExportCSV = useCallback(async () => {
    try {
      setIsExporting(true);
      const data = await AnalyticsAPI.exportResponses();
      
      // Convert to CSV
      const headers = ['Response ID', 'Full Name', 'Email', 'Company', 'Overall Score', 'Overall Gap', 'Completed At'];
      const csvRows = [
        headers.join(','),
        ...data.map(row => [
          row.response_id,
          `"${row.full_name}"`,
          row.email,
          `"${row.company_name}"`,
          row.overall_score,
          row.overall_gap,
          row.completed_at
        ].join(','))
      ];
      
      const csvContent = csvRows.join('\n');
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `responses_export_${new Date().toISOString().split('T')[0]}.csv`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    } catch (err) {
      console.error('Failed to export CSV:', err);
      alert('Failed to export data. Please try again.');
    } finally {
      setIsExporting(false);
    }
  }, []);

  const stats = dashboardStats;
  const totalResponses = stats?.total_responses ?? 0;
  const avgScore = stats?.avg_overall_score ?? 0;
  const avgGap = stats?.avg_overall_gap ?? 0;
  const completionRate = stats?.completion_rate ?? 0;

  // Safe number formatter (API may return strings from PostgreSQL)
  const fmtNum = (v: unknown): string => {
    const n = v === null || v === undefined ? NaN : Number(v);
    return Number.isFinite(n) ? n.toFixed(1) : '0.0';
  };

  // Sort dimensions by gap (highest gaps first) for top gaps section
  const sortedByGap = [...dimensionBreakdown].sort((a, b) => Number(b.avg_gap) - Number(a.avg_gap));
  const topGaps = sortedByGap.slice(0, 5);

  // Calculate score distribution from dimension data
  const getScoreDistribution = () => {
    if (!dimensionBreakdown.length) return [];
    const distribution = [
      { range: '1.0-2.0', count: 0, label: '1-2' },
      { range: '2.0-3.0', count: 0, label: '2-3' },
      { range: '3.0-4.0', count: 0, label: '3-4' },
      { range: '4.0-5.0', count: 0, label: '4-5' },
    ];
    dimensionBreakdown.forEach(dim => {
      const s = Number(dim.avg_score);
      if (s >= 1 && s < 2) distribution[0].count++;
      else if (s >= 2 && s < 3) distribution[1].count++;
      else if (s >= 3 && s < 4) distribution[2].count++;
      else if (s >= 4 && s <= 5) distribution[3].count++;
    });
    return distribution;
  };

  const scoreDistribution = getScoreDistribution();
  const maxDistributionCount = Math.max(...scoreDistribution.map(d => d.count), 1);

  return (
    <div className="p-6 lg:p-8">
      {/* Page Header */}
      <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8">
        <div>
          <h1 className="text-2xl lg:text-3xl font-bold text-gray-900">Analytics</h1>
          <p className="text-gray-500 mt-1">Overview and insights from assessment responses</p>
        </div>
        <button
          onClick={handleExportCSV}
          disabled={isExporting}
          className="mt-4 sm:mt-0 inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
        >
          <Download className="w-4 h-4" />
          {isExporting ? 'Exporting...' : 'Export CSV'}
        </button>
      </div>

      {/* Error Banner */}
      {error && (
        <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
          <p className="text-red-600 text-sm">{error}</p>
        </div>
      )}

      {/* Key Metrics */}
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8">
        <StatCard
          icon={ClipboardList}
          label="Total Responses"
          value={totalResponses}
          iconColor="text-blue-600"
        />
        <StatCard
          icon={TrendingUp}
          label="Average Score"
          value={fmtNum(avgScore)}
          iconColor="text-purple-600"
        />
        <StatCard
          icon={Target}
          label="Average Gap"
          value={fmtNum(avgGap)}
          iconColor="text-orange-600"
        />
        <StatCard
          icon={Users}
          label="Completion Rate"
          value={`${fmtNum(completionRate)}%`}
          iconColor="text-green-600"
        />
      </div>

      {/* Loading skeleton for stats */}
      {isLoadingStats && (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8">
          {[...Array(4)].map((_, i) => (
            <div key={i} className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 animate-pulse">
              <div className="h-4 bg-gray-200 rounded w-1/2 mb-4"></div>
              <div className="h-8 bg-gray-200 rounded w-3/4"></div>
            </div>
          ))}
        </div>
      )}

      {/* Main Charts Grid */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        {/* Dimension Performance Chart */}
        <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <div className="flex items-center gap-2 mb-4">
            <BarChart3 className="w-5 h-5 text-blue-600" />
            <h3 className="text-lg font-semibold text-gray-900">Dimension Performance</h3>
          </div>
          
          {isLoadingDimensions ? (
            <div className="animate-pulse space-y-3">
              {[...Array(5)].map((_, i) => (
                <div key={i} className="h-8 bg-gray-200 rounded"></div>
              ))}
            </div>
          ) : dimensionBreakdown.length > 0 ? (
            <div className="space-y-3">
              {dimensionBreakdown.map((dim, index) => (
                <DimensionBarRow key={index} dimension={dim} index={index} />
              ))}
            </div>
          ) : (
            <div className="text-center py-8 text-gray-500">
              No dimension data available
            </div>
          )}
          
          {/* Legend */}
          <div className="flex justify-center gap-6 mt-4 pt-4 border-t border-gray-100">
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-blue-500" />
              <span className="text-xs text-gray-500">Score</span>
            </div>
            <div className="flex items-center gap-2">
              <div className="w-3 h-3 rounded-full bg-red-400" />
              <span className="text-xs text-gray-500">Gap</span>
            </div>
          </div>
        </div>

        {/* Responses Over Time Chart */}
        <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <div className="flex items-center gap-2 mb-4">
            <Activity className="w-5 h-5 text-green-600" />
            <h3 className="text-lg font-semibold text-gray-900">Responses Over Time</h3>
          </div>
          
          {isLoadingAnalytics ? (
            <div className="animate-pulse h-64 bg-gray-200 rounded"></div>
          ) : analyticsData?.response_trends && analyticsData.response_trends.length > 0 ? (
            <ResponseTrendChart trends={analyticsData.response_trends} />
          ) : (
            <div className="text-center py-8 text-gray-500">
              No trend data available
            </div>
          )}
        </div>
      </div>

      {/* Second Row */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        {/* Score Distribution Histogram */}
        <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <div className="flex items-center gap-2 mb-4">
            <BarChart3 className="w-5 h-5 text-purple-600" />
            <h3 className="text-lg font-semibold text-gray-900">Score Distribution</h3>
          </div>
          
          {isLoadingDimensions ? (
            <div className="animate-pulse h-48 bg-gray-200 rounded"></div>
          ) : (
            <div className="flex items-end justify-between h-48 gap-2">
              {scoreDistribution.map((item, index) => (
                <div key={index} className="flex-1 flex flex-col items-center">
                  <div className="w-full flex-1 flex items-end">
                    <div 
                      className="w-full bg-purple-500 rounded-t transition-all duration-500"
                      style={{ 
                        height: `${(item.count / maxDistributionCount) * 100}%`,
                        minHeight: item.count > 0 ? '8px' : '2px'
                      }}
                    />
                  </div>
                  <span className="text-xs text-gray-500 mt-2">{item.label}</span>
                  <span className="text-xs font-medium text-gray-700">{item.count}</span>
                </div>
              ))}
            </div>
          )}
        </div>

        {/* Top Gaps Summary */}
        <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 lg:col-span-2">
          <div className="flex items-center gap-2 mb-4">
            <AlertCircle className="w-5 h-5 text-red-500" />
            <h3 className="text-lg font-semibold text-gray-900">Top Priority Gaps</h3>
          </div>
          
          {isLoadingDimensions ? (
            <div className="animate-pulse space-y-3">
              {[...Array(5)].map((_, i) => (
                <div key={i} className="h-12 bg-gray-200 rounded"></div>
              ))}
            </div>
          ) : topGaps.length > 0 ? (
            <div className="space-y-3">
              {topGaps.map((gap, index) => (
                <div 
                  key={index} 
                  className="flex items-center justify-between p-3 bg-gray-50 rounded-lg"
                >
                  <div className="flex items-center gap-3">
                    <span className="flex items-center justify-center w-6 h-6 bg-red-100 text-red-600 text-xs font-bold rounded-full">
                      {index + 1}
                    </span>
                    <span className="font-medium text-gray-900">{gap.title}</span>
                  </div>
                  <div className="flex items-center gap-4">
                    <div className="text-right">
                      <span className="text-xs text-gray-500">Avg Score</span>
                      <p className="text-sm font-semibold text-gray-900">{fmtNum(gap.avg_score)}</p>
                    </div>
                    <div className="text-right">
                      <span className="text-xs text-gray-500">Gap</span>
                      <p className="text-sm font-semibold text-red-600">−{fmtNum(gap.avg_gap)}</p>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          ) : (
            <div className="text-center py-8 text-gray-500">
              No gap data available
            </div>
          )}
        </div>
      </div>

      {/* Dimension Breakdown Table */}
      <div className="mt-8 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div className="p-6 border-b border-gray-200">
          <h3 className="text-lg font-semibold text-gray-900">Dimension Breakdown</h3>
        </div>
        
        {isLoadingDimensions ? (
          <div className="animate-pulse p-6">
            <div className="h-10 bg-gray-200 rounded mb-4"></div>
            {[...Array(5)].map((_, i) => (
              <div key={i} className="h-12 bg-gray-200 rounded mb-2"></div>
            ))}
          </div>
        ) : dimensionBreakdown.length > 0 ? (
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dimension</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Category</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Score</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Avg Gap</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Range</th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {dimensionBreakdown.map((dim, index) => (
                  <tr key={index} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                      {dim.title}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {dim.category}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm">
                      <span className={`font-medium ${
                        Number(dim.avg_score) >= 4 ? 'text-green-600' :
                        Number(dim.avg_score) >= 3 ? 'text-yellow-600' : 'text-red-600'
                      }`}>
                        {fmtNum(dim.avg_score)}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm">
                      <span className={`font-medium ${
                        Number(dim.avg_gap) <= 0.5 ? 'text-green-600' :
                        Number(dim.avg_gap) <= 1.0 ? 'text-yellow-600' : 'text-red-600'
                      }`}>
                        −{fmtNum(dim.avg_gap)}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {fmtNum(dim.min_score)} - {fmtNum(dim.max_score)}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        ) : (
          <div className="text-center py-8 text-gray-500">
            No dimension breakdown data available
          </div>
        )}
      </div>

      {/* Generated At */}
      {analyticsData?.generated_at && (
        <p className="text-xs text-gray-400 mt-6 text-center">
          Data generated at: {new Date(analyticsData.generated_at).toLocaleString()}
        </p>
      )}
    </div>
  );
}

/* ─────────────────────────────────────────────────── */
/* Dimension Bar Row Component                         */
/* ─────────────────────────────────────────────────── */

interface DimensionBarRowProps {
  dimension: AnalyticsDimensionBreakdown;
  index: number;
}

function DimensionBarRow({ dimension, index }: DimensionBarRowProps) {
  const maxScore = 5;
  const avgScore = Number(dimension.avg_score);
  const avgGap = Number(dimension.avg_gap);
  const scorePct = (avgScore / maxScore) * 100;
  const gapPct = (avgGap / maxScore) * 100;
  const fmt = (v: number) => (Number.isFinite(v) ? v.toFixed(1) : '0.0');

  const getScoreColor = (score: number) => {
    if (score >= 4) return 'bg-green-500';
    if (score >= 3) return 'bg-yellow-500';
    return 'bg-red-500';
  };

  return (
    <div className="flex items-center gap-3">
      <div className="w-24 text-right text-xs font-semibold text-gray-600 truncate">
        {dimension.title}
      </div>
      <div className="flex-1 flex items-center gap-1">
        <div className="relative flex-1 h-6">
          <div className="absolute inset-0 bg-gray-100 rounded" />
          <div
            className={`absolute inset-y-0 left-0 rounded flex items-center justify-end pr-2 ${getScoreColor(avgScore)}`}
            style={{ width: `${scorePct}%` }}
          >
            <span className="text-xs font-bold text-white">{fmt(avgScore)}</span>
          </div>
        </div>
      </div>
      <div className="w-16 flex items-center justify-end">
        <div className="relative h-6 w-full">
          <div className="absolute inset-0 bg-gray-100 rounded" />
          <div
            className="absolute inset-y-0 left-0 rounded bg-red-400 flex items-center justify-end pr-2"
            style={{ width: `${Math.min(gapPct * 2, 100)}%` }}
          >
            <span className="text-xs font-bold text-white">−{fmt(avgGap)}</span>
          </div>
        </div>
      </div>
    </div>
  );
}

/* ─────────────────────────────────────────────────── */
/* Response Trend Chart Component                     */
/* ─────────────────────────────────────────────────── */

interface ResponseTrendChartProps {
  trends: { date: string; count: number; avg_score: number }[];
}

function ResponseTrendChart({ trends }: ResponseTrendChartProps) {
  const maxCount = Math.max(...trends.map(t => t.count), 1);
  const height = 200;
  
  // Simple line chart using SVG
  const width = 400;
  const padding = 30;
  const chartWidth = width - padding * 2;
  const chartHeight = height - padding * 2;
  
  const xStep = chartWidth / (trends.length - 1 || 1);
  
  const points = trends.map((t, i) => ({
    x: padding + i * xStep,
    y: padding + chartHeight - (t.count / maxCount) * chartHeight,
    ...t
  }));
  
  const pathD = points.map((p, i) => 
    i === 0 ? `M ${p.x} ${p.y}` : `L ${p.x} ${p.y}`
  ).join(' ');

  // Format date labels
  const formatDate = (dateStr: string) => {
    const date = new Date(dateStr);
    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
  };

  return (
    <div className="w-full">
      {/* SVG Line Chart */}
      <svg 
        viewBox={`0 0 ${width} ${height}`} 
        className="w-full h-auto"
        style={{ maxHeight: '200px' }}
      >
        {/* Grid lines */}
        {[0, 0.25, 0.5, 0.75, 1].map((ratio, i) => (
          <line
            key={i}
            x1={padding}
            y1={padding + chartHeight * (1 - ratio)}
            x2={width - padding}
            y2={padding + chartHeight * (1 - ratio)}
            stroke="#e5e7eb"
            strokeWidth="1"
            strokeDasharray="3,3"
          />
        ))}
        
        {/* Y-axis labels */}
        {[0, 0.25, 0.5, 0.75, 1].map((ratio, i) => (
          <text
            key={i}
            x={padding - 5}
            y={padding + chartHeight * (1 - ratio) + 4}
            textAnchor="end"
            fontSize="10"
            fill="#9ca3af"
          >
            {Math.round(maxCount * ratio)}
          </text>
        ))}
        
        {/* Line path */}
        <path
          d={pathD}
          fill="none"
          stroke="#3b82f6"
          strokeWidth="2"
          strokeLinecap="round"
          strokeLinejoin="round"
        />
        
        {/* Data points */}
        {points.map((p, i) => (
          <circle
            key={i}
            cx={p.x}
            cy={p.y}
            r="4"
            fill="#3b82f6"
            stroke="white"
            strokeWidth="2"
          />
        ))}
        
        {/* X-axis labels (show every few points) */}
        {trends.filter((_, i) => i % Math.ceil(trends.length / 5) === 0 || i === trends.length - 1).map((t, i, arr) => {
          const idx = trends.indexOf(t);
          return (
            <text
              key={idx}
              x={points[idx].x}
              y={height - 5}
              textAnchor="middle"
              fontSize="9"
              fill="#9ca3af"
            >
              {formatDate(t.date)}
            </text>
          );
        })}
      </svg>
      
      {/* Legend */}
      <div className="flex justify-center gap-6 mt-4">
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded-full bg-blue-500" />
          <span className="text-xs text-gray-500">Response Count</span>
        </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\app\admin\assessments\[id]\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState } from 'react';
import { useParams, useRouter } from 'next/navigation';
import Link from 'next/link';
import { AssessmentAdminAPI } from '@/lib/api/adminEndpoints';
import { AssessmentWithDimensions } from '@/lib/api/adminTypes';
import { AssessmentForm } from '@/components/admin/AssessmentForm';
import { 
  ArrowLeft, 
  Pencil, 
  Trash2, 
  UploadCloud, 
  XCircle,
  CheckCircle,
  FileText,
  FolderOpen,
  MessageSquare,
  Loader2,
  AlertCircle,
  Settings
} from 'lucide-react';

export default function AssessmentDetailPage() {
  const params = useParams();
  const router = useRouter();
  const assessmentId = params.id as string;

  const [assessment, setAssessment] = useState<AssessmentWithDimensions | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [isPublishing, setIsPublishing] = useState(false);
  const [isDeleting, setIsDeleting] = useState(false);
  const [showForm, setShowForm] = useState(false);
  const [deleteConfirm, setDeleteConfirm] = useState(false);
  const [toast, setToast] = useState<{ message: string; type: 'success' | 'error' } | null>(null);

  useEffect(() => {
    if (assessmentId) {
      fetchAssessment();
    }
  }, [assessmentId]);

  const fetchAssessment = async () => {
    try {
      setIsLoading(true);
      const data = await AssessmentAdminAPI.get(assessmentId);
      setAssessment(data);
    } catch (err) {
      console.error('Failed to fetch assessment:', err);
      setError('Failed to load assessment details');
    } finally {
      setIsLoading(false);
    }
  };

  const showToast = (message: string, type: 'success' | 'error') => {
    setToast({ message, type });
    setTimeout(() => setToast(null), 3000);
  };

  const handlePublish = async () => {
    if (!assessment) return;
    try {
      setIsPublishing(true);
      await AssessmentAdminAPI.publish(assessment.id, !assessment.is_published);
      showToast(
        assessment.is_published ? 'Assessment unpublished successfully' : 'Assessment published successfully',
        'success'
      );
      fetchAssessment();
    } catch (err) {
      console.error('Failed to publish/unpublish:', err);
      showToast('Failed to update publish status', 'error');
    } finally {
      setIsPublishing(false);
    }
  };

  const handleDelete = async () => {
    if (!assessment) return;
    try {
      setIsDeleting(true);
      await AssessmentAdminAPI.delete(assessment.id);
      showToast('Assessment deleted successfully', 'success');
      router.push('/admin/assessments');
    } catch (err) {
      console.error('Failed to delete:', err);
      showToast('Failed to delete assessment', 'error');
    } finally {
      setIsDeleting(false);
      setDeleteConfirm(false);
    }
  };

  const handleFormSuccess = () => {
    setShowForm(false);
    fetchAssessment();
    showToast('Assessment updated successfully', 'success');
  };

  const formatDate = (dateString: string) => {
    return new Date(dateString).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  if (isLoading) {
    return (
      <div className="p-6 lg:p-8 flex items-center justify-center min-h-[400px]">
        <Loader2 className="w-8 h-8 animate-spin text-primary" />
      </div>
    );
  }

  if (error || !assessment) {
    return (
      <div className="p-6 lg:p-8">
        <div className="mb-6">
          <Link
            href="/admin/assessments"
            className="inline-flex items-center text-sm text-gray-600 hover:text-primary"
          >
            <ArrowLeft className="w-4 h-4 mr-1" />
            Back to Assessments
          </Link>
        </div>
        <div className="p-8 bg-white rounded-lg shadow-sm border border-gray-200 text-center">
          <AlertCircle className="w-12 h-12 text-red-500 mx-auto mb-4" />
          <h2 className="text-xl font-semibold text-gray-900 mb-2">Error Loading Assessment</h2>
          <p className="text-gray-500">{error || 'Assessment not found'}</p>
        </div>
      </div>
    );
  }

  return (
    <div className="p-6 lg:p-8">
      {/* Toast Notification */}
      {toast && (
        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg ${
          toast.type === 'success' ? 'bg-green-600' : 'bg-red-600'
        } text-white`}>
          {toast.message}
        </div>
      )}

      {/* Header */}
      <div className="mb-6">
        <Link
          href="/admin/assessments"
          className="inline-flex items-center text-sm text-gray-600 hover:text-primary mb-4"
        >
          <ArrowLeft className="w-4 h-4 mr-1" />
          Back to Assessments
        </Link>
      </div>

      {/* Title Section */}
      <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
        <div className="flex flex-col lg:flex-row lg:items-start lg:justify-between">
          <div className="flex-1">
            <div className="flex items-center space-x-3 mb-2">
              <h1 className="text-2xl lg:text-3xl font-bold text-gray-900">{assessment.title}</h1>
              <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                v{assessment.version}
              </span>
              {assessment.is_published ? (
                <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                  <CheckCircle className="w-3 h-3 mr-1" />
                  Published
                </span>
              ) : (
                <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                  Draft
                </span>
              )}
            </div>
            {assessment.description && (
              <p className="text-gray-600 mt-2">{assessment.description}</p>
            )}
            <div className="flex items-center space-x-4 mt-4 text-sm text-gray-500">
              <span>Created: {formatDate(assessment.created_at)}</span>
              {assessment.created_by_name && <span>By: {assessment.created_by_name}</span>}
            </div>
          </div>

          <div className="flex items-center space-x-3 mt-4 lg:mt-0">
            <button
              onClick={() => setShowForm(true)}
              className="inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium"
            >
              <Pencil className="w-4 h-4 mr-2" />
              Edit
            </button>
            <button
              onClick={handlePublish}
              disabled={isPublishing}
              className={`inline-flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${
                assessment.is_published
                  ? 'bg-yellow-50 text-yellow-700 border border-yellow-300 hover:bg-yellow-100'
                  : 'bg-green-50 text-green-700 border border-green-300 hover:bg-green-100'
              } disabled:opacity-50`}
            >
              {isPublishing ? (
                <Loader2 className="w-4 h-4 mr-2 animate-spin" />
              ) : assessment.is_published ? (
                <XCircle className="w-4 h-4 mr-2" />
              ) : (
                <UploadCloud className="w-4 h-4 mr-2" />
              )}
              {assessment.is_published ? 'Unpublish' : 'Publish'}
            </button>
            {deleteConfirm ? (
              <div className="flex items-center space-x-2">
                <button
                  onClick={handleDelete}
                  disabled={isDeleting}
                  className="inline-flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium disabled:opacity-50"
                >
                  {isDeleting ? <Loader2 className="w-4 h-4 animate-spin" /> : 'Confirm Delete'}
                </button>
                <button
                  onClick={() => setDeleteConfirm(false)}
                  className="inline-flex items-center px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium"
                >
                  Cancel
                </button>
              </div>
            ) : (
              <button
                onClick={() => setDeleteConfirm(true)}
                className="inline-flex items-center px-4 py-2 bg-white border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors font-medium"
              >
                <Trash2 className="w-4 h-4 mr-2" />
                Delete
              </button>
            )}
          </div>
        </div>
      </div>

      {/* Dimensions Section */}
      <div className="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div className="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
          <h2 className="text-lg font-semibold text-gray-900">Dimensions & Topics</h2>
          <div className="flex items-center space-x-4 text-sm text-gray-500">
            <span className="flex items-center">
              <FolderOpen className="w-4 h-4 mr-1" />
              {assessment.dimensions?.length || 0} Dimensions
            </span>
            <span className="flex items-center">
              <MessageSquare className="w-4 h-4 mr-1" />
              {assessment.dimensions?.reduce((acc, dim) => acc + (dim.topics?.length || 0), 0) || 0} Topics
            </span>
          </div>
        </div>

        {assessment.dimensions && assessment.dimensions.length > 0 ? (
          <div className="divide-y divide-gray-200">
            {assessment.dimensions.map((dimension, dimensionIndex) => (
              <div key={dimension.id || dimensionIndex} className="p-6">
                <div className="flex items-start justify-between mb-4">
                  <div className="flex items-center space-x-3">
                    <div className="h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center">
                      <span className="text-primary font-semibold">{dimensionIndex + 1}</span>
                    </div>
                    <div>
                      <h3 className="text-lg font-semibold text-gray-900">{dimension.title}</h3>
                      <span className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-600">
                        {dimension.category}
                      </span>
                    </div>
                  </div>
                </div>
                
                {dimension.description && (
                  <p className="text-gray-600 mb-4 ml-13">{dimension.description}</p>
                )}

                {dimension.topics && dimension.topics.length > 0 && (
                  <div className="ml-13">
                    <h4 className="text-sm font-medium text-gray-700 mb-3">Topics</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                      {dimension.topics.map((topic, topicIndex) => (
                        <div
                          key={topic.id || topicIndex}
                          className="p-4 bg-gray-50 rounded-lg border border-gray-100"
                        >
                          <div className="flex items-start justify-between mb-2">
                            <span className="text-sm font-medium text-gray-900">{topic.label}</span>
                            <span className="text-xs text-gray-400">#{topicIndex + 1}</span>
                          </div>
                          {topic.prompt && (
                            <p className="text-sm text-gray-600 mb-2">{topic.prompt}</p>
                          )}
                          {topic.help_text && (
                            <p className="text-xs text-gray-500 italic">{topic.help_text}</p>
                          )}
                        </div>
                      ))}
                    </div>
                  </div>
                )}
              </div>
            ))}
          </div>
        ) : (
          <div className="p-12 text-center">
            <FileText className="w-12 h-12 text-gray-400 mx-auto mb-4" />
            <h3 className="text-lg font-medium text-gray-900 mb-2">No dimensions yet</h3>
            <p className="text-gray-500 mb-4">Add dimensions and topics to this assessment</p>
            <button
              onClick={() => setShowForm(true)}
              className="inline-flex items-center px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors"
            >
              <Pencil className="w-4 h-4 mr-2" />
              Add Content
            </button>
          </div>
        )}
      </div>

      {/* Assessment Form Modal */}
      {showForm && (
        <AssessmentForm
          assessment={assessment}
          onSuccess={handleFormSuccess}
          onCancel={() => setShowForm(false)}
        />
      )}
    </div>
  );
}


----------------------------------------------------------------
File: src\app\admin\assessments\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState } from 'react';
import Link from 'next/link';
import { useRouter } from 'next/navigation';
import { AssessmentAdminAPI } from '@/lib/api/adminEndpoints';
import { AssessmentListItem } from '@/lib/api/adminTypes';
import { AssessmentForm } from '@/components/admin/AssessmentForm';
import { 
  Plus, 
  Pencil, 
  Trash2, 
  Eye, 
  UploadCloud, 
  XCircle,
  CheckCircle,
  FileText,
  AlertCircle
} from 'lucide-react';

export default function AssessmentsPage() {
  const router = useRouter();
  const [assessments, setAssessments] = useState<AssessmentListItem[]>([]);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  const [showForm, setShowForm] = useState(false);
  const [editingAssessment, setEditingAssessment] = useState<AssessmentListItem | null>(null);
  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null);
  const [actionLoading, setActionLoading] = useState<string | null>(null);
  const [toast, setToast] = useState<{ message: string; type: 'success' | 'error' } | null>(null);

  useEffect(() => {
    fetchAssessments();
  }, []);

  const fetchAssessments = async () => {
    try {
      setIsLoading(true);
      const data = await AssessmentAdminAPI.list();
      setAssessments(data);
    } catch (err) {
      console.error('Failed to fetch assessments:', err);
      setError('Failed to load assessments');
    } finally {
      setIsLoading(false);
    }
  };

  const showToast = (message: string, type: 'success' | 'error') => {
    setToast({ message, type });
    setTimeout(() => setToast(null), 3000);
  };

  const handlePublish = async (id: string, currentStatus: boolean) => {
    try {
      setActionLoading(id);
      await AssessmentAdminAPI.publish(id, !currentStatus);
      showToast(!currentStatus ? 'Assessment published successfully' : 'Assessment unpublished', 'success');
      fetchAssessments();
    } catch (err) {
      console.error('Failed to publish/unpublish:', err);
      showToast('Failed to update publish status', 'error');
    } finally {
      setActionLoading(null);
    }
  };

  const handleDelete = async (id: string) => {
    try {
      setActionLoading(id);
      await AssessmentAdminAPI.delete(id);
      showToast('Assessment deleted successfully', 'success');
      setDeleteConfirm(null);
      fetchAssessments();
    } catch (err) {
      console.error('Failed to delete:', err);
      showToast('Failed to delete assessment', 'error');
    } finally {
      setActionLoading(null);
    }
  };

  const handleFormSuccess = () => {
    setShowForm(false);
    setEditingAssessment(null);
    fetchAssessments();
    showToast(editingAssessment ? 'Assessment updated successfully' : 'Assessment created successfully', 'success');
  };

  const formatDate = (dateString: string) => {
    return new Date(dateString).toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
    });
  };

  return (
    <div className="p-6 lg:p-8">
      {/* Page Header */}
      <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8">
        <div>
          <h1 className="text-2xl lg:text-3xl font-bold text-gray-900">Assessments</h1>
          <p className="text-gray-500 mt-1">Manage your surveys and assessments</p>
        </div>
        <button
          onClick={() => setShowForm(true)}
          className="mt-4 sm:mt-0 inline-flex items-center px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors font-medium"
        >
          <Plus className="w-5 h-5 mr-2" />
          Create New Assessment
        </button>
      </div>

      {/* Error Banner */}
      {error && (
        <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
          <div className="flex items-center">
            <AlertCircle className="w-5 h-5 text-red-500 mr-2" />
            <p className="text-red-600 text-sm">{error}</p>
          </div>
        </div>
      )}

      {/* Toast Notification */}
      {toast && (
        <div className={`fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg ${
          toast.type === 'success' ? 'bg-green-600' : 'bg-red-600'
        } text-white`}>
          {toast.message}
        </div>
      )}

      {/* Assessments Table */}
      <div className="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        {isLoading ? (
          <div className="p-8">
            <div className="animate-pulse space-y-4">
              {[...Array(5)].map((_, i) => (
                <div key={i} className="h-16 bg-gray-200 rounded"></div>
              ))}
            </div>
          </div>
        ) : assessments.length === 0 ? (
          <div className="p-12 text-center">
            <FileText className="w-12 h-12 text-gray-400 mx-auto mb-4" />
            <h3 className="text-lg font-medium text-gray-900 mb-2">No assessments yet</h3>
            <p className="text-gray-500 mb-4">Create your first assessment to get started</p>
            <button
              onClick={() => setShowForm(true)}
              className="inline-flex items-center px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors"
            >
              <Plus className="w-5 h-5 mr-2" />
              Create Assessment
            </button>
          </div>
        ) : (
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Title
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Version
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Status
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Created
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Dimensions / Topics
                  </th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Responses
                  </th>
                  <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                    Actions
                  </th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {assessments.map((assessment) => (
                  <tr key={assessment.id} className="hover:bg-gray-50">
                    <td className="px-6 py-4">
                      <div className="flex items-center">
                        <div className="h-10 w-10 bg-primary/10 rounded-lg flex items-center justify-center mr-3">
                          <FileText className="h-5 w-5 text-primary" />
                        </div>
                        <div>
                          <div className="text-sm font-medium text-gray-900">{assessment.title}</div>
                          {assessment.description && (
                            <div className="text-sm text-gray-500 truncate max-w-xs">
                              {assessment.description}
                            </div>
                          )}
                        </div>
                      </div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">
                        v{assessment.version}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      {assessment.is_published ? (
                        <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                          <CheckCircle className="w-3 h-3 mr-1" />
                          Published
                        </span>
                      ) : (
                        <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                          Draft
                        </span>
                      )}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {formatDate(assessment.created_at)}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {assessment.dimension_count} / {assessment.topic_count}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {assessment.response_count}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                      <div className="flex items-center justify-end space-x-2">
                        {/* View Button */}
                        <Link
                          href={`/admin/assessments/${assessment.id}`}
                          className="p-2 text-gray-400 hover:text-primary rounded-lg hover:bg-gray-100 transition-colors"
                          title="View"
                        >
                          <Eye className="w-4 h-4" />
                        </Link>

                        {/* Edit Button */}
                        <button
                          onClick={() => {
                            setEditingAssessment(assessment);
                            setShowForm(true);
                          }}
                          className="p-2 text-gray-400 hover:text-primary rounded-lg hover:bg-gray-100 transition-colors"
                          title="Edit"
                        >
                          <Pencil className="w-4 h-4" />
                        </button>

                        {/* Publish/Unpublish Button */}
                        <button
                          onClick={() => handlePublish(assessment.id, assessment.is_published)}
                          disabled={actionLoading === assessment.id}
                          className={`p-2 rounded-lg transition-colors ${
                            assessment.is_published
                              ? 'text-gray-400 hover:text-yellow-600 hover:bg-yellow-50'
                              : 'text-gray-400 hover:text-green-600 hover:bg-green-50'
                          } disabled:opacity-50`}
                          title={assessment.is_published ? 'Unpublish' : 'Publish'}
                        >
                          {actionLoading === assessment.id ? (
                            <div className="w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin" />
                          ) : assessment.is_published ? (
                            <XCircle className="w-4 h-4" />
                          ) : (
                            <UploadCloud className="w-4 h-4" />
                          )}
                        </button>

                        {/* Delete Button */}
                        {deleteConfirm === assessment.id ? (
                          <div className="flex items-center space-x-1">
                            <button
                              onClick={() => handleDelete(assessment.id)}
                              disabled={actionLoading === assessment.id}
                              className="px-2 py-1 text-xs font-medium text-white bg-red-600 rounded hover:bg-red-700 disabled:opacity-50"
                            >
                              {actionLoading === assessment.id ? '...' : 'Confirm'}
                            </button>
                            <button
                              onClick={() => setDeleteConfirm(null)}
                              className="px-2 py-1 text-xs font-medium text-gray-600 bg-gray-100 rounded hover:bg-gray-200"
                            >
                              Cancel
                            </button>
                          </div>
                        ) : (
                          <button
                            onClick={() => setDeleteConfirm(assessment.id)}
                            className="p-2 text-gray-400 hover:text-red-600 rounded-lg hover:bg-red-50 transition-colors"
                            title="Delete"
                          >
                            <Trash2 className="w-4 h-4" />
                          </button>
                        )}
                      </div>
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        )}
      </div>

      {/* Assessment Form Modal */}
      {showForm && (
        <AssessmentForm
          assessment={editingAssessment}
          onSuccess={handleFormSuccess}
          onCancel={() => {
            setShowForm(false);
            setEditingAssessment(null);
          }}
        />
      )}
    </div>
  );
}


----------------------------------------------------------------
File: src\app\admin\dashboard\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState } from 'react';
import { DashboardAPI } from '@/lib/api/adminEndpoints';
import { DashboardData, DashboardActivityItem } from '@/lib/api/adminTypes';
import { StatCard } from '@/components/admin/StatCard';
import { ActivityFeed } from '@/components/admin/ActivityFeed';
import { 
  ClipboardList, 
  Users, 
  CheckCircle, 
  TrendingUp,
  Activity,
  BarChart3
} from 'lucide-react';

export default function AdminDashboardPage() {
  const [dashboardData, setDashboardData] = useState<DashboardData | null>(null);
  const [activities, setActivities] = useState<DashboardActivityItem[]>([]);
  const [isLoadingStats, setIsLoadingStats] = useState(true);
  const [isLoadingActivity, setIsLoadingActivity] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const fetchDashboardData = async () => {
      try {
        setIsLoadingStats(true);
        const data = await DashboardAPI.getStats('30d');
        setDashboardData(data);
      } catch (err) {
        console.error('Failed to fetch dashboard stats:', err);
        setError('Failed to load dashboard data');
      } finally {
        setIsLoadingStats(false);
      }
    };

    const fetchActivityData = async () => {
      try {
        setIsLoadingActivity(true);
        const data = await DashboardAPI.getActivity();
        setActivities(data);
      } catch (err) {
        console.error('Failed to fetch activity:', err);
      } finally {
        setIsLoadingActivity(false);
      }
    };

    fetchDashboardData();
    fetchActivityData();
  }, []);

  const stats = dashboardData?.overview;

  // Calculate key metrics from the API response
  const totalSurveys = stats?.active_assessments ?? 0;
  const totalResponses = stats?.total_responses ?? 0;
  const completionRate = stats?.completion_rate ?? 0;
  const avgScore = stats?.avg_overall_score ?? 0;

  return (
    <div className="p-6 lg:p-8">
      {/* Page Header */}
      <div className="mb-8">
        <h1 className="text-2xl lg:text-3xl font-bold text-gray-900">Dashboard</h1>
        <p className="text-gray-500 mt-1">Overview of your assessment platform</p>
      </div>

      {/* Error Banner */}
      {error && (
        <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg">
          <p className="text-red-600 text-sm">{error}</p>
        </div>
      )}

      {/* Stats Grid */}
      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8">
        <StatCard
          icon={ClipboardList}
          label="Total Surveys"
          value={totalSurveys}
          iconColor="text-blue-600"
        />
        <StatCard
          icon={Users}
          label="Total Responses"
          value={totalResponses}
          iconColor="text-purple-600"
        />
        <StatCard
          icon={CheckCircle}
          label="Completion Rate"
          value={`${completionRate.toFixed(1)}%`}
          iconColor="text-green-600"
        />
        <StatCard
          icon={TrendingUp}
          label="Average Score"
          value={avgScore.toFixed(1)}
          iconColor="text-orange-600"
        />
      </div>

      {/* Additional Stats Row */}
      {dashboardData && !isLoadingStats && (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8">
          <StatCard
            icon={Activity}
            label="Completed Responses"
            value={stats?.completed_responses ?? 0}
            iconColor="text-teal-600"
          />
          <StatCard
            icon={BarChart3}
            label="In Progress"
            value={stats?.in_progress_responses ?? 0}
            iconColor="text-indigo-600"
          />
          <StatCard
            icon={Users}
            label="Total Participants"
            value={stats?.total_participants ?? 0}
            iconColor="text-pink-600"
          />
          <StatCard
            icon={TrendingUp}
            label="Avg Gap Score"
            value={stats?.avg_overall_gap?.toFixed(1) ?? '0.0'}
            iconColor="text-red-600"
          />
        </div>
      )}

      {/* Loading skeleton for stats */}
      {isLoadingStats && (
        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8">
          {[...Array(4)].map((_, i) => (
            <div key={i} className="bg-white rounded-lg shadow-sm border border-gray-200 p-6 animate-pulse">
              <div className="h-4 bg-gray-200 rounded w-1/2 mb-4"></div>
              <div className="h-8 bg-gray-200 rounded w-3/4"></div>
            </div>
          ))}
        </div>
      )}

      {/* Main Content Grid */}
      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        {/* Activity Feed - Takes 2 columns on large screens */}
        <div className="lg:col-span-2">
          <ActivityFeed activities={activities} isLoading={isLoadingActivity} />
        </div>

        {/* Quick Stats / Summary Card */}
        <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h3 className="text-lg font-semibold text-gray-900 mb-4">Quick Overview</h3>
          <div className="space-y-4">
            <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
              <span className="text-sm text-gray-600">Active Surveys</span>
              <span className="font-semibold text-gray-900">{totalSurveys}</span>
            </div>
            <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
              <span className="text-sm text-gray-600">Completed</span>
              <span className="font-semibold text-green-600">{stats?.completed_responses ?? 0}</span>
            </div>
            <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
              <span className="text-sm text-gray-600">In Progress</span>
              <span className="font-semibold text-blue-600">{stats?.in_progress_responses ?? 0}</span>
            </div>
            <div className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
              <span className="text-sm text-gray-600">Active Participants</span>
              <span className="font-semibold text-gray-900">{stats?.active_participants ?? 0}</span>
            </div>
          </div>

          {/* Top Dimensions */}
          {dashboardData?.topDimensions && dashboardData.topDimensions.length > 0 && (
            <div className="mt-6">
              <h4 className="text-sm font-medium text-gray-700 mb-3">Top Performing Dimensions</h4>
              <div className="space-y-2">
                {dashboardData.topDimensions.slice(0, 3).map((dim, index) => (
                  <div key={index} className="flex items-center justify-between text-sm">
                    <span className="text-gray-600 truncate flex-1 mr-2">{dim.title}</span>
                    <span className="font-medium text-green-600">{dim.avg_score?.toFixed(1)}</span>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Bottom Dimensions */}
          {dashboardData?.bottomDimensions && dashboardData.bottomDimensions.length > 0 && (
            <div className="mt-6">
              <h4 className="text-sm font-medium text-gray-700 mb-3">Areas for Improvement</h4>
              <div className="space-y-2">
                {dashboardData.bottomDimensions.slice(0, 3).map((dim, index) => (
                  <div key={index} className="flex items-center justify-between text-sm">
                    <span className="text-gray-600 truncate flex-1 mr-2">{dim.title}</span>
                    <span className="font-medium text-orange-600">{dim.avg_score?.toFixed(1)}</span>
                  </div>
                ))}
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Recent Completions Table */}
      {dashboardData?.recentCompletions && dashboardData.recentCompletions.length > 0 && (
        <div className="mt-8 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
          <div className="p-6 border-b border-gray-200">
            <h3 className="text-lg font-semibold text-gray-900">Recent Completions</h3>
          </div>
          <div className="overflow-x-auto">
            <table className="w-full">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Industry</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Score</th>
                  <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Completed</th>
                </tr>
              </thead>
              <tbody className="bg-white divide-y divide-gray-200">
                {dashboardData.recentCompletions.slice(0, 5).map((completion) => (
                  <tr key={completion.id} className="hover:bg-gray-50">
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                      {completion.full_name}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {completion.company_name}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {completion.industry}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm">
                      <span className={`font-medium ${
                        completion.overall_score >= 70 ? 'text-green-600' :
                        completion.overall_score >= 40 ? 'text-yellow-600' : 'text-red-600'
                      }`}>
                        {completion.overall_score.toFixed(1)}
                      </span>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {new Date(completion.completed_at).toLocaleDateString()}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </div>
      )}
    </div>
  );
}


----------------------------------------------------------------
File: src\app\admin\layout.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState } from 'react';
import { useRouter, usePathname } from 'next/navigation';
import Link from 'next/link';
import { AdminAuthProvider, useAdminAuth } from '@/lib/context/AdminAuthContext';

const navItems = [
  {
    name: 'Dashboard',
    href: '/admin/dashboard',
    icon: (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
      </svg>
    ),
  },
  {
    name: 'Surveys',
    href: '/admin/assessments',
    icon: (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
      </svg>
    ),
  },
  {
    name: 'Responses',
    href: '/admin/responses',
    icon: (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
      </svg>
    ),
  },
  {
    name: 'Analytics',
    href: '/admin/analytics',
    icon: (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
      </svg>
    ),
  },
  {
    name: 'Settings',
    href: '/admin/settings',
    icon: (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
      </svg>
    ),
  },
];

function AdminLayoutContent({ children }: { children: React.ReactNode }) {
  const router = useRouter();
  const pathname = usePathname();
  const { user, isAuthenticated, isLoading, logout } = useAdminAuth();
  const [isLoggingOut, setIsLoggingOut] = useState(false);

  // Redirect to login if not authenticated
  useEffect(() => {
    if (!isLoading && !isAuthenticated && pathname !== '/admin/login') {
      router.push('/admin/login');
    }
  }, [isAuthenticated, isLoading, pathname, router]);

  // Don't render anything while checking auth
  if (isLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
      </div>
    );
  }

  // Allow login page to render without authentication
  if (pathname === '/admin/login') {
    return <>{children}</>;
  }

  // Redirect to login page if not authenticated
  if (!isAuthenticated) {
    return null;
  }

  const handleLogout = async () => {
    setIsLoggingOut(true);
    try {
      await logout();
      router.push('/admin/login');
    } finally {
      setIsLoggingOut(false);
    }
  };

  return (
    <div className="min-h-screen bg-gray-100">
      {/* Sidebar */}
      <aside className="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg">
        {/* Logo */}
        <div className="h-16 flex items-center px-6 border-b border-gray-200">
          <div className="flex items-center space-x-3">
            <div className="h-8 w-8 bg-primary rounded-lg flex items-center justify-center">
              <svg className="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
              </svg>
            </div>
            <span className="text-lg font-bold text-gray-900">HORVÁTH</span>
          </div>
        </div>

        {/* Navigation */}
        <nav className="p-4 space-y-1">
          {navItems.map((item) => {
            const isActive = pathname === item.href || pathname.startsWith(item.href + '/');
            return (
              <Link
                key={item.name}
                href={item.href}
                className={`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${
                  isActive
                    ? 'bg-primary text-white'
                    : 'text-gray-700 hover:bg-gray-100'
                }`}
              >
                <span className="mr-3">{item.icon}</span>
                {item.name}
              </Link>
            );
          })}
        </nav>

        {/* Bottom Section - Logout */}
        <div className="absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200">
          <button
            onClick={handleLogout}
            disabled={isLoggingOut}
            className="flex items-center w-full px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50"
          >
            <svg className="w-5 h-5 mr-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            {isLoggingOut ? 'Signing out...' : 'Sign out'}
          </button>
        </div>
      </aside>

      {/* Main Content */}
      <div className="pl-64">
        {/* Header */}
        <header className="h-16 bg-white shadow-sm flex items-center justify-between px-6">
          <div className="flex items-center">
            <h1 className="text-lg font-semibold text-gray-900">
              {navItems.find(item => pathname.startsWith(item.href))?.name || 'Admin'}
            </h1>
          </div>
          <div className="flex items-center space-x-4">
            {/* User Info */}
            <div className="flex items-center space-x-3">
              <div className="h-8 w-8 bg-primary/10 rounded-full flex items-center justify-center">
                <span className="text-sm font-medium text-primary">
                  {user?.fullName?.charAt(0).toUpperCase() || 'U'}
                </span>
              </div>
              <div className="text-sm">
                <p className="font-medium text-gray-900">{user?.fullName || 'Admin User'}</p>
                <p className="text-gray-500 text-xs">{user?.email || ''}</p>
              </div>
            </div>
          </div>
        </header>

        {/* Page Content */}
        <main className="p-6">
          {children}
        </main>
      </div>
    </div>
  );
}

export default function AdminLayout({ children }: { children: React.ReactNode }) {
  return (
    <AdminAuthProvider>
      <AdminLayoutContent>{children}</AdminLayoutContent>
    </AdminAuthProvider>
  );
}


----------------------------------------------------------------
File: src\app\admin\login\page.tsx
----------------------------------------------------------------
'use client';

import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAdminAuth } from '@/lib/hooks/useAdminAuth';

export default function AdminLoginPage() {
  const router = useRouter();
  const { login, isAuthenticated, isLoading: authLoading } = useAdminAuth();
  
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [error, setError] = useState<string | null>(null);

  /**
   * 1. المراقبة والتوجيه التلقائي:
   * نعتمد على useEffect كمصدر وحيد للحقيقة (Single Source of Truth)
   * بمجرد نجاح تسجيل الدخول، ستتغير حالة isAuthenticated ويتم التوجيه فوراً.
   */
  useEffect(() => {
    if (!authLoading && isAuthenticated) {
      router.replace('/admin/dashboard');
    }
  }, [isAuthenticated, authLoading, router]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (isSubmitting) return; // منع النقر المتكرر

    setError(null);
    setIsSubmitting(true);

    try {
      await login(email, password);
      // إعادة تحميل كاملة لضمان قراءة التوكن من localStorage وتحديث الـ layout
      if (typeof window !== 'undefined') {
        window.location.href = '/admin/dashboard';
        return;
      }
      router.replace('/admin/dashboard');
    } catch (err: any) {
      setError(err.message || 'Invalid email or password');
      setIsSubmitting(false); // نعيد تفعيل الزر فقط في حالة الخطأ
    }
  };

  /**
   * 2. معالجة حالات التحميل (Loading States):
   * لمنع ظهور نموذج تسجيل الدخول لمستخدم هو بالفعل مسجل دخوله (Flash of Content)
   */
  if (authLoading || isAuthenticated) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"></div>
          <p className="text-gray-600">
            {isAuthenticated ? 'Redirecting to dashboard...' : 'Loading...'}
          </p>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
      <div className="max-w-md w-full space-y-8">
        {/* Header */}
        <div className="text-center">
          <div className="mx-auto h-16 w-16 bg-primary rounded-lg flex items-center justify-center mb-6 shadow-sm">
            <svg 
              className="h-10 w-10 text-white" 
              fill="none" 
              viewBox="0 0 24 24" 
              stroke="currentColor"
            >
              <path 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                strokeWidth={1.5} 
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" 
              />
            </svg>
          </div>
          <h2 className="text-3xl font-extrabold text-gray-900">
            Admin Login
          </h2>
          <p className="mt-2 text-sm text-gray-600">
            Sign in to access the admin dashboard
          </p>
        </div>

        {/* Login Form */}
        <form className="mt-8 space-y-6" onSubmit={handleSubmit}>
          <div className="rounded-md shadow-sm -space-y-px">
            {/* Email Field */}
            <div>
              <label htmlFor="email" className="sr-only">
                Email address
              </label>
              <input
                id="email"
                name="email"
                type="email"
                autoComplete="email"
                required
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                className="appearance-none rounded-t-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                placeholder="Email address"
                disabled={isSubmitting}
              />
            </div>
            {/* Password Field */}
            <div>
              <label htmlFor="password" className="sr-only">
                Password
              </label>
              <input
                id="password"
                name="password"
                type="password"
                autoComplete="current-password"
                required
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                className="appearance-none rounded-b-md relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm"
                placeholder="Password"
                disabled={isSubmitting}
              />
            </div>
          </div>

          {/* Error Message */}
          {error && (
            <div className="rounded-md bg-red-50 p-4 animate-in fade-in duration-300">
              <div className="flex">
                <div className="flex-shrink-0">
                  <svg className="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
                  </svg>
                </div>
                <div className="ml-3">
                  <p className="text-sm text-red-700">{error}</p>
                </div>
              </div>
            </div>
          )}

          {/* Submit Button */}
          <div>
            <button
              type="submit"
              disabled={isSubmitting}
              className="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-sm"
            >
              {isSubmitting ? (
                <>
                  <svg className="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  Signing in...
                </>
              ) : (
                'Sign in'
              )}
            </button>
          </div>

          {/* Back to Home Link */}
          <div className="text-center pt-4">
            <a 
              href="/" 
              className="text-sm font-medium text-gray-500 hover:text-primary transition-colors flex items-center justify-center gap-2"
            >
              <span>←</span> Back to Assessment
            </a>
          </div>
        </form>
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\app\admin\responses\[id]\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState, use } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';
import { ResponseAdminAPI } from '@/lib/api/adminEndpoints';
import { 
  ResponseDetail, 
  ResponseListItem,
  TopicAnswer,
  PriorityScore 
} from '@/lib/api/adminTypes';

// Back button component
function BackButton() {
  return (
    <Link 
      href="/admin/responses"
      className="inline-flex items-center text-sm text-gray-600 hover:text-primary transition-colors"
    >
      <svg className="w-4 h-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
      </svg>
      Back to Responses
    </Link>
  );
}

// Status badge component
function StatusBadge({ status }: { status: string }) {
  const isCompleted = status === 'completed';
  return (
    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
      isCompleted 
        ? 'bg-green-100 text-green-800' 
        : 'bg-yellow-100 text-yellow-800'
    }`}>
      {isCompleted ? (
        <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
        </svg>
      ) : (
        <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clipRule="evenodd" />
        </svg>
      )}
      {isCompleted ? 'Completed' : 'In Progress'}
    </span>
  );
}

// Score gauge component
function ScoreGauge({ score, size = 'md' }: { score: number; size?: 'sm' | 'md' | 'lg' }) {
  const getScoreColor = (score: number) => {
    if (score >= 80) return 'text-green-600';
    if (score >= 60) return 'text-blue-600';
    if (score >= 40) return 'text-yellow-600';
    return 'text-red-600';
  };

  const getBgColor = (score: number) => {
    if (score >= 80) return 'bg-green-100';
    if (score >= 60) return 'bg-blue-100';
    if (score >= 40) return 'bg-yellow-100';
    return 'bg-red-100';
  };

  const sizes = {
    sm: 'w-16 h-16 text-lg',
    md: 'w-24 h-24 text-2xl',
    lg: 'w-32 h-32 text-3xl'
  };

  return (
    <div className={`${sizes[size]} relative flex items-center justify-center rounded-full ${getBgColor(score)}`}>
      <svg className="absolute inset-0 w-full h-full -rotate-90" viewBox="0 0 36 36">
        <path
          className="text-gray-200"
          d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
          fill="none"
          stroke="currentColor"
          strokeWidth="3"
        />
        <path
          className={`${getScoreColor(score)} transition-all duration-1000`}
          strokeDasharray={`${score}, 100`}
          d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
          fill="none"
          stroke="currentColor"
          strokeWidth="3"
        />
      </svg>
      <span className={`font-bold ${getScoreColor(score)}`}>
        {score.toFixed(0)}%
      </span>
    </div>
  );
}

// Progress bar component
function ProgressBar({ progress }: { progress: number }) {
  return (
    <div className="w-full">
      <div className="flex justify-between text-xs text-gray-500 mb-1">
        <span>Progress</span>
        <span>{progress}%</span>
      </div>
      <div className="w-full bg-gray-200 rounded-full h-2">
        <div 
          className="bg-primary h-2 rounded-full transition-all duration-300"
          style={{ width: `${progress}%` }}
        />
      </div>
    </div>
  );
}

// Topic answer card component
function TopicAnswerCard({ answer }: { answer: TopicAnswer }) {
  const getGapColor = (gap: number) => {
    if (gap <= 5) return 'text-green-600 bg-green-50';
    if (gap <= 15) return 'text-blue-600 bg-blue-50';
    if (gap <= 25) return 'text-yellow-600 bg-yellow-50';
    return 'text-red-600 bg-red-50';
  };

  const getRatingColor = (rating: number) => {
    if (rating >= 4) return 'text-green-600';
    if (rating >= 3) return 'text-blue-600';
    if (rating >= 2) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="bg-white border border-gray-200 rounded-lg p-4">
      <div className="flex items-start justify-between mb-2">
        <div>
          <h4 className="text-sm font-medium text-gray-900">{answer.label}</h4>
          <p className="text-xs text-gray-500">{answer.dimension_title}</p>
        </div>
        <span className={`px-2 py-1 rounded text-xs font-medium ${getGapColor(answer.gap)}`}>
          Gap: {answer.gap > 0 ? '+' : ''}{answer.gap.toFixed(1)}
        </span>
      </div>
      
      <div className="flex items-center gap-4 mt-3">
        <div className="flex-1">
          <div className="text-xs text-gray-500 mb-1">Current</div>
          <div className="flex items-center gap-2">
            <div className="flex-1 bg-gray-100 rounded-full h-2">
              <div 
                className="bg-blue-500 h-2 rounded-full"
                style={{ width: `${(answer.current_rating / 5) * 100}%` }}
              />
            </div>
            <span className={`text-sm font-medium ${getRatingColor(answer.current_rating)}`}>
              {answer.current_rating.toFixed(1)}
            </span>
          </div>
        </div>
        
        <div className="flex-1">
          <div className="text-xs text-gray-500 mb-1">Target</div>
          <div className="flex items-center gap-2">
            <div className="flex-1 bg-gray-100 rounded-full h-2">
              <div 
                className="bg-purple-500 h-2 rounded-full"
                style={{ width: `${(answer.target_rating / 5) * 100}%` }}
              />
            </div>
            <span className={`text-sm font-medium ${getRatingColor(answer.target_rating)}`}>
              {answer.target_rating.toFixed(1)}
            </span>
          </div>
        </div>
      </div>

      {answer.notes && (
        <div className="mt-3 pt-3 border-t border-gray-100">
          <p className="text-xs text-gray-600 italic">{answer.notes}</p>
        </div>
      )}
    </div>
  );
}

// Dimension breakdown card
function DimensionBreakdown({ priorities }: { priorities: PriorityScore[] }) {
  // Group by dimension
  const dimensionMap = new Map<string, { score: number; gap: number; title: string }>();
  
  priorities.forEach(p => {
    if (!dimensionMap.has(p.dimension_id)) {
      dimensionMap.set(p.dimension_id, {
        score: p.dimension_score,
        gap: p.dimension_gap,
        title: p.dimension_title
      });
    }
  });

  const dimensions = Array.from(dimensionMap.values());

  const getScoreColor = (score: number) => {
    if (score >= 80) return 'bg-green-500';
    if (score >= 60) return 'bg-blue-500';
    if (score >= 40) return 'bg-yellow-500';
    return 'bg-red-500';
  };

  const getGapColor = (gap: number) => {
    if (gap <= 5) return 'text-green-600';
    if (gap <= 15) return 'text-blue-600';
    if (gap <= 25) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {dimensions.map((dim, idx) => (
        <div key={idx} className="bg-white border border-gray-200 rounded-lg p-4">
          <div className="flex items-center justify-between mb-2">
            <h4 className="text-sm font-medium text-gray-900 truncate">{dim.title}</h4>
          </div>
          <div className="flex items-center gap-4">
            <div className="flex-1">
              <div className="text-xs text-gray-500 mb-1">Score</div>
              <div className="flex items-center gap-2">
                <div className="flex-1 bg-gray-100 rounded-full h-2">
                  <div 
                    className={`h-2 rounded-full ${getScoreColor(dim.score)}`}
                    style={{ width: `${(dim.score / 100) * 100}%` }}
                  />
                </div>
                <span className="text-sm font-medium text-gray-900">{dim.score.toFixed(0)}</span>
              </div>
            </div>
            <div className="text-right">
              <div className="text-xs text-gray-500 mb-1">Gap</div>
              <span className={`text-sm font-medium ${getGapColor(dim.gap)}`}>
                {dim.gap > 0 ? '+' : ''}{dim.gap.toFixed(1)}
              </span>
            </div>
          </div>
        </div>
      ))}
    </div>
  );
}

// Top gaps list
function TopGapsList({ answers }: { answers: TopicAnswer[] }) {
  // Sort by gap (highest first)
  const sortedByGap = [...answers].sort((a, b) => b.gap - a.gap).slice(0, 5);

  const getGapColor = (gap: number) => {
    if (gap <= 5) return 'bg-green-100 text-green-800';
    if (gap <= 15) return 'bg-blue-100 text-blue-800';
    if (gap <= 25) return 'bg-yellow-100 text-yellow-800';
    return 'bg-red-100 text-red-800';
  };

  return (
    <div className="space-y-3">
      {sortedByGap.map((answer, idx) => (
        <div key={answer.id} className="flex items-center justify-between p-3 bg-white border border-gray-200 rounded-lg">
          <div className="flex items-center gap-3">
            <span className="flex items-center justify-center w-6 h-6 text-xs font-medium text-gray-500 bg-gray-100 rounded-full">
              {idx + 1}
            </span>
            <div>
              <p className="text-sm font-medium text-gray-900">{answer.label}</p>
              <p className="text-xs text-gray-500">{answer.dimension_title}</p>
            </div>
          </div>
          <div className="text-right">
            <span className={`inline-flex items-center px-2 py-1 rounded text-xs font-medium ${getGapColor(answer.gap)}`}>
              Gap: {answer.gap > 0 ? '+' : ''}{answer.gap.toFixed(1)}
            </span>
          </div>
        </div>
      ))}
    </div>
  );
}

export default function ResponseDetailPage({ params }: { params: Promise<{ id: string }> }) {
  const resolvedParams = use(params);
  const router = useRouter();
  const [responseDetail, setResponseDetail] = useState<ResponseDetail | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const fetchResponseDetail = async () => {
      try {
        setIsLoading(true);
        setError(null);
        
        const data = await ResponseAdminAPI.get(resolvedParams.id);
        setResponseDetail(data);
      } catch (err) {
        console.error('Failed to fetch response detail:', err);
        setError('Failed to load response details. Please try again.');
      } finally {
        setIsLoading(false);
      }
    };

    fetchResponseDetail();
  }, [resolvedParams.id]);

  const formatDate = (dateString: string) => {
    if (!dateString) return '-';
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      year: 'numeric',
      hour: '2-digit',
      minute: '2-digit'
    });
  };

  const calculateProgress = (response: ResponseListItem) => {
    if (response.status === 'completed') return 100;
    const started = new Date(response.started_at);
    const lastUpdated = new Date(response.last_updated_at);
    const hoursElapsed = (lastUpdated.getTime() - started.getTime()) / (1000 * 60 * 60);
    const progress = Math.min(Math.round((hoursElapsed / 0.5) * 100), 90);
    return Math.max(progress, 10);
  };

  if (isLoading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"></div>
          <p className="mt-4 text-gray-500">Loading response details...</p>
        </div>
      </div>
    );
  }

  if (error || !responseDetail) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gray-50">
        <div className="text-center">
          <p className="text-red-600 mb-4">{error || 'Response not found'}</p>
          <Link href="/admin/responses" className="text-primary hover:underline">
            Back to Responses
          </Link>
        </div>
      </div>
    );
  }

  const { response, answers, priorities } = responseDetail;
  const isCompleted = response.status === 'completed';

  return (
    <div className="space-y-6">
      {/* Header */}
      <div className="flex items-center justify-between">
        <BackButton />
        <StatusBadge status={response.status} />
      </div>

      {/* Response Overview */}
      <div className="bg-white shadow-sm rounded-lg border border-gray-200 p-6">
        <h1 className="text-2xl font-bold text-gray-900 mb-4">Response Details</h1>
        
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          {/* Participant Info */}
          <div className="lg:col-span-2 space-y-4">
            <div>
              <h2 className="text-sm font-medium text-gray-500 uppercase tracking-wider mb-2">
                Participant Information
              </h2>
              <div className="bg-gray-50 rounded-lg p-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <p className="text-xs text-gray-500">Name</p>
                    <p className="text-sm font-medium text-gray-900">{response.full_name}</p>
                  </div>
                  <div>
                    <p className="text-xs text-gray-500">Email</p>
                    <p className="text-sm font-medium text-gray-900">{response.email}</p>
                  </div>
                  <div>
                    <p className="text-xs text-gray-500">Company</p>
                    <p className="text-sm font-medium text-gray-900">{response.company_name}</p>
                  </div>
                  <div>
                    <p className="text-xs text-gray-500">Assessment</p>
                    <p className="text-sm font-medium text-gray-900">{response.assessment_title}</p>
                  </div>
                </div>
              </div>
            </div>

            {/* Dates */}
            <div>
              <h2 className="text-sm font-medium text-gray-500 uppercase tracking-wider mb-2">
                Timeline
              </h2>
              <div className="bg-gray-50 rounded-lg p-4">
                <div className="grid grid-cols-2 gap-4">
                  <div>
                    <p className="text-xs text-gray-500">Started</p>
                    <p className="text-sm font-medium text-gray-900">{formatDate(response.started_at)}</p>
                  </div>
                  {response.completed_at && (
                    <div>
                      <p className="text-xs text-gray-500">Completed</p>
                      <p className="text-sm font-medium text-gray-900">{formatDate(response.completed_at)}</p>
                    </div>
                  )}
                  <div>
                    <p className="text-xs text-gray-500">Last Updated</p>
                    <p className="text-sm font-medium text-gray-900">{formatDate(response.last_updated_at)}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          {/* Score & Progress */}
          <div className="space-y-4">
            <div className="bg-gray-50 rounded-lg p-6 text-center">
              <h3 className="text-sm font-medium text-gray-500 mb-4">Overall Score</h3>
              <ScoreGauge score={response.overall_score} size="lg" />
              {isCompleted && (
                <div className="mt-4">
                  <span className={`text-lg font-bold ${
                    response.overall_gap <= 10 ? 'text-green-600' :
                    response.overall_gap <= 20 ? 'text-blue-600' :
                    response.overall_gap <= 30 ? 'text-yellow-600' : 'text-red-600'
                  }`}>
                    Gap: {response.overall_gap > 0 ? '+' : ''}{response.overall_gap.toFixed(1)}
                  </span>
                </div>
              )}
            </div>

            <div className="bg-gray-50 rounded-lg p-4">
              <ProgressBar progress={calculateProgress(response)} />
            </div>
          </div>
        </div>
      </div>

      {/* Dimension Breakdown */}
      {isCompleted && priorities.length > 0 && (
        <div className="bg-white shadow-sm rounded-lg border border-gray-200 p-6">
          <h2 className="text-lg font-semibold text-gray-900 mb-4">Dimension Breakdown</h2>
          <DimensionBreakdown priorities={priorities} />
        </div>
      )}

      {/* Top Gaps */}
      {isCompleted && answers.length > 0 && (
        <div className="bg-white shadow-sm rounded-lg border border-gray-200 p-6">
          <h2 className="text-lg font-semibold text-gray-900 mb-4">Top Priority Gaps</h2>
          <TopGapsList answers={answers} />
        </div>
      )}

      {/* Topic Responses */}
      <div className="bg-white shadow-sm rounded-lg border border-gray-200 p-6">
        <h2 className="text-lg font-semibold text-gray-900 mb-4">
          Topic Responses ({answers.length})
        </h2>
        
        {answers.length === 0 ? (
          <div className="text-center py-8 text-gray-500">
            No topic responses yet.
          </div>
        ) : (
          <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
            {answers.map((answer) => (
              <TopicAnswerCard key={answer.id} answer={answer} />
            ))}
          </div>
        )}
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\app\admin\responses\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState, useCallback } from 'react';
import { useRouter } from 'next/navigation';
import { ResponseAdminAPI } from '@/lib/api/adminEndpoints';
import { 
  ResponseListItem, 
  PaginatedResponse,
  PaginationInfo 
} from '@/lib/api/adminTypes';

// Debounce hook for search
function useDebounce<T>(value: T, delay: number): T {
  const [debouncedValue, setDebouncedValue] = useState<T>(value);

  useEffect(() => {
    const handler = setTimeout(() => {
      setDebouncedValue(value);
    }, delay);

    return () => {
      clearTimeout(handler);
    };
  }, [value, delay]);

  return debouncedValue;
}

// Status badge component
function StatusBadge({ status }: { status: string }) {
  const isCompleted = status === 'completed';
  return (
    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
      isCompleted 
        ? 'bg-green-100 text-green-800' 
        : 'bg-yellow-100 text-yellow-800'
    }`}>
      {isCompleted ? (
        <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" />
        </svg>
      ) : (
        <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
          <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clipRule="evenodd" />
        </svg>
      )}
      {status === 'completed' ? 'Completed' : 'In Progress'}
    </span>
  );
}

// Score badge component
function ScoreBadge({ score, gap }: { score: number; gap: number }) {
  const getScoreColor = (score: number) => {
    if (score >= 80) return 'bg-green-100 text-green-800';
    if (score >= 60) return 'bg-blue-100 text-blue-800';
    if (score >= 40) return 'bg-yellow-100 text-yellow-800';
    return 'bg-red-100 text-red-800';
  };

  const getGapColor = (gap: number) => {
    if (gap <= 10) return 'text-green-600';
    if (gap <= 20) return 'text-blue-600';
    if (gap <= 30) return 'text-yellow-600';
    return 'text-red-600';
  };

  return (
    <div className="flex flex-col">
      <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${getScoreColor(score)}`}>
        {score.toFixed(1)}%
      </span>
      <span className={`text-xs ${getGapColor(gap)}`}>
        Gap: {gap > 0 ? '+' : ''}{gap.toFixed(1)}
      </span>
    </div>
  );
}

// Progress bar component
function ProgressBar({ progress }: { progress: number }) {
  return (
    <div className="w-full">
      <div className="flex justify-between text-xs text-gray-500 mb-1">
        <span>{progress}%</span>
      </div>
      <div className="w-full bg-gray-200 rounded-full h-2">
        <div 
          className="bg-primary h-2 rounded-full transition-all duration-300"
          style={{ width: `${progress}%` }}
        />
      </div>
    </div>
  );
}

export default function ResponsesPage() {
  const router = useRouter();
  const [responses, setResponses] = useState<ResponseListItem[]>([]);
  const [pagination, setPagination] = useState<PaginationInfo>({
    total: 0,
    page: 1,
    limit: 20,
    pages: 0
  });
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);
  
  // Filter states
  const [status, setStatus] = useState('all');
  const [search, setSearch] = useState('');
  const [currentPage, setCurrentPage] = useState(1);
  
  const debouncedSearch = useDebounce(search, 300);

  const fetchResponses = useCallback(async () => {
    try {
      setIsLoading(true);
      setError(null);
      
      const params = {
        page: currentPage,
        limit: 20,
        status: status !== 'all' ? status : undefined,
      };
      
      // Add search parameter if provided
      if (debouncedSearch) {
        (params as any).search = debouncedSearch;
      }
      
      const result = await ResponseAdminAPI.list(params);
      setResponses(result.data);
      setPagination(result.pagination);
    } catch (err) {
      console.error('Failed to fetch responses:', err);
      setError('Failed to load responses. Please try again.');
    } finally {
      setIsLoading(false);
    }
  }, [currentPage, status, debouncedSearch]);

  useEffect(() => {
    fetchResponses();
  }, [fetchResponses]);

  // Reset to page 1 when filters change
  useEffect(() => {
    setCurrentPage(1);
  }, [status, debouncedSearch]);

  const handleRowClick = (responseId: string) => {
    router.push(`/admin/responses/${responseId}`);
  };

  const formatDate = (dateString: string) => {
    if (!dateString) return '-';
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      year: 'numeric'
    });
  };

  const calculateProgress = (response: ResponseListItem) => {
    if (response.status === 'completed') return 100;
    // Calculate based on time elapsed if in progress
    const started = new Date(response.started_at);
    const lastUpdated = new Date(response.last_updated_at);
    const hoursElapsed = (lastUpdated.getTime() - started.getTime()) / (1000 * 60 * 60);
    // Assume typical assessment takes about 30 minutes
    const progress = Math.min(Math.round((hoursElapsed / 0.5) * 100), 90);
    return Math.max(progress, 10);
  };

  const renderPagination = () => {
    const { page, pages } = pagination;
    
    if (pages <= 1) return null;

    const getPageNumbers = () => {
      const nums: (number | string)[] = [];
      const showPages = 5;
      
      if (pages <= showPages) {
        for (let i = 1; i <= pages; i++) nums.push(i);
      } else {
        if (page <= 3) {
          for (let i = 1; i <= 4; i++) nums.push(i);
          nums.push('...');
          nums.push(pages);
        } else if (page >= pages - 2) {
          nums.push(1);
          nums.push('...');
          for (let i = pages - 3; i <= pages; i++) nums.push(i);
        } else {
          nums.push(1);
          nums.push('...');
          for (let i = page - 1; i <= page + 1; i++) nums.push(i);
          nums.push('...');
          nums.push(pages);
        }
      }
      
      return nums;
    };

    return (
      <div className="flex items-center justify-between px-4 py-3 bg-white border-t border-gray-200 sm:px-6">
        <div className="flex items-center justify-between w-full">
          <div>
            <p className="text-sm text-gray-700">
              Showing <span className="font-medium">{(page - 1) * pagination.limit + 1}</span> to{' '}
              <span className="font-medium">{Math.min(page * pagination.limit, pagination.total)}</span> of{' '}
              <span className="font-medium">{pagination.total}</span> results
            </p>
          </div>
          <div className="flex gap-1">
            <button
              onClick={() => setCurrentPage(p => Math.max(1, p - 1))}
              disabled={page === 1}
              className="px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-l-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              Previous
            </button>
            {getPageNumbers().map((num, idx) => (
              num === '...' ? (
                <span key={`ellipsis-${idx}`} className="px-3 py-1 text-gray-400">...</span>
              ) : (
                <button
                  key={num}
                  onClick={() => setCurrentPage(num as number)}
                  className={`px-3 py-1 text-sm font-medium border ${
                    page === num 
                      ? 'bg-primary text-white border-primary' 
                      : 'text-gray-700 bg-white border-gray-300 hover:bg-gray-50'
                  }`}
                >
                  {num}
                </button>
              )
            ))}
            <button
              onClick={() => setCurrentPage(p => Math.min(pages, p + 1))}
              disabled={page === pages}
              className="px-3 py-1 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-r-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              Next
            </button>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="space-y-6">
      {/* Page Header */}
      <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <h1 className="text-2xl font-bold text-gray-900">Responses</h1>
          <p className="mt-1 text-sm text-gray-500">
            View and manage all participant responses
          </p>
        </div>
      </div>

      {/* Filters */}
      <div className="flex flex-col sm:flex-row gap-4">
        {/* Search Input */}
        <div className="relative flex-1 max-w-md">
          <div className="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
            <svg className="w-5 h-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </div>
          <input
            type="text"
            placeholder="Search by email or company..."
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary sm:text-sm"
          />
        </div>

        {/* Status Filter */}
        <div className="flex items-center gap-2">
          <label htmlFor="status" className="text-sm font-medium text-gray-700">
            Status:
          </label>
          <select
            id="status"
            value={status}
            onChange={(e) => setStatus(e.target.value)}
            className="block w-40 py-2 pl-3 pr-10 border border-gray-300 rounded-lg focus:ring-primary focus:border-primary sm:text-sm"
          >
            <option value="all">All</option>
            <option value="in_progress">In Progress</option>
            <option value="completed">Completed</option>
          </select>
        </div>
      </div>

      {/* Error Message */}
      {error && (
        <div className="p-4 mb-4 text-sm text-red-700 bg-red-100 rounded-lg" role="alert">
          <span className="font-medium">Error!</span> {error}
        </div>
      )}

      {/* Table */}
      <div className="bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden">
        <div className="overflow-x-auto">
          <table className="min-w-full divide-y divide-gray-200">
            <thead className="bg-gray-50">
              <tr>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  ID
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Participant
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Company
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Assessment
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Status
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Progress
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Score / Gap
                </th>
                <th scope="col" className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Date
                </th>
                <th scope="col" className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody className="bg-white divide-y divide-gray-200">
              {isLoading ? (
                <tr>
                  <td colSpan={9} className="px-6 py-12 text-center">
                    <div className="flex justify-center items-center">
                      <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
                      <span className="ml-3 text-gray-500">Loading responses...</span>
                    </div>
                  </td>
                </tr>
              ) : responses.length === 0 ? (
                <tr>
                  <td colSpan={9} className="px-6 py-12 text-center text-gray-500">
                    No responses found. Try adjusting your filters.
                  </td>
                </tr>
              ) : (
                responses.map((response) => (
                  <tr 
                    key={response.id} 
                    onClick={() => handleRowClick(response.id)}
                    className="hover:bg-gray-50 cursor-pointer transition-colors"
                  >
                    <td className="px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-500">
                      {response.id.slice(0, 8)}...
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <div className="text-sm font-medium text-gray-900">{response.full_name}</div>
                      <div className="text-sm text-gray-500">{response.email}</div>
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                      {response.company_name}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {response.assessment_title}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <StatusBadge status={response.status} />
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap w-32">
                      <ProgressBar progress={calculateProgress(response)} />
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap">
                      <ScoreBadge score={response.overall_score} gap={response.overall_gap} />
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                      {formatDate(response.completed_at || response.last_updated_at)}
                    </td>
                    <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                      <button
                        onClick={(e) => {
                          e.stopPropagation();
                          handleRowClick(response.id);
                        }}
                        className="text-primary hover:text-primary-dark font-medium"
                      >
                        View
                      </button>
                    </td>
                  </tr>
                ))
              )}
            </tbody>
          </table>
        </div>

        {/* Pagination */}
        {renderPagination()}
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\app\admin\settings\page.tsx
----------------------------------------------------------------
'use client';

import { useEffect, useState } from 'react';
import { SettingsAPI } from '@/lib/api/adminEndpoints';
import { SystemSettings } from '@/lib/api/adminTypes';
import { SettingsForm } from '@/components/admin/SettingsForm';
import { Settings as SettingsIcon, CheckCircle, AlertCircle, Loader2 } from 'lucide-react';

export default function AdminSettingsPage() {
  const [settings, setSettings] = useState<SystemSettings>({});
  const [isLoading, setIsLoading] = useState(true);
  const [isSaving, setIsSaving] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [successMessage, setSuccessMessage] = useState<string | null>(null);

  // Default settings to use when no settings exist
  const defaultSettings: SystemSettings = {
    app_name: 'AI Readiness Assessment',
    app_description: 'Evaluate your organization\'s readiness for AI adoption',
    email_from_name: 'AI Readiness Team',
    email_from_email: 'noreply@example.com',
    smtp_host: 'smtp.example.com',
    smtp_port: 587,
    smtp_user: '',
    smtp_password: '',
    question_timeout: 300,
    allow_multiple_attempts: false,
    notify_on_completion: true,
    notify_admin: true,
    admin_email: 'admin@example.com',
  };

  useEffect(() => {
    fetchSettings();
  }, []);

  const fetchSettings = async () => {
    try {
      setIsLoading(true);
      setError(null);
      const data = await SettingsAPI.get();
      // Merge with defaults to ensure all fields exist
      setSettings({ ...defaultSettings, ...data });
    } catch (err) {
      console.error('Failed to fetch settings:', err);
      // Use defaults if API fails
      setSettings(defaultSettings);
      setError('Failed to load settings. Using default values.');
    } finally {
      setIsLoading(false);
    }
  };

  const handleSave = async (formData: Record<string, any>) => {
    try {
      setIsSaving(true);
      setError(null);
      setSuccessMessage(null);

      // Convert settings object to array format for API
      const settingsArray = Object.entries(formData).map(([key, value]) => ({
        key,
        value,
      }));

      await SettingsAPI.update(settingsArray);
      setSettings(formData);
      setSuccessMessage('Settings saved successfully!');
      
      // Clear success message after 3 seconds
      setTimeout(() => {
        setSuccessMessage(null);
      }, 3000);
    } catch (err) {
      console.error('Failed to save settings:', err);
      setError('Failed to save settings. Please try again.');
    } finally {
      setIsSaving(false);
    }
  };

  const handleCancel = () => {
    // Reset to original settings
    fetchSettings();
    setError(null);
    setSuccessMessage(null);
  };

  if (isLoading) {
    return (
      <div className="p-6 lg:p-8">
        {/* Page Header */}
        <div className="mb-8">
          <h1 className="text-2xl lg:text-3xl font-bold text-gray-900">Settings</h1>
          <p className="text-gray-500 mt-1">Configure your application settings</p>
        </div>

        {/* Loading State */}
        <div className="flex items-center justify-center h-64">
          <div className="text-center">
            <Loader2 className="h-8 w-8 animate-spin text-blue-600 mx-auto mb-4" />
            <p className="text-gray-500">Loading settings...</p>
          </div>
        </div>
      </div>
    );
  }

  return (
    <div className="p-6 lg:p-8">
      {/* Page Header */}
      <div className="mb-8">
        <div className="flex items-center gap-3">
          <div className="p-2 bg-blue-100 rounded-lg">
            <SettingsIcon className="h-6 w-6 text-blue-600" />
          </div>
          <div>
            <h1 className="text-2xl lg:text-3xl font-bold text-gray-900">Settings</h1>
            <p className="text-gray-500 mt-1">Configure your application settings</p>
          </div>
        </div>
      </div>

      {/* Success Message */}
      {successMessage && (
        <div className="mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2">
          <CheckCircle className="h-5 w-5 text-green-600" />
          <p className="text-green-700 text-sm font-medium">{successMessage}</p>
        </div>
      )}

      {/* Error Message */}
      {error && (
        <div className="mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2">
          <AlertCircle className="h-5 w-5 text-red-600" />
          <p className="text-red-700 text-sm">{error}</p>
        </div>
      )}

      {/* Settings Form */}
      <SettingsForm
        settings={settings}
        onSave={handleSave}
        onCancel={handleCancel}
        isSaving={isSaving}
      />
    </div>
  );
}


----------------------------------------------------------------
File: src\app\globals.css
----------------------------------------------------------------
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 222.2 47.4% 11.2%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 222.2 84% 4.9%;
    --radius: 0.5rem;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Custom Slider Input Styles */
input[type="range"] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 20px;
  height: 50px;
  background: transparent;
  cursor: pointer;
  border: none;
}

input[type="range"]::-moz-range-thumb {
  width: 20px;
  height: 50px;
  background: transparent;
  border: none;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-runnable-track {
  background: transparent;
  border: none;
}

input[type="range"]::-moz-range-track {
  background: transparent;
  border: none;
}

/* Focus states for accessibility */
input[type="range"]:focus {
  outline: none;
}

input[type="range"]:focus-visible {
  outline: 2px solid #0066cc;
  outline-offset: 2px;
  border-radius: 25px;
}


----------------------------------------------------------------
File: src\app\layout.tsx
----------------------------------------------------------------
import type { Metadata } from 'next';
import { Inter } from 'next/font/google';
import './globals.css';

const inter = Inter({ subsets: ['latin'] });

export const metadata: Metadata = {
  title: 'Digital Readiness Assessment | HORVÁTH',
  description: 'AI readiness assessment by HORVÁTH',
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={inter.className}>{children}</body>
    </html>
  );
}


----------------------------------------------------------------
File: src\app\page.tsx
----------------------------------------------------------------
'use client';

import React, { useEffect } from 'react';
import { Navbar } from '@/components/layout/Navbar';
import { useRouter } from 'next/navigation';
import { useReadinessStore } from '@/store/readiness/readiness.store';

export default function LandingPage() {
  const router = useRouter();
  const { loadAssessment, loadDefinitions, isLoading, error, assessment, resumeSession } = useReadinessStore();

  useEffect(() => {
    // Load assessment on mount
    // Load assessment and definitions on mount
    loadAssessment();
    loadDefinitions();
  }, [loadAssessment]);

  // Check for existing session
  useEffect(() => {
    const sessionToken = localStorage.getItem('sessionToken');
    if (sessionToken) {
       resumeSession(sessionToken);
    }
  }, [resumeSession]);

  const handleStart = () => {
    router.push('/survey');
  };

  return (
    <div className="min-h-screen bg-white font-sans">
      <Navbar />

      {/* Main Content */}
      <main className="pt-16 min-h-screen flex items-center justify-center px-6 py-12 relative overflow-hidden">
        {/* Background Decorative Elements */}
        <div className="absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-purple-100 to-blue-100 rounded-full blur-3xl opacity-30 -translate-x-1/2 -translate-y-1/2" />
        <div className="absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-tl from-blue-100 to-purple-100 rounded-full blur-3xl opacity-30 translate-x-1/2 translate-y-1/2" />

        <div className="relative z-10 max-w-3xl mx-auto text-center">
          {/* Title */}
          <h1 className="text-5xl md:text-6xl font-bold mb-6 leading-tight">
            <span className="bg-gradient-to-r from-purple-400 via-purple-300 to-blue-400 bg-clip-text text-transparent">
              Is Your Organization Ready
            </span>
            <br />
            <span className="bg-gradient-to-r from-purple-400 via-purple-300 to-blue-400 bg-clip-text text-transparent">
              for AI? Find Out with Our
            </span>
            <br />
            <span className="bg-gradient-to-r from-purple-400 via-purple-300 to-blue-400 bg-clip-text text-transparent">
              AI Readiness Index.
            </span>
          </h1>

          {/* Description */}
          <div className="space-y-6 mb-10 text-gray-700 max-w-2xl mx-auto">
            <p className="text-lg leading-relaxed">
              Artificial Intelligence (AI) is transforming industries, but not every organization is ready to embrace its full potential. Our AI Readiness Index provides a quick and easy assessment of your organization's AI readiness.
            </p>
            <p className="text-lg leading-relaxed">
              In just a few minutes, discover your organization's AI potential across key dimensions and receive actionable recommendations to enhance your AI journey.
            </p>
          </div>

          {/* Action Button */}
           <div className="max-w-md mx-auto space-y-4 mb-6">
             {isLoading ? (
                <div className="text-blue-600 font-medium">Loading assessment...</div>
             ) : error ? (
                <div className="text-red-500 font-medium">Error: {error}</div>
             ) : (
                <button
                  onClick={handleStart}
                  className="w-full px-8 py-4 bg-white text-blue-600 border-2 border-blue-600 rounded-full font-semibold text-lg hover:bg-blue-50 transition-all flex items-center justify-center gap-2"
                >
                  Start Assessment
                  <span>→</span>
                </button>
             )}
           </div>

          {/* Terms */}
          <p className="text-sm text-gray-500">
            By clicking get started button, you agree to HORVATH's{' '}
            <a href="#" className="text-blue-600 underline hover:text-blue-700">
              Terms of Service
            </a>
            {' '}and{' '}
            <a href="#" className="text-blue-600 underline hover:text-blue-700">
              Privacy Policy
            </a>
          </p>
        </div>
      </main>

      {/* CO Badge */}
      <div className="fixed bottom-6 left-6 w-12 h-12 bg-[#1a1a2e] text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg z-50">
        CO
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\app\results\page.tsx
----------------------------------------------------------------
import ResultsClient from '@/components/results/ResultsClient';
import type { Metadata } from 'next';

export const metadata: Metadata = {
  title: 'Results | HORVÁTH',
  description: 'Assessment results by HORVÁTH',
};

export default function ResultsPage() {
  return <ResultsClient />;
}


----------------------------------------------------------------
File: src\app\results\recommendations\page.tsx
----------------------------------------------------------------
import type { Metadata } from 'next';
import { RecommendationsPageClient } from '@/components/results/RecommendationsPageClient';

export const metadata: Metadata = {
  title: 'Recommendations | HORVÁTH',
  description: 'Strategic recommendations by HORVÁTH',
};

export default function RecommendationsPage() {
  return <RecommendationsPageClient />;
}


----------------------------------------------------------------
File: src\app\survey\[dimensionId]\page.tsx
----------------------------------------------------------------
import { Suspense } from 'react';
import { DimensionContent } from "@/components/survey/DimensionContent";

type PageProps = {
  params: Promise<{ dimensionId: string }>;
};

export default async function DimensionPage({ params }: PageProps) {
  const { dimensionId } = await params;

  return (
    <Suspense fallback={<div className="h-screen flex items-center justify-center text-gray-400">Loading...</div>}>
      <DimensionContent dimensionId={dimensionId} />
    </Suspense>
  );
}


----------------------------------------------------------------
File: src\app\survey\layout.tsx
----------------------------------------------------------------
import { Navbar } from '@/components/layout/Navbar';
import { Sidebar } from '@/components/layout/sidebar/Sidebar';

export default function SurveyLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <div className="flex min-h-screen bg-[#f5f5f5]">
      <Navbar />

      {/* Floating Sidebar */}
      <Sidebar />

      {/* Main Content - No margin, content handles its own positioning */}
      <main className="w-full mt-16 min-h-screen">
        {children}
      </main>
    </div>
  );
}

----------------------------------------------------------------
File: src\app\survey\page.tsx
----------------------------------------------------------------
'use client';

import React, { useState } from 'react';
import { useRouter } from 'next/navigation';
import { useReadinessStore } from '@/store/readiness/readiness.store';
import { Navbar } from '@/components/layout/Navbar';

export default function SurveyPage() {
  const router = useRouter();
  const { registerParticipant, startAssessment, assessment, isLoading } = useReadinessStore();
  
  const [formData, setFormData] = useState({
    email: '',
    fullName: '',
    companyName: '',
    jobTitle: '',
    consentGiven: false,
  });

  const [error, setError] = useState<string | null>(null);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError(null);
    
    if (!formData.consentGiven) {
      setError('Please agree to the terms to continue.');
      return;
    }

    try {
      // 1. Register participant
      await registerParticipant(formData);
      
      // 2. Start assessment response
      await startAssessment();
      
      // 3. Navigate to first dimension
      // Re-fetch assessment from store to ensure we have the latest data if needed, 
      // but 'assessment' from hook should be sufficient if loaded on Home page.
      // If assessment is null, we might need to handle that, but Home page checks it.
      const firstDimension = assessment?.dimensions[0]?.dimensionKey;
      const firstTopic = assessment?.dimensions[0]?.topics[0]?.topicKey;

      if (firstDimension) { 
        router.push(`/survey/${firstDimension}${firstTopic ? `?topic=${firstTopic}` : ''}`);
      } else {
         setError('Assessment structure not found. Please try again.');
      }
    } catch (err: any) {
      console.error('Failed to start assessment:', err);
      setError(err.message || 'Failed to start assessment. Please try again.');
    }
  };

  return (
    <div className="min-h-screen bg-white font-sans">
      <Navbar />
      
      <main className="pt-24 pb-12 px-6">
        <div className="max-w-xl mx-auto">
          <h1 className="text-3xl font-bold mb-8 text-center">Start Your Assessment</h1>
          
          <form onSubmit={handleSubmit} className="space-y-6">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
              <input
                type="text"
                required
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                value={formData.fullName}
                onChange={(e) => setFormData({ ...formData, fullName: e.target.value })}
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
              <input
                type="email"
                required
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                value={formData.email}
                onChange={(e) => setFormData({ ...formData, email: e.target.value })}
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Company Name</label>
              <input
                type="text"
                required
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                value={formData.companyName}
                onChange={(e) => setFormData({ ...formData, companyName: e.target.value })}
              />
            </div>

            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">Job Title</label>
              <input
                type="text"
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all"
                value={formData.jobTitle}
                onChange={(e) => setFormData({ ...formData, jobTitle: e.target.value })}
              />
            </div>

            <div className="flex items-start gap-3 pt-2">
              <input
                type="checkbox"
                id="consent"
                className="mt-1 w-5 h-5 text-blue-600 rounded focus:ring-blue-500 border-gray-300"
                checked={formData.consentGiven}
                onChange={(e) => setFormData({ ...formData, consentGiven: e.target.checked })}
              />
              <label htmlFor="consent" className="text-sm text-gray-600">
                I agree to the processing of my personal data for the purpose of this assessment
                and accept the Terms of Service.
              </label>
            </div>

            {error && (
              <div className="p-4 bg-red-50 text-red-600 rounded-lg text-sm">
                {error}
              </div>
            )}

            <button
              type="submit"
              disabled={isLoading}
              className="w-full py-4 bg-blue-600 text-white rounded-lg font-semibold text-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {isLoading ? 'Starting Assessment...' : 'Begin Assessment'}
            </button>
          </form>
        </div>
      </main>
    </div>
  );
}

----------------------------------------------------------------
File: src\components\admin\ActivityFeed.tsx
----------------------------------------------------------------
'use client';

import { DashboardActivityItem } from '@/lib/api/adminTypes';
import { FileText, CheckCircle, Clock, User } from 'lucide-react';

interface ActivityFeedProps {
  activities: DashboardActivityItem[];
  isLoading?: boolean;
}

export function ActivityFeed({ activities, isLoading }: ActivityFeedProps) {
  const formatTimestamp = (timestamp: string) => {
    const date = new Date(timestamp);
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const minutes = Math.floor(diff / 60000);
    const hours = Math.floor(diff / 3600000);
    const days = Math.floor(diff / 86400000);

    if (minutes < 1) return 'Just now';
    if (minutes < 60) return `${minutes}m ago`;
    if (hours < 24) return `${hours}h ago`;
    if (days < 7) return `${days}d ago`;
    
    return date.toLocaleDateString('en-US', {
      month: 'short',
      day: 'numeric',
      year: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined
    });
  };

  const getStatusColor = (status: string) => {
    switch (status.toLowerCase()) {
      case 'completed':
        return 'bg-green-100 text-green-800';
      case 'in_progress':
        return 'bg-blue-100 text-blue-800';
      default:
        return 'bg-gray-100 text-gray-800';
    }
  };

  const getActivityIcon = (status: string) => {
    switch (status.toLowerCase()) {
      case 'completed':
        return <CheckCircle className="w-5 h-5 text-green-600" />;
      case 'in_progress':
        return <Clock className="w-5 h-5 text-blue-600" />;
      default:
        return <FileText className="w-5 h-5 text-gray-600" />;
    }
  };

  if (isLoading) {
    return (
      <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 className="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
        <div className="space-y-4">
          {[...Array(5)].map((_, i) => (
            <div key={i} className="animate-pulse flex items-start space-x-4">
              <div className="w-10 h-10 bg-gray-200 rounded-full"></div>
              <div className="flex-1 space-y-2">
                <div className="h-4 bg-gray-200 rounded w-3/4"></div>
                <div className="h-3 bg-gray-200 rounded w-1/2"></div>
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  }

  if (!activities || activities.length === 0) {
    return (
      <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h3 className="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
        <div className="text-center py-8 text-gray-500">
          <FileText className="w-12 h-12 mx-auto mb-3 text-gray-300" />
          <p>No recent activity</p>
        </div>
      </div>
    );
  }

  return (
    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <h3 className="text-lg font-semibold text-gray-900 mb-4">Recent Activity</h3>
      <div className="space-y-4">
        {activities.map((activity) => (
          <div key={activity.id} className="flex items-start space-x-4 p-3 rounded-lg hover:bg-gray-50 transition-colors">
            <div className="flex-shrink-0">
              {getActivityIcon(activity.status)}
            </div>
            <div className="flex-1 min-w-0">
              <div className="flex items-center justify-between mb-1">
                <p className="text-sm font-medium text-gray-900 truncate">
                  {activity.participant_name}
                </p>
                <span className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${getStatusColor(activity.status)}`}>
                  {activity.status.replace('_', ' ')}
                </span>
              </div>
              <p className="text-sm text-gray-500 truncate">
                {activity.company_name}
              </p>
              <div className="flex items-center mt-1 text-xs text-gray-400">
                <Clock className="w-3 h-3 mr-1" />
                <span>{formatTimestamp(activity.timestamp)}</span>
                <span className="mx-2">•</span>
                <span className="truncate">{activity.assessment_title}</span>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

export default ActivityFeed;


----------------------------------------------------------------
File: src\components\admin\AssessmentForm.tsx
----------------------------------------------------------------
'use client';

import { useState, useEffect } from 'react';
import { AssessmentAdminAPI } from '@/lib/api/adminEndpoints';
import { AssessmentListItem, AssessmentWithDimensions, CreateAssessmentRequest, AssessmentDimension, AssessmentTopic } from '@/lib/api/adminTypes';
import { X, Plus, Trash2, ChevronDown, ChevronUp, Save, Loader2 } from 'lucide-react';

interface AssessmentFormProps {
  assessment?: AssessmentListItem | AssessmentWithDimensions | null;
  onSuccess: () => void;
  onCancel: () => void;
}

interface DimensionFormData {
  id?: string;
  key: string;
  title: string;
  description: string;
  category: string;
  order: number;
  topics: TopicFormData[];
}

interface TopicFormData {
  id?: string;
  key: string;
  label: string;
  prompt: string;
  help_text: string;
  order: number;
}

const CATEGORIES = [
  'Leadership',
  'Strategy',
  'Operations',
  'Marketing',
  'Finance',
  'Technology',
  'People',
  'Culture',
  'Customer',
  'Innovation'
];

export function AssessmentForm({ assessment, onSuccess, onCancel }: AssessmentFormProps) {
  const [isLoading, setIsLoading] = useState(false);
  const [isLoadingDetails, setIsLoadingDetails] = useState(!!assessment);
  const [dimensions, setDimensions] = useState<DimensionFormData[]>([]);
  const [expandedDimensions, setExpandedDimensions] = useState<Set<number>>(new Set());
  const [error, setError] = useState<string | null>(null);

  const [formData, setFormData] = useState({
    title: '',
    description: '',
    version: 1
  });

  useEffect(() => {
    if (assessment) {
      loadAssessmentDetails(assessment.id);
    }
  }, [assessment]);

  const loadAssessmentDetails = async (id: string) => {
    try {
      setIsLoadingDetails(true);
      const details = await AssessmentAdminAPI.get(id);
      setFormData({
        title: details.title || '',
        description: details.description || '',
        version: details.version || 1
      });
      setDimensions(details.dimensions?.map(dim => ({
        id: dim.id,
        key: dim.key,
        title: dim.title,
        description: dim.description || '',
        category: dim.category,
        order: dim.order,
        topics: dim.topics?.map(topic => ({
          id: topic.id,
          key: topic.key,
          label: topic.label,
          prompt: topic.prompt,
          help_text: topic.help_text || '',
          order: topic.order
        })) || []
      })) || []);
      // Expand all dimensions by default
      setExpandedDimensions(new Set(details.dimensions?.map((_, i) => i) || []));
    } catch (err) {
      console.error('Failed to load assessment details:', err);
      setError('Failed to load assessment details');
    } finally {
      setIsLoadingDetails(false);
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    try {
      setIsLoading(true);
      setError(null);

      const payload: CreateAssessmentRequest = {
        title: formData.title,
        description: formData.description,
        version: formData.version,
        dimensions: dimensions.map((dim, index) => ({
          key: dim.key || dim.title.toLowerCase().replace(/\s+/g, '_'),
          title: dim.title,
          description: dim.description,
          category: dim.category,
          order: dim.order || index,
          topics: dim.topics.map((topic, topicIndex) => ({
            key: topic.key || topic.label.toLowerCase().replace(/\s+/g, '_'),
            label: topic.label,
            prompt: topic.prompt,
            help_text: topic.help_text,
            order: topic.order || topicIndex
          }))
        }))
      };

      if (assessment?.id) {
        await AssessmentAdminAPI.update(assessment.id, payload);
      } else {
        await AssessmentAdminAPI.create(payload);
      }

      onSuccess();
    } catch (err) {
      console.error('Failed to save assessment:', err);
      setError('Failed to save assessment. Please try again.');
    } finally {
      setIsLoading(false);
    }
  };

  const addDimension = () => {
    const newDimension: DimensionFormData = {
      key: '',
      title: '',
      description: '',
      category: CATEGORIES[0],
      order: dimensions.length,
      topics: []
    };
    setDimensions([...dimensions, newDimension]);
    setExpandedDimensions(prev => {
      const newSet = new Set(prev);
      newSet.add(dimensions.length);
      return newSet;
    });
  };

  const removeDimension = (index: number) => {
    setDimensions(dimensions.filter((_, i) => i !== index));
  };

  const updateDimension = (index: number, field: keyof DimensionFormData, value: any) => {
    setDimensions(dimensions.map((dim, i) => 
      i === index ? { ...dim, [field]: value } : dim
    ));
  };

  const addTopic = (dimensionIndex: number) => {
    const newTopic: TopicFormData = {
      key: '',
      label: '',
      prompt: '',
      help_text: '',
      order: dimensions[dimensionIndex].topics.length
    };
    setDimensions(dimensions.map((dim, i) => 
      i === dimensionIndex 
        ? { ...dim, topics: [...dim.topics, newTopic] }
        : dim
    ));
  };

  const removeTopic = (dimensionIndex: number, topicIndex: number) => {
    setDimensions(dimensions.map((dim, i) => 
      i === dimensionIndex 
        ? { ...dim, topics: dim.topics.filter((_, j) => j !== topicIndex) }
        : dim
    ));
  };

  const updateTopic = (dimensionIndex: number, topicIndex: number, field: keyof TopicFormData, value: string) => {
    setDimensions(dimensions.map((dim, i) => 
      i === dimensionIndex 
        ? { 
            ...dim, 
            topics: dim.topics.map((topic, j) => 
              j === topicIndex ? { ...topic, [field]: value } : topic
            )
          }
        : dim
    ));
  };

  const toggleDimension = (index: number) => {
    const newExpanded = new Set(expandedDimensions);
    if (newExpanded.has(index)) {
      newExpanded.delete(index);
    } else {
      newExpanded.add(index);
    }
    setExpandedDimensions(newExpanded);
  };

  return (
    <div className="fixed inset-0 z-50 overflow-y-auto">
      {/* Backdrop */}
      <div className="fixed inset-0 bg-black/50" onClick={onCancel} />

      {/* Modal */}
      <div className="flex min-h-full items-center justify-center p-4">
        <div className="relative bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col">
          {/* Header */}
          <div className="flex items-center justify-between px-6 py-4 border-b border-gray-200">
            <h2 className="text-xl font-semibold text-gray-900">
              {assessment ? 'Edit Assessment' : 'Create New Assessment'}
            </h2>
            <button
              onClick={onCancel}
              className="p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors"
            >
              <X className="w-5 h-5" />
            </button>
          </div>

          {/* Error Banner */}
          {error && (
            <div className="mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
              <p className="text-sm text-red-600">{error}</p>
            </div>
          )}

          {/* Form Content */}
          <div className="flex-1 overflow-y-auto p-6">
            {isLoadingDetails ? (
              <div className="flex items-center justify-center py-12">
                <Loader2 className="w-8 h-8 animate-spin text-primary" />
              </div>
            ) : (
              <form onSubmit={handleSubmit} className="space-y-6">
                {/* Basic Info */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Title *
                    </label>
                    <input
                      type="text"
                      required
                      value={formData.title}
                      onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"
                      placeholder="Enter assessment title"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-medium text-gray-700 mb-1">
                      Version *
                    </label>
                    <input
                      type="number"
                      required
                      min="1"
                      value={formData.version}
                      onChange={(e) => setFormData({ ...formData, version: parseInt(e.target.value) || 1 })}
                      className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"
                    />
                  </div>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-700 mb-1">
                    Description
                  </label>
                  <textarea
                    value={formData.description}
                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}
                    rows={3}
                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"
                    placeholder="Enter assessment description"
                  />
                </div>

                {/* Dimensions Section */}
                <div>
                  <div className="flex items-center justify-between mb-4">
                    <h3 className="text-lg font-medium text-gray-900">Dimensions</h3>
                    <button
                      type="button"
                      onClick={addDimension}
                      className="inline-flex items-center px-3 py-1.5 text-sm font-medium text-primary border border-primary rounded-lg hover:bg-primary/5 transition-colors"
                    >
                      <Plus className="w-4 h-4 mr-1" />
                      Add Dimension
                    </button>
                  </div>

                  {dimensions.length === 0 ? (
                    <div className="text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300">
                      <p className="text-gray-500">No dimensions added yet</p>
                      <p className="text-sm text-gray-400 mt-1">Click "Add Dimension" to get started</p>
                    </div>
                  ) : (
                    <div className="space-y-4">
                      {dimensions.map((dimension, dimensionIndex) => (
                        <div key={dimensionIndex} className="border border-gray-200 rounded-lg overflow-hidden">
                          {/* Dimension Header */}
                          <div 
                            className="flex items-center justify-between px-4 py-3 bg-gray-50 cursor-pointer"
                            onClick={() => toggleDimension(dimensionIndex)}
                          >
                            <div className="flex items-center space-x-3">
                              <span className="text-sm font-medium text-gray-900">
                                Dimension {dimensionIndex + 1}
                              </span>
                              {dimension.title && (
                                <span className="text-sm text-gray-500">
                                  - {dimension.title}
                                </span>
                              )}
                            </div>
                            <div className="flex items-center space-x-2">
                              <button
                                type="button"
                                onClick={(e) => {
                                  e.stopPropagation();
                                  removeDimension(dimensionIndex);
                                }}
                                className="p-1 text-red-500 hover:bg-red-50 rounded"
                              >
                                <Trash2 className="w-4 h-4" />
                              </button>
                              {expandedDimensions.has(dimensionIndex) ? (
                                <ChevronUp className="w-5 h-5 text-gray-400" />
                              ) : (
                                <ChevronDown className="w-5 h-5 text-gray-400" />
                              )}
                            </div>
                          </div>

                          {/* Dimension Content */}
                          {expandedDimensions.has(dimensionIndex) && (
                            <div className="p-4 space-y-4">
                              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                  <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Title *
                                  </label>
                                  <input
                                    type="text"
                                    required
                                    value={dimension.title}
                                    onChange={(e) => updateDimension(dimensionIndex, 'title', e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"
                                    placeholder="e.g., Leadership & Governance"
                                  />
                                </div>
                                <div>
                                  <label className="block text-sm font-medium text-gray-700 mb-1">
                                    Category
                                  </label>
                                  <select
                                    value={dimension.category}
                                    onChange={(e) => updateDimension(dimensionIndex, 'category', e.target.value)}
                                    className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"
                                  >
                                    {CATEGORIES.map(cat => (
                                      <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                  </select>
                                </div>
                              </div>

                              <div>
                                <label className="block text-sm font-medium text-gray-700 mb-1">
                                  Description
                                </label>
                                <textarea
                                  value={dimension.description}
                                  onChange={(e) => updateDimension(dimensionIndex, 'description', e.target.value)}
                                  rows={2}
                                  className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary"
                                  placeholder="Describe what this dimension measures"
                                />
                              </div>

                              {/* Topics */}
                              <div>
                                <div className="flex items-center justify-between mb-2">
                                  <label className="block text-sm font-medium text-gray-700">
                                    Topics
                                  </label>
                                  <button
                                    type="button"
                                    onClick={() => addTopic(dimensionIndex)}
                                    className="inline-flex items-center px-2 py-1 text-xs font-medium text-primary hover:bg-primary/5 rounded"
                                  >
                                    <Plus className="w-3 h-3 mr-1" />
                                    Add Topic
                                  </button>
                                </div>

                                {dimension.topics.length === 0 ? (
                                  <div className="text-center py-4 bg-gray-50 rounded border border-dashed border-gray-300">
                                    <p className="text-sm text-gray-500">No topics added</p>
                                  </div>
                                ) : (
                                  <div className="space-y-3">
                                    {dimension.topics.map((topic, topicIndex) => (
                                      <div key={topicIndex} className="p-3 bg-gray-50 rounded-lg">
                                        <div className="flex items-start justify-between mb-2">
                                          <span className="text-xs font-medium text-gray-500">
                                            Topic {topicIndex + 1}
                                          </span>
                                          <button
                                            type="button"
                                            onClick={() => removeTopic(dimensionIndex, topicIndex)}
                                            className="p-1 text-red-500 hover:bg-red-50 rounded"
                                          >
                                            <Trash2 className="w-3 h-3" />
                                          </button>
                                        </div>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                                          <input
                                            type="text"
                                            value={topic.label}
                                            onChange={(e) => updateTopic(dimensionIndex, topicIndex, 'label', e.target.value)}
                                            className="px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary"
                                            placeholder="Label *"
                                          />
                                          <input
                                            type="text"
                                            value={topic.prompt}
                                            onChange={(e) => updateTopic(dimensionIndex, topicIndex, 'prompt', e.target.value)}
                                            className="px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary"
                                            placeholder="Prompt"
                                          />
                                        </div>
                                        <input
                                          type="text"
                                          value={topic.help_text}
                                          onChange={(e) => updateTopic(dimensionIndex, topicIndex, 'help_text', e.target.value)}
                                          className="w-full mt-2 px-2 py-1.5 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary focus:border-primary"
                                          placeholder="Help text (optional)"
                                        />
                                      </div>
                                    ))}
                                  </div>
                                )}
                              </div>
                            </div>
                          )}
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              </form>
            )}
          </div>

          {/* Footer */}
          <div className="flex items-center justify-end space-x-3 px-6 py-4 border-t border-gray-200 bg-gray-50">
            <button
              type="button"
              onClick={onCancel}
              className="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
            >
              Cancel
            </button>
            <button
              onClick={handleSubmit}
              disabled={isLoading || isLoadingDetails}
              className="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-primary rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50"
            >
              {isLoading ? (
                <>
                  <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                  Saving...
                </>
              ) : (
                <>
                  <Save className="w-4 h-4 mr-2" />
                  {assessment ? 'Update Assessment' : 'Create Assessment'}
                </>
              )}
            </button>
          </div>
        </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\admin\SettingsForm.tsx
----------------------------------------------------------------
'use client';

import { useState, useEffect } from 'react';
import { 
  Settings, 
  Mail, 
  ClipboardList, 
  Bell, 
  ChevronDown, 
  ChevronUp,
  Save,
  X,
  Loader2
} from 'lucide-react';

interface SettingsFormProps {
  settings: Record<string, any>;
  onSave: (settings: Record<string, any>) => Promise<void>;
  onCancel: () => void;
  isSaving: boolean;
}

// Section configuration
interface Section {
  id: string;
  title: string;
  description: string;
  icon: React.ElementType;
  fields: FieldConfig[];
}

interface FieldConfig {
  key: string;
  label: string;
  description?: string;
  type: 'text' | 'email' | 'number' | 'password' | 'boolean';
}

const SECTIONS: Section[] = [
  {
    id: 'general',
    title: 'General Settings',
    description: 'Basic application information',
    icon: Settings,
    fields: [
      { key: 'app_name', label: 'Application Name', description: 'The name of your application', type: 'text' },
      { key: 'app_description', label: 'Application Description', description: 'Brief description of your application', type: 'text' },
    ],
  },
  {
    id: 'email',
    title: 'Email Settings',
    description: 'Configure email and SMTP settings',
    icon: Mail,
    fields: [
      { key: 'email_from_name', label: 'From Name', description: 'Sender name for emails', type: 'text' },
      { key: 'email_from_email', label: 'From Email', description: 'Sender email address', type: 'email' },
      { key: 'smtp_host', label: 'SMTP Host', description: 'SMTP server hostname', type: 'text' },
      { key: 'smtp_port', label: 'SMTP Port', description: 'SMTP server port', type: 'number' },
      { key: 'smtp_user', label: 'SMTP Username', description: 'SMTP authentication username', type: 'text' },
      { key: 'smtp_password', label: 'SMTP Password', description: 'SMTP authentication password', type: 'password' },
    ],
  },
  {
    id: 'assessment',
    title: 'Assessment Settings',
    description: 'Configure assessment behavior',
    icon: ClipboardList,
    fields: [
      { key: 'question_timeout', label: 'Question Timeout (seconds)', description: 'Time limit for each question', type: 'number' },
      { key: 'allow_multiple_attempts', label: 'Allow Multiple Attempts', description: 'Allow participants to retake the assessment', type: 'boolean' },
    ],
  },
  {
    id: 'notifications',
    title: 'Notification Settings',
    description: 'Configure notification preferences',
    icon: Bell,
    fields: [
      { key: 'notify_on_completion', label: 'Email Notifications on Completion', description: 'Send email when assessment is completed', type: 'boolean' },
      { key: 'notify_admin', label: 'Notify Admin', description: 'Send notification to admin when assessments are completed', type: 'boolean' },
      { key: 'admin_email', label: 'Admin Email', description: 'Email address for admin notifications', type: 'email' },
    ],
  },
];

export function SettingsForm({ settings, onSave, onCancel, isSaving }: SettingsFormProps) {
  const [formData, setFormData] = useState<Record<string, any>>({});
  const [openSections, setOpenSections] = useState<Set<string>>(new Set(SECTIONS.map(s => s.id)));

  useEffect(() => {
    setFormData(settings);
  }, [settings]);

  const toggleSection = (sectionId: string) => {
    setOpenSections(prev => {
      const newSet = new Set(prev);
      if (newSet.has(sectionId)) {
        newSet.delete(sectionId);
      } else {
        newSet.add(sectionId);
      }
      return newSet;
    });
  };

  const handleChange = (key: string, value: any) => {
    setFormData(prev => ({
      ...prev,
      [key]: value,
    }));
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    await onSave(formData);
  };

  const renderField = (field: FieldConfig) => {
    const value = formData[field.key] !== undefined ? formData[field.key] : '';

    if (field.type === 'boolean') {
      return (
        <div className="flex items-center justify-between">
          <div className="flex items-center">
            <button
              type="button"
              onClick={() => handleChange(field.key, !value)}
              className={`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${value ? 'bg-blue-600' : 'bg-gray-200'}`}
              role="switch"
              aria-checked={value}
            >
              <span
                className={`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${value ? 'translate-x-5' : 'translate-x-0'}`}
              />
            </button>
            {value ? (
              <span className="ml-2 text-sm text-green-600 font-medium">Enabled</span>
            ) : (
              <span className="ml-2 text-sm text-gray-500">Disabled</span>
            )}
          </div>
        </div>
      );
    }

    if (field.type === 'number') {
      return (
        <input
          type="number"
          value={value}
          onChange={(e) => handleChange(field.key, parseInt(e.target.value) || 0)}
          className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 sm:text-sm"
        />
      );
    }

    if (field.type === 'password') {
      return (
        <input
          type="password"
          value={value}
          onChange={(e) => handleChange(field.key, e.target.value)}
          className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 sm:text-sm"
          placeholder={value ? '••••••••' : ''}
        />
      );
    }

    return (
      <input
        type={field.type}
        value={value}
        onChange={(e) => handleChange(field.key, e.target.value)}
        className="mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 sm:text-sm"
      />
    );
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-6">
      {SECTIONS.map((section) => {
        const Icon = section.icon;
        const isOpen = openSections.has(section.id);

        return (
          <div key={section.id} className="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
            {/* Section Header */}
            <button
              type="button"
              onClick={() => toggleSection(section.id)}
              className="w-full px-6 py-4 flex items-center justify-between bg-gray-50 hover:bg-gray-100 transition-colors"
            >
              <div className="flex items-center gap-3">
                <div className="p-2 bg-blue-100 rounded-lg">
                  <Icon className="h-5 w-5 text-blue-600" />
                </div>
                <div className="text-left">
                  <h3 className="text-lg font-semibold text-gray-900">{section.title}</h3>
                  <p className="text-sm text-gray-500">{section.description}</p>
                </div>
              </div>
              {isOpen ? (
                <ChevronUp className="h-5 w-5 text-gray-400" />
              ) : (
                <ChevronDown className="h-5 w-5 text-gray-400" />
              )}
            </button>

            {/* Section Content */}
            {isOpen && (
              <div className="px-6 py-4 border-t border-gray-200 space-y-4">
                {section.fields.map((field) => (
                  <div key={field.key}>
                    <label htmlFor={field.key} className="block text-sm font-medium text-gray-700">
                      {field.label}
                    </label>
                    {field.description && (
                      <p className="text-xs text-gray-500 mt-0.5">{field.description}</p>
                    )}
                    <div className="mt-1">
                      {renderField(field)}
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        );
      })}

      {/* Action Buttons */}
      <div className="flex items-center justify-end gap-3 pt-4">
        <button
          type="button"
          onClick={onCancel}
          disabled={isSaving}
          className="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          <X className="h-4 w-4 mr-2" />
          Cancel
        </button>
        <button
          type="submit"
          disabled={isSaving}
          className="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          {isSaving ? (
            <>
              <Loader2 className="h-4 w-4 mr-2 animate-spin" />
              Saving...
            </>
          ) : (
            <>
              <Save className="h-4 w-4 mr-2" />
              Save Settings
            </>
          )}
        </button>
      </div>
    </form>
  );
}

export default SettingsForm;


----------------------------------------------------------------
File: src\components\admin\StatCard.tsx
----------------------------------------------------------------
'use client';

import { LucideIcon } from 'lucide-react';

interface StatCardProps {
  icon: LucideIcon;
  label: string;
  value: string | number;
  change?: {
    value: number;
    type: 'positive' | 'negative' | 'neutral';
  };
  iconColor?: string;
}

export function StatCard({ icon: Icon, label, value, change, iconColor = 'text-primary' }: StatCardProps) {
  const getChangeColor = () => {
    if (!change) return '';
    switch (change.type) {
      case 'positive':
        return 'text-green-600';
      case 'negative':
        return 'text-red-600';
      default:
        return 'text-gray-500';
    }
  };

  const getChangeIcon = () => {
    if (!change) return null;
    if (change.type === 'positive') {
      return (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 10l7-7m0 0l7 7m-7-7v18" />
        </svg>
      );
    }
    if (change.type === 'negative') {
      return (
        <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 14l-7 7m0 0l-7-7m7 7V3" />
        </svg>
      );
    }
    return null;
  };

  return (
    <div className="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <div className="flex items-start justify-between">
        <div className="flex-1">
          <p className="text-sm font-medium text-gray-500 mb-1">{label}</p>
          <p className="text-2xl font-bold text-gray-900">{value}</p>
          {change && (
            <div className={`flex items-center mt-2 text-sm ${getChangeColor()}`}>
              {getChangeIcon()}
              <span className="ml-1">
                {change.value > 0 ? '+' : ''}{change.value}%
              </span>
            </div>
          )}
        </div>
        <div className={`p-3 rounded-lg bg-gray-50 ${iconColor}`}>
          <Icon className="w-6 h-6" />
        </div>
      </div>
    </div>
  );
}

export default StatCard;


----------------------------------------------------------------
File: src\components\common\ResetButton.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { useRouter } from 'next/navigation';
import { useReadinessStore } from '@/store/readiness/readiness.store';

interface ResetButtonProps {
  className?: string;
  label?: string;
  variant?: 'sidebar' | 'results';
}

export function ResetButton({ className = '', label = 'Reset Assessment', variant = 'results' }: ResetButtonProps) {
  const router = useRouter();
  const clearAllData = useReadinessStore((state) => state.clearAllData);

  const handleReset = () => {
    // Basic confirm - could use a nicer dialog later
    if (window.confirm('Are you sure you want to reset your assessment? All progress will be lost.')) {
      clearAllData();
      router.push('/survey');
    }
  };

  const baseClasses = "text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500";
  
  const variantClasses = variant === 'sidebar' 
    ? "text-gray-400 hover:text-red-600 block text-center py-2" // Sidebar specific
    : "text-gray-400 hover:text-red-600 px-4 py-2 rounded-md hover:bg-red-50"; // Results specific

  return (
    <button
      onClick={handleReset}
      className={`${baseClasses} ${variantClasses} ${className}`}
      type="button"
    >
      {label}
    </button>
  );
}


----------------------------------------------------------------
File: src\components\layout\Navbar.tsx
----------------------------------------------------------------
'use client';

import { useRouter } from 'next/navigation';

interface NavbarProps {
  showBackButton?: boolean;
  backUrl?: string;
}

export function Navbar({ showBackButton = false, backUrl }: NavbarProps) {
  const router = useRouter();
  
  return (
    <header className="fixed top-0 left-0 right-0 h-16 bg-white border-b border-gray-200 flex items-center justify-between px-8 z-50">
      {/* Logo */}
      <div className="flex items-center gap-2">
        <div className="w-8 h-8 border-2 border-black rounded-md transform rotate-45" />
        <div>
          <span className="font-semibold text-lg">HORVÁTH</span>
          <span className="text-gray-600 text-sm ml-2">| IMPACT PLATFORM</span>
        </div>
      </div>
      
      {/* Right side */}
      <div className="flex items-center gap-4">
        {showBackButton && backUrl && (
          <button
            onClick={() => router.push(backUrl)}
            className="text-sm text-gray-600 hover:text-gray-900 transition-colors"
          >
            ← Back
          </button>
        )}
      </div>
    </header>
  );
}


----------------------------------------------------------------
File: src\components\layout\sidebar\Sidebar.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import { useReadinessStore } from '@/store/readiness/readiness.store';
import { AssessmentGateDialog } from '@/components/survey/AssessmentGateDialog';
import { getMissingItems, MissingItem } from '@/lib/assessment/progress';
import { ResetButton } from '@/components/common/ResetButton';

export function Sidebar() {
  const pathname = usePathname();
  const assessment = useReadinessStore((state) => state.assessment);
  const responses = useReadinessStore((state) => state.responses);
  const loadAssessment = useReadinessStore((state) => state.loadAssessment);
  
  const [showGate, setShowGate] = React.useState(false);
  const [missingItems, setMissingItems] = React.useState<MissingItem[]>([]);

  React.useEffect(() => {
    if (!assessment) {
      loadAssessment();
    }
  }, [assessment, loadAssessment]);

  // If still loading or failed, show skeleton or nothing? 
  // For sidebar, we might validly have no data yet.
  if (!assessment) return null; // Or a loading state

  const handleSubmit = () => {
    // We need to map store data to the expected format for getMissingItems 
    // OR update getMissingItems to use store data. 
    // For now, let's adapt the store data to match what getMissingItems expects if possible,
    // or better, implement a store-aware check here since getMissingItems relies on the old static definition.
    
    // Quick store-based check:
    const missing: any[] = [];
    assessment.dimensions.forEach(dim => {
        dim.topics.forEach(topic => {
            if (!responses[topic.id]) {
                missing.push({
                    dimensionId: dim.dimensionKey,
                    dimensionTitle: dim.title,
                    topicId: topic.id,
                    topicLabel: topic.label
                });
            }
        });
    });

    setMissingItems(missing);
    setShowGate(true);
  };

  // Check if a topic is completed (present in responses)
  const isTopicCompleted = (topicId: string): boolean => {
    return !!responses[topicId];
  };

  // Check if current path matches this topic (using topic ID)
  // URL: /survey/[dimensionKey]?topic=[topicKey] 
  // The API distinguishes between ID (uuid) and Key (slug). 
  // Stores uses ID for responses. Sidebar links need to use Keys for clean URLs? 
  // Or did we switch to IDs in the URLs too?
  // Let's check `endpoints.ts` and `types.ts`... `TopicStructure` has `id` and `topicKey`.
  // The store uses `id` for responses key.
  // The URL routing in `DimensionContent` uses `topicKey` if we followed the pattern, 
  // BUT `DimensionContent` implementation I wrote uses:
  // `router.push(/survey/${dimension.dimensionKey}?topic=${targetTopic.topicKey});`
  // Wait, I used `topic.topicKey` in `DimensionContent`.
  // AND `TopicCard` uses `topic.id` to look up responses.
  
  // So Sidebar needs to link to keys but check completion by ID.

  const isActive = (dimensionKey: string, topicKey: string): boolean => {
    return pathname.includes(`/survey/${dimensionKey}`) && pathname.includes(topicKey);
  };

  return (
    <>
      {/* Floating Card Sidebar */}
      <aside className="fixed left-6 top-24 w-[300px] h-[calc(100vh-7rem)] bg-white rounded-2xl shadow-xl flex flex-col overflow-hidden">
        
        {/* Scrollable Content Area - Dimensions and Topics */}
        <nav className="flex-1 overflow-y-auto px-6 py-6">
          <div className="space-y-0">
            {assessment.dimensions.map((dimension, dimIdx) => (
              <div key={dimension.id} className="mb-6">
                {/* Dimension Title - Gray number */}
                <h3 className="text-sm font-medium text-gray-500 mb-2 px-2">
                  {dimIdx + 1}. {dimension.title}
                </h3>

                {/* Topics List */}
                <div className="space-y-0.5">
                  {dimension.topics.map((topic) => {
                    const completed = isTopicCompleted(topic.id);
                    const active = isActive(dimension.dimensionKey, topic.topicKey);
                    
                    // Determine state
                    let itemClass = '';
                    let icon = null;
                    let textClass = '';

                    if (active) {
                      itemClass = 'flex items-center gap-2 px-3 py-2.5 mb-0.5 rounded-lg bg-[#E3F2FD] transition-colors';
                      icon = <span className="text-[#0066cc] text-sm font-bold">▶</span>;
                      textClass = 'text-[#0066cc] font-medium text-[15px]';
                    } else if (completed) {
                      itemClass = 'flex items-center gap-2 px-3 py-2.5 mb-0.5 rounded-lg hover:bg-gray-50 transition-colors';
                      icon = <span className="text-[#0066cc] text-sm font-bold">✓</span>;
                      textClass = 'text-[#0066cc] font-normal text-[15px]';
                    } else {
                      itemClass = 'block px-3 py-2.5 mb-0.5 rounded-lg';
                      textClass = 'text-gray-400 italic text-[15px] font-normal';
                    }

                    return (
                      <Link
                        key={topic.id}
                        href={`/survey/${dimension.dimensionKey}?topic=${topic.topicKey}`}
                        className={itemClass}
                      >
                        {!!icon && icon}
                        <span className={textClass}>{topic.label}</span>
                      </Link>
                    );
                  })}
                </div>
              </div>
            ))}
          </div>
        </nav>

        {/* Fixed Submit Button at Bottom */}
        <div className="shrink-0 px-6 py-5 bg-white space-y-3">
          <button
            onClick={handleSubmit}
            className="block w-full px-6 py-3.5 bg-[#0066cc] text-white rounded-full text-base font-semibold text-center cursor-pointer transition-all duration-300 hover:bg-[#0052a3] shadow-md hover:shadow-lg"
          >
            Submit
          </button>
          
          <ResetButton variant="sidebar" />
        </div>
      </aside>

      {/* CO Badge - Black circle bottom left */}
      <div className="fixed bottom-6 left-6 w-12 h-12 bg-black text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg z-50">
        CO
      </div>

      <AssessmentGateDialog 
        open={showGate} 
        onClose={() => setShowGate(false)} 
        missing={missingItems} 
      />
    </>
  );
}

----------------------------------------------------------------
File: src\components\results\charts\BubbleChart.tsx
----------------------------------------------------------------
'use client';

import { useState, useMemo } from 'react';
import { motion } from 'framer-motion';
import { RecommendationBubble } from '@/lib/recommendations/definition';

interface BubbleChartProps {
  bubbles: RecommendationBubble[];
  overallScore: number;
  date?: string;
  selectedRank?: number | null;
  highlightedDimension?: string | null;
  onBubbleClick?: (rank: number) => void;
  onLegendClick?: (dimensionId: string) => void;
}

const DIMENSION_LEGEND = [
  { id: 'strategy', name: 'Strategy', color: '#10b981' },
  { id: 'value', name: 'Value', color: '#f97316' },
  { id: 'data', name: 'Data', color: '#3b82f6' },
  { id: 'technology', name: 'Technology', color: '#1d4ed8' },
  { id: 'capabilities', name: 'Capabilities', color: '#8b5cf6' },
  { id: 'governance', name: 'Governance', color: '#ec4899' },
];

/** Map dimension id → color for dim-matching. */
const DIM_ID_TO_COLOR: Record<string, string> = {};
DIMENSION_LEGEND.forEach((d) => (DIM_ID_TO_COLOR[d.id] = d.color));

export function BubbleChart({
  bubbles,
  overallScore,
  date = new Date().toLocaleDateString('en-US', { month: '2-digit', day: '2-digit' }),
  selectedRank = null,
  highlightedDimension = null,
  onBubbleClick,
  onLegendClick,
}: BubbleChartProps) {
  const chartWidth = 560;
  const chartHeight = 380;
  const padding = 44;

  const xScale = (v: number) =>
    padding + (v / 10) * (chartWidth - 2 * padding);
  const yScale = (v: number) =>
    chartHeight - padding - (v / 10) * (chartHeight - 2 * padding);

  const ticks = useMemo(() => [0, 2, 4, 6, 8, 10], []);

  const [hoveredRank, setHoveredRank] = useState<number | null>(null);

  if (bubbles.length === 0) {
    return (
      <div className="bg-white rounded-xl p-6 border border-gray-200">
        <div className="text-center py-12">
          <p className="text-gray-500">Generating recommendations…</p>
        </div>
      </div>
    );
  }

  // Find highlighted color for dim-filtering
  const highlightedColor = highlightedDimension
    ? DIM_ID_TO_COLOR[highlightedDimension]
    : null;

  return (
    <div className="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
      <h3 className="text-lg font-semibold text-gray-900 mb-4">Bubble Chart</h3>

      {/* SVG Chart */}
      <svg
        width="100%"
        viewBox={`0 0 ${chartWidth} ${chartHeight}`}
        className="overflow-visible"
      >
        {/* Grid – verticals */}
        {ticks.map((v) => (
          <line
            key={`gv-${v}`}
            x1={xScale(v)}
            y1={padding}
            x2={xScale(v)}
            y2={chartHeight - padding}
            stroke="#e5e7eb"
            strokeWidth="1"
            strokeDasharray="3,3"
          />
        ))}

        {/* Grid – horizontals */}
        {ticks.map((v) => (
          <line
            key={`gh-${v}`}
            x1={padding}
            y1={yScale(v)}
            x2={chartWidth - padding}
            y2={yScale(v)}
            stroke="#e5e7eb"
            strokeWidth="1"
            strokeDasharray="3,3"
          />
        ))}

        {/* Axes */}
        <line
          x1={padding}
          y1={chartHeight - padding}
          x2={chartWidth - padding}
          y2={chartHeight - padding}
          stroke="#374151"
          strokeWidth="2"
        />
        <line
          x1={padding}
          y1={padding}
          x2={padding}
          y2={chartHeight - padding}
          stroke="#374151"
          strokeWidth="2"
        />

        {/* X tick labels */}
        {ticks.map((v) => (
          <text
            key={`xl-${v}`}
            x={xScale(v)}
            y={chartHeight - padding + 18}
            textAnchor="middle"
            fontSize="11"
            fill="#6b7280"
          >
            {v}
          </text>
        ))}

        {/* Y tick labels */}
        {ticks.map((v) => (
          <text
            key={`yl-${v}`}
            x={padding - 16}
            y={yScale(v) + 4}
            textAnchor="middle"
            fontSize="11"
            fill="#6b7280"
          >
            {v}
          </text>
        ))}

        {/* Bubbles */}
        {bubbles.map((b, i) => {
          const isSelected = selectedRank === b.rank;
          const isHovered = hoveredRank === b.rank;
          const active = isSelected || isHovered;
          const isDimmed = highlightedColor ? b.color !== highlightedColor : false;

          return (
            <motion.g
              key={b.id}
              initial={{ opacity: 0, scale: 0 }}
              animate={{
                opacity: isDimmed ? 0.25 : 1,
                scale: active ? 1.15 : 1,
              }}
              transition={{ duration: 0.3, delay: i * 0.04 }}
              style={{ cursor: 'pointer', transformOrigin: `${xScale(b.x)}px ${yScale(b.y)}px` }}
              onMouseEnter={() => setHoveredRank(b.rank)}
              onMouseLeave={() => setHoveredRank(null)}
              onClick={() => onBubbleClick?.(b.rank)}
            >
              {/* Selection / hover ring */}
              {active && (
                <circle
                  cx={xScale(b.x)}
                  cy={yScale(b.y)}
                  r={b.size / 2 + 5}
                  fill="none"
                  stroke={b.color}
                  strokeWidth="3"
                  opacity={0.6}
                />
              )}

              {/* Main circle */}
              <circle
                cx={xScale(b.x)}
                cy={yScale(b.y)}
                r={b.size / 2}
                fill={b.color}
                opacity={active ? 0.92 : 0.72}
              />

              {/* Rank label */}
              <text
                x={xScale(b.x)}
                y={yScale(b.y)}
                textAnchor="middle"
                dominantBaseline="central"
                fontSize="14"
                fontWeight="bold"
                fill="white"
                className="pointer-events-none select-none"
              >
                {b.label}
              </text>
            </motion.g>
          );
        })}
      </svg>

      {/* Axis descriptions */}
      <div className="flex flex-wrap items-center gap-4 mt-2 px-2 text-xs text-gray-500">
        <span>↔ x-axis: urgency</span>
        <span>↕ y-axis: importance</span>
        <span>⚪ bubble size: resource need</span>
      </div>

      {/* Overall Score */}
      <div className="mt-4 pt-4 border-t border-gray-200 flex items-center gap-3 text-sm">
        <span className="text-gray-600">Overall:</span>
        <span className="font-semibold text-gray-900">
          Score {overallScore.toFixed(1)}
        </span>
        <span className="text-gray-400">📅</span>
        <span className="text-gray-600">{date}</span>
      </div>

      {/* Interactive Legend */}
      <div className="mt-4 grid grid-cols-3 gap-2">
        {DIMENSION_LEGEND.map((d) => {
          const isActive = highlightedDimension === d.id;
          const isDimmedLegend = highlightedDimension && !isActive;

          return (
            <button
              key={d.id}
              onClick={() => onLegendClick?.(d.id)}
              className={`flex items-center gap-2 p-2 rounded-lg transition-all ${
                isActive
                  ? 'bg-blue-50 ring-2 ring-blue-400'
                  : 'hover:bg-gray-50'
              }`}
              style={{ opacity: isDimmedLegend ? 0.45 : 1 }}
            >
              <div
                className="w-3 h-3 rounded-full flex-shrink-0"
                style={{ backgroundColor: d.color }}
              />
              <span className="text-xs text-gray-600 font-medium">{d.name}</span>
            </button>
          );
        })}
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\charts\DimensionBarChart.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';
import { DimensionResultModel } from '@/lib/scoring/compute';
import { formatScore } from '@/lib/scoring/number';

interface DimensionBarChartProps {
  dimensions: DimensionResultModel[];
}

export function DimensionBarChart({ dimensions }: DimensionBarChartProps) {
  const maxScore = 5;

  const overallCurrent =
    dimensions.length > 0
      ? dimensions.reduce((s, d) => s + d.currentAvg, 0) / dimensions.length
      : 0;
  const overallTarget =
    dimensions.length > 0
      ? dimensions.reduce((s, d) => s + d.targetAvg, 0) / dimensions.length
      : 0;
  const overallGap = overallTarget - overallCurrent;

  const dateNow = new Date().toLocaleDateString('en-US', { month: '2-digit', year: 'numeric' });
  const dateTarget = new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toLocaleDateString(
    'en-US',
    { month: '2-digit', year: 'numeric' }
  );

  return (
    <div className="w-full h-full flex flex-col p-4">
      {/* ── Overall Row: circles only, no bars ── */}
      <div className="mb-4 pb-3 border-b border-gray-200">
        <div className="flex items-center gap-3">
          <div className="w-24 text-right text-xs font-bold text-green-600 uppercase">
            Overall
          </div>

          <div className="flex-1 relative h-10 bg-gray-200 rounded-lg flex items-center gap-6 px-4">
            {/* Current circle + score */}
            <div className="flex items-center gap-2">
              <div
                className="w-4 h-4 rounded-full flex-shrink-0"
                style={{ backgroundColor: '#D87BBC' }}
              />
              <span className="text-sm font-semibold text-gray-900">
                {formatScore(overallCurrent)}
              </span>
            </div>
            {/* Target circle + score */}
            <div className="flex items-center gap-2">
              <div
                className="w-4 h-4 rounded-full flex-shrink-0"
                style={{ backgroundColor: '#3B82F6' }}
              />
              <span className="text-sm font-semibold text-gray-900">
                {formatScore(overallTarget)}
              </span>
            </div>
          </div>

          <GapLabel gap={overallGap} />
        </div>
      </div>

      {/* ── Dimension Rows: two side-by-side bars ── */}
      <div className="flex-1 flex flex-col justify-around space-y-2">
        {dimensions.map((dim, idx) => (
          <DimensionRow
            key={dim.id}
            label={dim.title}
            current={dim.currentAvg}
            target={dim.targetAvg}
            maxScore={maxScore}
            index={idx}
          />
        ))}
      </div>

      {/* X-Axis Scale */}
      <div className="flex mt-3 pt-3 border-t border-gray-100 text-xs text-gray-400">
        <div className="w-24" /> {/* label spacer */}
        <div className="flex-1 flex justify-between px-1 ml-3">
          {[1.0, 2.0, 3.0, 4.0, 5.0].map(v => (
            <span key={v}>{v.toFixed(1)}</span>
          ))}
        </div>
        <div className="w-12" /> {/* gap spacer */}
      </div>

      {/* Legend */}
      <div className="flex justify-center gap-6 mt-3">
        <div className="flex items-center gap-2">
          <div
            className="w-3 h-3 rounded-full"
            style={{ backgroundColor: '#D87BBC' }}
          />
          <span className="text-xs text-gray-500">Current - {dateNow}</span>
        </div>
        <div className="flex items-center gap-2">
          <div
            className="w-3 h-3 rounded-full"
            style={{ backgroundColor: '#3B82F6' }}
          />
          <span className="text-xs text-gray-500">Target - {dateTarget}</span>
        </div>
      </div>
    </div>
  );
}

/* ─────────────────────────────────────────────────── */
/* Dimension Row — TWO separate side-by-side bars      */
/* ─────────────────────────────────────────────────── */

interface DimensionRowProps {
  label: string;
  current: number;
  target: number;
  maxScore: number;
  index: number;
}

function DimensionRow({ label, current, target, maxScore, index }: DimensionRowProps) {
  const currentPct = (current / maxScore) * 100;
  const targetPct = (target / maxScore) * 100;
  const gap = target - current;

  return (
    <motion.div
      className="flex items-center gap-3"
      initial={{ opacity: 0, x: -10 }}
      animate={{ opacity: 1, x: 0 }}
      transition={{ delay: index * 0.08, duration: 0.4 }}
    >
      {/* Label */}
      <div className="w-24 text-right text-xs font-semibold text-gray-600 truncate">
        {label}
      </div>

      {/* Two bars side-by-side */}
      <div className="flex-1 flex items-center gap-1">
        {/* Current bar (pink) */}
        <div className="relative flex-1 h-8">
          <div className="absolute inset-0 bg-gray-100 rounded-lg" />
          <motion.div
            className="absolute inset-y-0 left-0 rounded-lg flex items-center justify-center"
            style={{ backgroundColor: '#D87BBC' }}
            initial={{ width: 0 }}
            animate={{ width: `${currentPct}%` }}
            transition={{ delay: index * 0.08 + 0.1, duration: 0.7, ease: 'easeOut' }}
          >
            <span className="text-xs font-bold text-white drop-shadow-sm whitespace-nowrap">
              {formatScore(current)}
            </span>
          </motion.div>
        </div>

        {/* Target bar (blue) */}
        <div className="relative flex-1 h-8">
          <div className="absolute inset-0 bg-gray-100 rounded-lg" />
          <motion.div
            className="absolute inset-y-0 left-0 rounded-lg flex items-center justify-center"
            style={{ backgroundColor: '#3B82F6' }}
            initial={{ width: 0 }}
            animate={{ width: `${targetPct}%` }}
            transition={{ delay: index * 0.08 + 0.25, duration: 0.7, ease: 'easeOut' }}
          >
            <span className="text-xs font-bold text-white drop-shadow-sm whitespace-nowrap">
              {formatScore(target)}
            </span>
          </motion.div>
        </div>
      </div>

      {/* Gap */}
      <GapLabel gap={gap} />
    </motion.div>
  );
}

/* ─────────────────────────────────────────────────── */
/* Gap Label                                           */
/* ─────────────────────────────────────────────────── */

function GapLabel({ gap }: { gap: number }) {
  const absGap = Math.abs(gap);
  const display =
    gap > 0.05
      ? `−${absGap.toFixed(1)}`
      : gap < -0.05
        ? `+${absGap.toFixed(1)}`
        : '0.0';
  const color =
    gap > 0.05 ? 'text-gray-500' : gap < -0.05 ? 'text-emerald-600' : 'text-gray-400';

  return (
    <div className={`w-12 text-right text-xs font-semibold ${color}`}>
      {display}
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\charts\GapVarianceChart.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';
import { TopGapModel } from '@/lib/scoring/compute';
import { formatGap } from '@/lib/scoring/number';

interface GapVarianceChartProps {
  gaps: TopGapModel[];
}

export function GapVarianceChart({ gaps }: GapVarianceChartProps) {
  const maxGap = Math.max(...gaps.map(g => Math.abs(g.gap)), 1);
  
  return (
    <div className="w-full h-full flex flex-col justify-center p-4">
      <div className="flex-1 flex flex-col justify-around space-y-2">
        {gaps.slice(0, 6).map((gap, idx) => {
          const gapValue = Math.abs(gap.gap);
          const barWidth = (gapValue / maxGap) * 100;
          
          return (
            <motion.div
              key={gap.topicId}
              className="flex items-center gap-3"
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ delay: idx * 0.1, duration: 0.4 }}
            >
              <div className="w-24 text-right truncate">
                <span className="text-xs font-bold uppercase tracking-wider truncate block" style={{ fontFamily: 'Arial, sans-serif', color: '#1A4563' }}>
                  {gap.dimensionTitle.split(' ')[0]}
                </span>
              </div>
              <div className="flex-1 h-8 bg-slate-50 rounded-lg overflow-hidden relative">
                <motion.div
                  className="absolute inset-y-0 left-1/2 -translate-x-1/2 rounded"
                  initial={{ width: 0 }}
                  animate={{ width: `${barWidth}%` }}
                  transition={{ delay: idx * 0.1 + 0.3, duration: 0.5, ease: 'easeOut' }}
                  style={{ backgroundColor: gap.gap > 1.5 ? '#EF4444' : gap.gap > 0.5 ? '#F59E0B' : '#10B981' }}
                />
                <div className="absolute inset-0 flex items-center justify-center">
                  <span className="text-xs font-black uppercase tracking-wider" style={{ fontFamily: 'Arial Black, Arial, sans-serif', color: '#1A4563' }}>
                    -{formatGap(gap.gap)}
                  </span>
                </div>
              </div>
            </motion.div>
          );
        })}
      </div>
      <div className="flex justify-center gap-6 mt-4 pt-4 border-t border-slate-200">
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded" style={{ backgroundColor: '#EF4444' }} />
          <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>Critical {'>'}1.5)</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded" style={{ backgroundColor: '#F59E0B' }} />
          <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>Moderate {'>'}0.5)</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded" style={{ backgroundColor: '#10B981' }} />
          <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>Minor</span>
        </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\charts\MaturityGauge.tsx
----------------------------------------------------------------
'use client';

import { motion } from 'framer-motion';
import { useMemo } from 'react';

interface MaturityGaugeProps {
  score: number;           // Current score (1.0 - 5.0)
  targetScore?: number;    // Target score (1.0 - 5.0)
  date?: string;
  title?: string;
}

export function MaturityGauge({ 
  score, 
  targetScore,
  date = new Date().toLocaleDateString('en-US', { month: '2-digit', year: 'numeric' }),
  title = 'AIRI-HORVÁTH Score'
}: MaturityGaugeProps) {
  
  const maturityLevels = useMemo(() => [
    { value: 5.0, label: 'LEADING', color: '#10b981' },    // emerald
    { value: 4.0, label: 'ADVANCED', color: '#8b5cf6' },   // violet
    { value: 3.0, label: 'READY', color: '#3b82f6' },      // blue
    { value: 2.0, label: 'EXPLORING', color: '#f59e0b' }, // amber
    { value: 1.0, label: 'BEGINNER', color: '#ec4899' },  // pink
  ], []);
  
  // Convert score (1-5) to percentage (0-100%)
  const scorePercent = ((score - 1) / 4) * 100;
  const targetPercent = targetScore ? ((targetScore - 1) / 4) * 100 : null;
  
  // Ensure circle stays within bounds
  const clampedScore = Math.max(1.0, Math.min(5.0, score));
  const clampedPercent = ((clampedScore - 1) / 4) * 100;
  
  return (
    <div className="flex flex-col items-center">
      
      <div className="flex items-center justify-center gap-8">
        
        {/* Left: Scale Labels */}
        <div className="flex flex-col justify-between h-80 text-sm text-gray-500 font-medium py-2">
          {[5.0, 4.0, 3.0, 2.0, 1.0].map(val => (
            <div key={val} className="text-right leading-none">{val.toFixed(1)}</div>
          ))}
        </div>
        
        {/* Center: Gauge Bar */}
        <div className="relative h-80 w-16">
          
          {/* Background Bar (Light Gray) */}
          <div className="absolute inset-0 bg-gray-100 rounded-full" />
          
          {/* Filled Bar (Pink to Purple Gradient) */}
          <motion.div
            className="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-pink-500 via-purple-500 to-violet-500 rounded-full"
            initial={{ height: 0 }}
            animate={{ height: `${scorePercent}%` }}
            transition={{ duration: 1.2, ease: 'easeOut' }}
          />
          
          {/* Target Indicator (Blue Line) */}
          {targetPercent !== null && (
            <motion.div
              className="absolute left-0 right-0 h-0.5 bg-blue-500 z-0"
              style={{ bottom: `${targetPercent}%` }}
              initial={{ opacity: 0, scaleX: 0 }}
              animate={{ opacity: 1, scaleX: 1 }}
              transition={{ duration: 0.6, delay: 1.0 }}
            >
              {/* Optional: Small circles at line ends */}
              <div className="absolute -left-1 -top-1 w-2 h-2 bg-blue-500 rounded-full" />
              <div className="absolute -right-1 -top-1 w-2 h-2 bg-blue-500 rounded-full" />
            </motion.div>
          )}
          
          {/* Score Indicator (White Circle INSIDE bar) */}
          <motion.div
            className="absolute left-1/2 -translate-x-1/2 w-16 h-16 z-10"
            style={{ bottom: `calc(${clampedPercent}% - 2rem)` }}
            initial={{ opacity: 0, scale: 0 }}
            animate={{ opacity: 1, scale: 1 }}
            transition={{ duration: 0.6, delay: 1.2, type: 'spring', bounce: 0.4 }}
          >
            <div className="w-full h-full rounded-full bg-white shadow-lg border-4 border-purple-600 flex items-center justify-center">
              <span className="text-xl font-bold text-purple-700">
                {clampedScore.toFixed(1)}
              </span>
            </div>
          </motion.div>
          
        </div>
        
        {/* Right: Maturity Level Labels */}
        <div className="flex flex-col justify-between h-80 text-sm py-2">
          {maturityLevels.map(level => (
            <div 
              key={level.value}
              className={`font-medium leading-none ${
                score >= level.value 
                  ? 'text-gray-900' 
                  : 'text-gray-400'
              }`}
            >
              {level.label}
            </div>
          ))}
        </div>
        
      </div>
      
      {/* Footer: Date */}
      <div className="flex justify-between items-center mb-2">
        <span className="text-sm font-medium text-gray-500">AIRI-HORVÁTH Score</span>
        <span className="text-2xl font-bold">{score.toFixed(1)}</span>
      </div>
      
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\charts\PriorityMatrix.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';
import { EnhancedRecommendation } from '@/lib/recommendations/definition';

interface PriorityMatrixProps {
  recommendations: EnhancedRecommendation[];
}

export function PriorityMatrix({ recommendations }: PriorityMatrixProps) {
  const sortedRecs = [...recommendations].sort((a, b) => (b.priority || 0) - (a.priority || 0));
  const topRecs = sortedRecs.slice(0, 12);
  
  const getPosition = (priority: number, index: number) => {
    const x = 30 + (index % 4) * 18;
    const y = 30 + Math.floor(index / 4) * 25;
    return { x, y };
  };
  
  return (
    <div className="w-full h-full flex flex-col p-4">
      <div className="flex-1 relative rounded-xl bg-slate-50 overflow-hidden" style={{ border: '1px solid rgba(26, 69, 99, 0.1)' }}>
        {/* Quadrant Labels */}
        <div className="absolute top-2 left-2 text-[8px] font-bold uppercase tracking-widest opacity-50" style={{ fontFamily: 'Arial, sans-serif', color: '#1A4563' }}>High Impact</div>
        <div className="absolute bottom-2 left-2 text-[8px] font-bold uppercase tracking-widest opacity-50" style={{ fontFamily: 'Arial, sans-serif', color: '#1A4563' }}>Low Impact</div>
        <div className="absolute top-2 right-2 text-[8px] font-bold uppercase tracking-widest opacity-50" style={{ fontFamily: 'Arial, sans-serif', color: '#348AC7' }}>Urgent</div>
        <div className="absolute bottom-2 right-2 text-[8px] font-bold uppercase tracking-widest opacity-50" style={{ fontFamily: 'Arial, sans-serif', color: '#348AC7' }}>Non-Urgent</div>
        
        {/* Center lines */}
        <div className="absolute top-1/2 left-0 right-0 h-px" style={{ backgroundColor: 'rgba(26, 69, 99, 0.1)' }} />
        <div className="absolute top-0 bottom-0 left-1/2 w-px" style={{ backgroundColor: 'rgba(26, 69, 99, 0.1)' }} />
        
        {/* Priority Bubbles */}
        {topRecs.map((rec, idx) => {
          const priority = rec.priority || 0;
          const { x, y } = getPosition(priority, idx);
          const size = Math.max(30, Math.min(60, priority * 0.6));
          
          return (
            <motion.div
              key={rec.id}
              className="absolute rounded-full flex items-center justify-center cursor-pointer"
              style={{
                left: `${x}%`,
                top: `${y}%`,
                width: size,
                height: size,
                backgroundColor: '#348AC7',
                opacity: 0.85,
                boxShadow: '0 4px 12px rgba(26, 69, 99, 0.3)',
                transform: 'translate(-50%, -50%)',
              }}
              initial={{ scale: 0, opacity: 0 }}
              animate={{ scale: 1, opacity: 0.85 }}
              transition={{ delay: idx * 0.1, duration: 0.4 }}
              whileHover={{ scale: 1.1, opacity: 1 }}
            >
              <span className="text-xs font-black text-white" style={{ fontFamily: 'Arial Black, Arial, sans-serif' }}>
                {Math.round(priority)}
              </span>
            </motion.div>
          );
        })}
      </div>
      <div className="mt-3 flex flex-wrap gap-2 justify-center">
        {topRecs.slice(0, 4).map((rec, idx) => (
          <div key={rec.id} className="flex items-center gap-2 px-3 py-1 rounded-full bg-white border" style={{ borderColor: 'rgba(26, 69, 99, 0.2)' }}>
            <div className="w-2 h-2 rounded-full" style={{ backgroundColor: '#348AC7' }} />
            <span className="text-[10px] font-bold uppercase truncate max-w-[120px]" style={{ fontFamily: 'Arial, sans-serif', color: '#1A4563' }}>
              {rec.title.substring(0, 20)}...
            </span>
          </div>
        ))}
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\charts\RiskHeatmap.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';
import { DimensionResultModel } from '@/lib/scoring/compute';
import { formatScore, calculateGap } from '@/lib/scoring/number';

interface RiskHeatmapProps {
  dimensions: DimensionResultModel[];
}

export function RiskHeatmap({ dimensions }: RiskHeatmapProps) {
  const getCellColor = (current: number, target: number) => {
    const gap = calculateGap(target, current);
    if (gap > 1.5) return { bg: 'rgba(239, 68, 68, 0.2)', border: '#EF4444' };
    if (gap > 0.5) return { bg: 'rgba(245, 158, 11, 0.2)', border: '#F59E0B' };
    return { bg: 'rgba(16, 185, 129, 0.2)', border: '#10B981' };
  };
  
  const getRiskLevel = (gap: number) => {
    if (gap > 1.5) return 'Critical';
    if (gap > 0.5) return 'Moderate';
    return 'Low';
  };
  
  return (
    <div className="w-full h-full flex flex-col p-4">
      <div className="flex-1 grid grid-cols-2 gap-3">
        {dimensions.map((dim, idx) => {
          const gap = calculateGap(dim.targetAvg, dim.currentAvg);
          const colors = getCellColor(dim.currentAvg, dim.targetAvg);
          
          return (
            <motion.div
              key={dim.id}
              className="relative rounded-xl p-4 flex flex-col justify-between overflow-hidden"
              style={{ 
                backgroundColor: colors.bg,
                borderLeft: `3px solid ${colors.border}`,
              }}
              initial={{ opacity: 0, scale: 0.95 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: idx * 0.1, duration: 0.4 }}
            >
              <div className="relative z-10">
                <span className="text-[9px] font-bold uppercase tracking-widest block mb-1" style={{ fontFamily: 'Arial, sans-serif', color: '#1A4563' }}>
                  {dim.title.substring(0, 18)}
                </span>
                <span className="text-xs font-black" style={{ fontFamily: 'Arial Black, Arial, sans-serif', color: '#1A4563' }}>
                  {formatScore(dim.currentAvg)}
                </span>
              </div>
              <div className="relative z-10 flex items-end justify-between">
                <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>
                  vs {formatScore(dim.targetAvg)}
                </span>
                <span 
                  className="text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded"
                  style={{ 
                    fontFamily: 'Arial, sans-serif', 
                    backgroundColor: colors.border,
                    color: 'white'
                  }}
                >
                  {getRiskLevel(gap)}
                </span>
              </div>
            </motion.div>
          );
        })}
      </div>
      <div className="flex justify-center gap-6 mt-3 pt-3 border-t border-slate-200">
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded" style={{ backgroundColor: 'rgba(239, 68, 68, 0.4)', borderLeft: '2px solid #EF4444' }} />
          <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>Critical Gap</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded" style={{ backgroundColor: 'rgba(245, 158, 11, 0.4)', borderLeft: '2px solid #F59E0B' }} />
          <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>Moderate</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-3 h-3 rounded" style={{ backgroundColor: 'rgba(16, 185, 129, 0.4)', borderLeft: '2px solid #10B981' }} />
          <span className="text-[10px] font-light uppercase tracking-wider" style={{ fontFamily: 'Arial, sans-serif', color: '#64748B' }}>On Track</span>
        </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\DimensionResultCard.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import Link from 'next/link';
import { DimensionResultModel } from '@/lib/scoring/compute';
import { formatScore, formatGap } from '@/lib/scoring/number';
import { CheckCircle2, Circle, ArrowRight } from 'lucide-react';
import { DimensionMaturity } from '@/lib/maturity/model';
import { twMerge } from 'tailwind-merge';

export function DimensionResultCard({ 
  dimension, 
  maturity 
}: { 
  dimension: DimensionResultModel;
  maturity?: DimensionMaturity; 
}) {
  return (
    <div className="bg-white rounded-2xl p-8 border border-slate-100 flex flex-col h-full relative group transition-all duration-300 shadow-sm hover:shadow-md font-sans">
      <div className="flex justify-between items-start mb-8">
         <div className="flex-1 pr-6">
            {maturity && (
               <div className="inline-flex items-center gap-2 rounded-full px-3 py-1 text-[9px] font-black uppercase tracking-widest mb-4 bg-slate-50 border border-slate-100 text-slate-400">
                  {maturity.stage.label}
               </div>
            )}
            <h3 className="text-xl font-black text-horvath-dark group-hover:text-horvath-primary transition-colors leading-tight uppercase tracking-tight">
                {dimension.title}
            </h3>
         </div>
         
         <div className={twMerge(
            "w-10 h-10 rounded-xl flex items-center justify-center border transition-all",
            dimension.isComplete 
               ? "bg-horvath-primary/5 text-horvath-primary border-horvath-primary/20" 
               : "bg-slate-50 text-slate-200 border-slate-100"
         )}>
            {dimension.isComplete ? (
              <CheckCircle2 className="w-5 h-5" />
            ) : (
              <Circle className="w-5 h-5" />
            )}
         </div>
      </div>

      <div className="grid grid-cols-3 gap-4 mb-8 py-4 border-y border-slate-50 font-mono">
         <div className="flex flex-col">
            <span className="text-[8px] text-slate-400 block uppercase font-black tracking-widest mb-1">Actual</span>
            <span className="text-xl font-black text-horvath-dark tracking-tighter leading-none">{formatScore(dimension.currentAvg)}</span>
         </div>
         <div className="flex flex-col border-x border-slate-100 px-4">
            <span className="text-[8px] text-horvath-primary block uppercase font-black tracking-widest mb-1">Target</span>
            <span className="text-xl font-black text-horvath-primary tracking-tighter leading-none">{formatScore(dimension.targetAvg)}</span>
         </div>
         <div className="flex flex-col text-right">
            <span className="text-[8px] text-slate-400 block uppercase font-black tracking-widest mb-1">Gap</span>
            <span className={twMerge(
               "text-xl font-black tracking-tighter leading-none transition-colors",
               dimension.gapAvg > 1.0 ? 'text-red-500' : 'text-slate-300'
            )}>
               {dimension.gapAvg > 0 ? '+' : ''}{formatGap(dimension.gapAvg)}
            </span>
         </div>
      </div>

      <div className="mt-auto flex items-center justify-between">
         <div className="flex flex-col">
            <span className="text-[9px] font-bold text-slate-400 uppercase tracking-widest mb-1">Coverage</span>
            <span className="text-xs font-black text-horvath-dark">
               {dimension.answeredCount} / {dimension.totalCount}
            </span>
         </div>
         
         <Link 
           href={`/survey/${dimension.id}`}
           className="px-6 py-2 bg-horvath-base hover:bg-horvath-dark text-horvath-dark hover:text-white rounded-xl text-[9px] font-black uppercase tracking-widest border border-slate-200 hover:border-horvath-dark transition-all flex items-center gap-2 group/link"
         >
           Configure
           <ArrowRight className="w-3.5 h-3.5 group-hover/link:translate-x-1 transition-transform" />
         </Link>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\ExecutiveSummaryCard.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { NarrativeModel } from '@/lib/narrative/generate';
import { Target, Zap, ShieldAlert } from 'lucide-react';
import { motion } from 'framer-motion';

export function ExecutiveSummaryCard({ model }: { model: NarrativeModel }) {
  return (
    <div className="bg-white rounded-2xl border border-slate-100 shadow-sm overflow-hidden font-sans">
      {/* Header Profile */}
      <div className="p-10 bg-slate-50/50 border-b border-slate-100">
         <div className="flex items-center gap-3 mb-6">
            <div className="w-1.5 h-6 bg-horvath-primary rounded-full" />
            <span className="text-[10px] font-black text-horvath-primary uppercase tracking-[0.3em]">
               Strategic Intelligence Directive
            </span>
         </div>
         
         <h2 className="text-4xl font-black text-horvath-dark tracking-tighter uppercase leading-[0.9] mb-6">
            {model.headline}
         </h2>
         
         <p className="text-lg text-slate-500 font-medium leading-relaxed max-w-4xl">
            {model.executiveSummary}
         </p>
      </div>

      <div className="p-10 grid grid-cols-1 lg:grid-cols-2 gap-12">
         {/* Strategic Priorities */}
         <div className="space-y-6">
            <div className="flex items-center gap-3 border-b border-slate-100 pb-4">
               <Target className="w-4 h-4 text-slate-400" />
               <h3 className="text-xs font-black text-horvath-dark uppercase tracking-widest">Critical Priorities</h3>
            </div>
            <div className="space-y-4">
               {model.priorities.map((p, idx) => (
                  <div key={idx} className="flex gap-4 p-4 rounded-xl bg-slate-50/50 border border-slate-100">
                     <span className="text-sm font-black text-horvath-primary font-mono">{idx + 1}.</span>
                     <div>
                        <h4 className="text-sm font-black text-horvath-dark uppercase mb-1">{p.title}</h4>
                        <p className="text-xs text-slate-500 font-medium leading-relaxed">{p.why}</p>
                     </div>
                  </div>
               ))}
            </div>
         </div>

         {/* Intervention Matrix */}
         <div className="space-y-6">
            <div className="flex items-center gap-3 border-b border-slate-100 pb-4">
               <Zap className="w-4 h-4 text-slate-400" />
               <h3 className="text-xs font-black text-horvath-dark uppercase tracking-widest">Intervention Matrix</h3>
            </div>
            <div className="grid grid-cols-1 gap-3">
               {model.quickWins.map((win, idx) => (
                  <div key={idx} className="flex items-center gap-3 px-4 py-3 rounded-lg bg-white border border-slate-100 text-xs font-bold text-slate-500 uppercase tracking-tight">
                     <div className="w-1.5 h-1.5 bg-horvath-primary rounded-full" />
                     {win}
                  </div>
               ))}
            </div>

            {model.notes.length > 0 && (
               <div className="mt-8 p-6 bg-horvath-dark text-white rounded-xl shadow-md flex gap-4 items-start">
                  <ShieldAlert className="w-5 h-5 text-horvath-primary shrink-0" />
                  <div className="space-y-2">
                     {model.notes.map((note, idx) => (
                        <p key={idx} className="text-[10px] font-black uppercase tracking-widest opacity-80 leading-relaxed">
                           {note}
                        </p>
                     ))}
                  </div>
               </div>
            )}
         </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\MaturityRadar.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';
import { AssessmentDefinition } from '@/lib/assessment/validate';
import { DimensionResultModel } from '@/lib/scoring/compute';
import { formatScore } from '@/lib/scoring/number';

interface MaturityRadarProps {
  definition: AssessmentDefinition;
  dimensions: DimensionResultModel[];
}

export function MaturityRadar({ definition, dimensions }: MaturityRadarProps) {
  const CENTER = 160;
  const RADIUS = 110;
  const GRID_LEVELS = [1, 2, 3, 4, 5];
  
  const currentValues = dimensions.map(d => d.currentAvg || 0);
  const targetValues = dimensions.map(d => d.targetAvg || 0);
  
  const angleStep = (Math.PI * 2) / dimensions.length;
  const angles = dimensions.map((_, i) => i * angleStep - Math.PI / 2);

  const getPoints = (values: number[]) => {
    return values
      .map((val, i) => {
        const r = (RADIUS * val) / 5;
        const x = CENTER + Math.cos(angles[i]) * r;
        const y = CENTER + Math.sin(angles[i]) * r;
        return `${x},${y}`;
      })
      .join(' ');
  };

  const currentPoints = getPoints(currentValues);
  const targetPoints = getPoints(targetValues);

  return (
    <div className="relative w-full aspect-square max-w-[320px] mx-auto font-sans">
      <svg
        viewBox="0 0 320 320"
        className="w-full h-full"
      >
        {/* Concentric Grid Lines (Ultra-thin Slate) */}
        {GRID_LEVELS.map((level) => (
          <circle
            key={level}
            cx={CENTER}
            cy={CENTER}
            r={(RADIUS * level) / 5}
            fill="none"
            stroke="#E2E8F0"
            strokeWidth="0.5"
          />
        ))}

        {/* Radial Axis Lines */}
        {angles.map((angle, i) => (
          <line
            key={i}
            x1={CENTER}
            y1={CENTER}
            x2={CENTER + Math.cos(angle) * RADIUS}
            y2={CENTER + Math.sin(angle) * RADIUS}
            stroke="#E2E8F0"
            strokeWidth="0.5"
          />
        ))}

        {/* Current State Area (Primary Blue Flat) */}
        <motion.polygon
          points={currentPoints}
          fill="#348AC7"
          fillOpacity="0.08"
          stroke="#348AC7"
          strokeWidth="1.5"
          strokeLinejoin="round"
          initial={{ opacity: 0, scale: 0.95 }}
          animate={{ opacity: 1, scale: 1 }}
          transition={{ duration: 0.8 }}
        />

        {/* Target Ambition Line (Slate Grey Dashed) */}
        <motion.polygon
          points={targetPoints}
          fill="none"
          stroke="#94A3B8"
          strokeWidth="1"
          strokeDasharray="2,2"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.3, duration: 0.8 }}
        />

        {/* Data Points (Solid Blue) */}
        {dimensions.map((_, i) => (
          <circle
            key={i}
            cx={CENTER + Math.cos(angles[i]) * ((RADIUS * currentValues[i]) / 5)}
            cy={CENTER + Math.sin(angles[i]) * ((RADIUS * currentValues[i]) / 5)}
            r="3"
            fill="#348AC7"
          />
        ))}

        {/* Labels - Arial hierarchy */}
        {dimensions.map((dim, i) => {
          const x = CENTER + Math.cos(angles[i]) * (RADIUS + 30);
          const y = CENTER + Math.sin(angles[i]) * (RADIUS + 30);
          return (
            <foreignObject
              key={dim.id}
              x={x - 45}
              y={y - 15}
              width="90"
              height="30"
              style={{ overflow: 'visible' }}
            >
              <div className="flex flex-col items-center justify-center h-full text-center">
                <span className="text-[8px] font-black text-slate-400 uppercase tracking-widest leading-none mb-0.5">
                  {dim.title.split(' ')[0]}
                </span>
                <span className="text-[10px] font-black text-horvath-dark font-mono">
                  {formatScore(currentValues[i])}
                </span>
              </div>
            </foreignObject>
          );
        })}
      </svg>
      
      {/* Legend */}
      <div className="flex justify-center gap-6 mt-4">
        <div className="flex items-center gap-2">
          <div className="w-2.5 h-2.5 bg-horvath-primary rounded-sm shadow-sm" />
          <span className="text-[9px] font-bold text-slate-500 uppercase tracking-widest">Active</span>
        </div>
        <div className="flex items-center gap-2">
          <div className="w-2.5 h-2.5 border border-slate-400 border-dashed rounded-sm" />
          <span className="text-[9px] font-bold text-slate-500 uppercase tracking-widest">Target</span>
        </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\OverallSummaryCard.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { OverallScoreSummary } from '@/lib/scoring/compute';
import { formatScore, formatGap } from '@/lib/scoring/number';
import { Shield } from 'lucide-react';
import { motion } from 'framer-motion';

export function OverallSummaryCard({ summary }: { summary: OverallScoreSummary }) {
  const progressPercent = (summary.completedDimensions / summary.totalDimensions) * 100;

  const stats = [
    { label: 'Current Base', value: formatScore(summary.currentAvg), color: 'text-horvath-dark' },
    { label: 'Strategic Target', value: formatScore(summary.targetAvg), color: 'text-horvath-primary' },
    { label: 'Capability Gap', value: formatGap(summary.targetAvg - summary.currentAvg), color: 'text-slate-400' },
  ];

  return (
    <div className="bg-white rounded-2xl p-8 border border-slate-100 shadow-sm font-sans h-full flex flex-col">
      <div className="flex items-center gap-4 mb-8">
         <div className="w-10 h-10 bg-horvath-base rounded-xl flex items-center justify-center border border-slate-100">
            <Shield className="w-5 h-5 text-horvath-dark" />
         </div>
         <div>
            <h3 className="text-sm font-black text-horvath-dark uppercase tracking-tight">Readiness Overview</h3>
            <span className="text-[9px] font-bold text-slate-400 uppercase tracking-widest">Aggregate Intelligence Metrics</span>
         </div>
      </div>

      <div className="grid grid-cols-3 gap-8 mb-auto">
        {stats.map((stat) => (
          <div key={stat.label}>
             <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-2">{stat.label}</span>
             <span className={`text-3xl font-black font-mono tracking-tighter ${stat.color}`}>{stat.value}</span>
          </div>
        ))}
      </div>

      <div className="mt-8 pt-8 border-t border-slate-50">
         <div className="flex justify-between items-end mb-3">
            <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest">Protocol Coverage</span>
            <span className="text-sm font-black text-horvath-dark font-mono">{Math.round(progressPercent)}%</span>
         </div>
         <div className="h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
            <motion.div 
              initial={{ width: 0 }}
              animate={{ width: `${progressPercent}%` }}
              transition={{ duration: 1 }}
              className="h-full bg-horvath-dark rounded-full"
            />
         </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\RecommendationsList.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { ChevronDown } from 'lucide-react';
import { EnhancedRecommendation } from '@/lib/recommendations/definition';

interface RecommendationsListProps {
  recommendations: EnhancedRecommendation[];
  selectedRank?: number | null;
  highlightedDimension?: string | null;
  onRecommendationClick?: (rank: number) => void;
}

export function RecommendationsList({
  recommendations,
  selectedRank = null,
  highlightedDimension = null,
  onRecommendationClick,
}: RecommendationsListProps) {
  const [expandedAll, setExpandedAll] = useState(false);
  const [expandedIds, setExpandedIds] = useState<Set<string>>(new Set());

  // Auto-expand selected recommendation
  useEffect(() => {
    if (selectedRank !== null) {
      const rec = recommendations.find((r) => r.rank === selectedRank);
      if (rec && !expandedIds.has(rec.id)) {
        setExpandedIds((prev) => { const a = Array.from(prev); a.push(rec.id); return new Set(a); });
      }
    }
  }, [selectedRank, recommendations]); // eslint-disable-line react-hooks/exhaustive-deps

  // Auto-expand highlighted dimension recommendations
  useEffect(() => {
    if (highlightedDimension) {
      const dimRecs = recommendations.filter(
        (r) => r.dimension === highlightedDimension
      );
      setExpandedIds((prev) => {
        const next = new Set(prev);
        dimRecs.forEach((r) => next.add(r.id));
        return next;
      });
    }
  }, [highlightedDimension, recommendations]);

  const toggleAll = () => {
    if (expandedAll) {
      setExpandedIds(new Set());
    } else {
      setExpandedIds(new Set(recommendations.map((r) => r.id)));
    }
    setExpandedAll(!expandedAll);
  };

  const toggleItem = (id: string, rank: number) => {
    setExpandedIds((prev) => {
      const next = new Set(prev);
      if (next.has(id)) next.delete(id);
      else next.add(id);
      return next;
    });
    onRecommendationClick?.(rank);
  };

  if (recommendations.length === 0) {
    return (
      <div className="bg-white rounded-xl p-6 border border-gray-200">
        <div className="text-center py-12">
          <p className="text-gray-500">Generating recommendations…</p>
        </div>
      </div>
    );
  }

  return (
    <div className="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
      {/* Header */}
      <div className="flex items-center justify-between mb-4">
        <h3 className="text-lg font-semibold text-gray-900">Recommendations</h3>
        <button
          onClick={toggleAll}
          className="px-4 py-2 text-sm font-medium text-blue-600 border-2 border-blue-600 rounded-full hover:bg-blue-50 transition-colors"
        >
          {expandedAll ? 'Collapse All' : 'Expand All'}
        </button>
      </div>

      {/* Category header */}
      <div className="text-right text-xs text-gray-500 mb-3 pr-10">Category</div>

      {/* List */}
      <div className="space-y-2">
        {recommendations.map((rec) => {
          const isSelected = selectedRank === rec.rank;
          const isDimmed = highlightedDimension
            ? rec.dimension !== highlightedDimension
            : false;

          return (
            <RecommendationItem
              key={rec.id}
              recommendation={rec}
              isExpanded={expandedIds.has(rec.id)}
              isSelected={isSelected}
              isDimmed={isDimmed}
              onToggle={() => toggleItem(rec.id, rec.rank)}
            />
          );
        })}
      </div>
    </div>
  );
}

// ── Single Item ──────────────────────────────────────────────────────────────

interface RecommendationItemProps {
  recommendation: EnhancedRecommendation;
  isExpanded: boolean;
  isSelected: boolean;
  isDimmed: boolean;
  onToggle: () => void;
}

function RecommendationItem({
  recommendation,
  isExpanded,
  isSelected,
  isDimmed,
  onToggle,
}: RecommendationItemProps) {
  const { rank, title, description, category, color } = recommendation;

  return (
    <div
      id={`recommendation-${rank}`}
      className={`border-2 rounded-lg overflow-hidden transition-all duration-200 ${
        isSelected ? 'ring-4 ring-blue-300' : ''
      }`}
      style={{
        borderColor: isExpanded ? color : '#e5e7eb',
        opacity: isDimmed ? 0.45 : 1,
      }}
    >
      {/* Header row */}
      <button
        onClick={onToggle}
        className="w-full px-4 py-3 flex items-center gap-3 hover:bg-gray-50 transition-colors"
      >
        {/* Rank badge */}
        <div
          className="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold text-white transition-transform duration-200"
          style={{
            backgroundColor: color,
            transform: isSelected ? 'scale(1.2)' : 'scale(1)',
          }}
        >
          {rank}
        </div>

        {/* Title */}
        <span className="flex-1 text-left font-medium text-gray-900 text-sm">
          {title}
        </span>

        {/* Category */}
        <span className="flex-shrink-0 text-xs text-gray-600 mr-2">{category}</span>

        {/* Chevron */}
        <ChevronDown
          className={`flex-shrink-0 w-5 h-5 text-gray-400 transition-transform duration-200 ${
            isExpanded ? 'rotate-180' : ''
          }`}
        />
      </button>

      {/* Expanded content */}
      <AnimatePresence>
        {isExpanded && (
          <motion.div
            initial={{ height: 0, opacity: 0 }}
            animate={{ height: 'auto', opacity: 1 }}
            exit={{ height: 0, opacity: 0 }}
            transition={{ duration: 0.25 }}
            className="overflow-hidden"
          >
            <div className="px-4 pb-4 pt-2 bg-gray-50">
              <p className="text-sm text-gray-700 leading-relaxed">
                {description}
              </p>
            </div>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\RecommendationsPageClient.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { useRouter } from 'next/navigation';
import { useReadinessStore } from '@/store/readiness/readiness.store';
import { ResponseAPI } from '@/lib/api/endpoints';
import { ResultsData } from '@/lib/api/types';
import {
  generateRecommendationsFromAPI as generateEnhancedRecommendations,
  generateBubbleData,
} from '@/lib/recommendations/apiEngine';
// import { localSource } from '@/lib/content/localSource'; // Removed localSource usage
import { BubbleChart } from './charts/BubbleChart';
import { RecommendationsList } from './RecommendationsList';
import { Navbar } from '@/components/layout/Navbar';
import { ResetButton } from '@/components/common/ResetButton';

export function RecommendationsPageClient() {
  const router = useRouter();
  const definition = useReadinessStore((state) => state.assessment);
  const responses = useReadinessStore((state) => state.responses);
  const responseId = useReadinessStore((state) => state.responseId);
  const loadAssessment = useReadinessStore((state) => state.loadAssessment);
  
  // NEW: Get definitions from store
  const recommendationsDef = useReadinessStore((state) => state.recommendationsDefinition);
  const loadDefinitions = useReadinessStore((state) => state.loadDefinitions);

  // Interaction state
  const [selectedBubbleRank, setSelectedBubbleRank] = React.useState<number | null>(null);
  const [highlightedDimension, setHighlightedDimension] = React.useState<string | null>(null);
  const [apiResults, setApiResults] = React.useState<ResultsData | null>(null);
  const [loading, setLoading] = React.useState(true);

  React.useEffect(() => {
    if (!definition) loadAssessment();
    if (!recommendationsDef) loadDefinitions();
  }, [definition, recommendationsDef, loadAssessment, loadDefinitions]);

  // Fetch results from API
  React.useEffect(() => {
    async function fetchResults() {
      if (!responseId) {
        setLoading(false);
        return;
      }
      try {
        const data = await ResponseAPI.getResults(responseId);
        setApiResults(data);
      } catch (e) {
        console.error('Failed to fetch results:', e);
      } finally {
        setLoading(false);
      }
    }
    fetchResults();
  }, [responseId]);

  // Generate recommendations using API engine
  const recommendations = React.useMemo(() => {
    if (!apiResults || !recommendationsDef) return [];
    
    try {
      // Use the new API engine helper
      // We need to import generateRecommendationsFromAPI from '@/lib/recommendations/apiEngine'
      // But first let's make sure imports are correct at top of file
      const enhanced = generateEnhancedRecommendations(apiResults, recommendationsDef);
      console.log('✨ Enhanced recommendations generated from API:', enhanced);
      return enhanced;
    } catch (e) {
      console.error('❌ Error generating recommendations:', e);
      return [];
    }
  }, [apiResults, recommendationsDef]);

  // Generate bubble chart data
  const bubbleData = React.useMemo(
    () => generateBubbleData(recommendations),
    [recommendations]
  );

  // Bubble click → select + scroll to recommendation
  const handleBubbleClick = React.useCallback((rank: number) => {
    setSelectedBubbleRank(rank);
    setHighlightedDimension(null);
    const el = document.getElementById(`recommendation-${rank}`);
    if (el) el.scrollIntoView({ behavior: 'smooth', block: 'center' });
  }, []);

  // Legend click → toggle dimension highlight
  const handleLegendClick = React.useCallback((dimensionId: string) => {
    setHighlightedDimension((prev) => (prev === dimensionId ? null : dimensionId));
    setSelectedBubbleRank(null);
  }, []);

  if (loading || !definition) {
    return (
      <div className="min-h-screen bg-[#f5f5f5] flex items-center justify-center">
        <div className="text-center">
          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
          <p className="text-gray-600">Loading recommendations...</p>
        </div>
      </div>
    );
  }

  // No assessment data
  if (Object.keys(responses).length === 0) {
    return (
      <div className="min-h-screen bg-[#f5f5f5] flex items-center justify-center">
        <div className="text-center">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">
            No Assessment Data
          </h2>
          <p className="text-gray-600 mb-6">
            Please complete the survey first.
          </p>
          <button
            onClick={() => router.push('/survey')}
            className="px-6 py-3 bg-blue-600 text-white rounded-full font-medium hover:bg-blue-700 transition-colors"
          >
            Start Survey
          </button>
        </div>
      </div>
    );
  }

  // No recommendations generated
  if (!recommendations || recommendations.length === 0) {
    return (
      <div className="min-h-screen bg-[#f5f5f5] flex items-center justify-center">
        <div className="text-center">
          <h2 className="text-2xl font-bold text-gray-900 mb-2">
            No Recommendations Available
          </h2>
          <p className="text-gray-600 mb-6">
            Unable to generate recommendations. Please ensure you have completed the assessment.
          </p>
          <button
            onClick={() => router.push('/results')}
            className="px-6 py-3 bg-blue-600 text-white rounded-full font-medium hover:bg-blue-700 transition-colors"
          >
            View Results
          </button>
        </div>
      </div>
    );
  }

  return (
    <div className="min-h-screen bg-[#f5f5f5] font-sans">
      <Navbar showBackButton backUrl="/results" />

      <main className="pt-24 pb-12 px-12">
        <div className="mb-8">
          <h1 className="text-2xl font-bold text-gray-900 mb-1">
            Recommendations &amp; Priority Matrix
          </h1>
          <p className="text-gray-500 text-sm">
            Strategic recommendations based on your AI readiness assessment
          </p>
        </div>

        <div className="grid grid-cols-1 lg:grid-cols-5 gap-6 mb-10">
          <div className="lg:col-span-2">
            <BubbleChart
              bubbles={bubbleData}
              overallScore={apiResults?.overallScore || 0}
              selectedRank={selectedBubbleRank}
              highlightedDimension={highlightedDimension}
              onBubbleClick={handleBubbleClick}
              onLegendClick={handleLegendClick}
            />
          </div>

          <div className="lg:col-span-3">
            <RecommendationsList
              recommendations={recommendations}
              selectedRank={selectedBubbleRank}
              highlightedDimension={highlightedDimension}
              onRecommendationClick={setSelectedBubbleRank}
            />
          </div>
        </div>

        <div className="flex items-center justify-between pt-6 border-t border-gray-200">
          <div className="flex items-center gap-4">
            <button
              onClick={() => router.push('/results')}
              className="px-8 py-3 border-2 border-blue-600 text-blue-600 rounded-full font-semibold hover:bg-blue-50 transition-all"
            >
              Previous
            </button>
            <ResetButton />
          </div>

          <button
            onClick={() => alert('Download functionality coming soon!')}
            className="px-8 py-3 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 transition-all shadow-md"
          >
            Download Report
          </button>
        </div>
      </main>

      <div className="fixed bottom-6 left-6 w-12 h-12 bg-black text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg z-50">
        CO
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\components\results\ResultsClient.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { useRouter } from 'next/navigation';
import { useReadinessStore } from '@/store/readiness/readiness.store';
import { ResponseAPI } from '@/lib/api/endpoints';
import { ResultsData } from '@/lib/api/types';
import { MaturityGauge } from './charts/MaturityGauge';
import { DimensionBarChart } from './charts/DimensionBarChart';
import { TopTopicsList } from './TopTopicsList';
import { Navbar } from '@/components/layout/Navbar';
import { ResetButton } from '@/components/common/ResetButton';
import { DimensionResultModel, TopTopic, OverallScoreSummary, TopGapModel } from '@/lib/scoring/compute';
import { ExecutiveSummaryCard } from './ExecutiveSummaryCard';
import { generateNarrative } from '@/lib/narrative/generate';
import { getOrganizationMaturity } from '@/lib/maturity/model';
import { generateRecommendationsFromAPI } from '@/lib/recommendations/apiEngine';

export default function ResultsClient() {
  const router = useRouter();
  const { 
    responseId, 
    assessment, 
    loadAssessment,
    recommendationsDefinition,
    narrativeDefinition,
    loadDefinitions
  } = useReadinessStore();
  
  const [results, setResults] = React.useState<ResultsData | null>(null);
  const [isLoading, setIsLoading] = React.useState(true);
  const [error, setError] = React.useState<string | null>(null);

  React.useEffect(() => {
    // Load definitions if not present
    if (!recommendationsDefinition || !narrativeDefinition) {
        loadDefinitions();
    }
    
    // If no assessment loaded (e.g. direct nav), load it for context/metadata
    if (!assessment) {
      loadAssessment();
    }
  }, [assessment, loadAssessment, recommendationsDefinition, narrativeDefinition, loadDefinitions]);

  React.useEffect(() => {
    if (!responseId) {
      setIsLoading(false);
      return;
    }

    const fetchResults = async () => {
      try {
        const data = await ResponseAPI.getResults(responseId);
        setResults(data);
      } catch (err: any) {
        console.error('Failed to load results:', err);
        setError(err.message || 'Failed to load results');
      } finally {
        setIsLoading(false);
      }
    };

    fetchResults();
  }, [responseId, router]);

  // Map API data to component models
  const dimensionModels: DimensionResultModel[] = React.useMemo(() => {
    if (!results) return [];
    return results.dimensions.map(d => ({
      id: d.dimensionKey,
      title: d.title,
      currentAvg: d.score,
      targetAvg: d.score + d.gap,
      gapAvg: d.gap,
      answeredCount: 0, 
      totalCount: 0,
      progress: 100,
      isComplete: true
    }));
  }, [results]);

  const topTopics: TopTopic[] = React.useMemo(() => {
    if (!results) return [];
    const storeResponses = useReadinessStore.getState().responses;

    return results.topGaps.map(g => {
        const resp = storeResponses[g.topicId];
        const target = resp?.target || 0; 
        const dim = results.dimensions.find(d => d.title === g.dimensionTitle);
        const dimensionId = dim?.dimensionKey || '';

        let riskLevel: 'high' | 'medium' | 'low' = 'low';
        let impactArea = 'Low';
        if (g.gap >= 1.5) {
            riskLevel = 'high';
            impactArea = 'High';
        } else if (g.gap >= 0.5) {
            riskLevel = 'medium';
            impactArea = 'Medium';
        }

        return {
            id: g.topicId,
            label: g.label,
            dimensionName: g.dimensionTitle,
            dimensionId,
            riskLevel,
            target,
            gap: g.gap,
            current: resp?.current || 0,
            priorityScore: g.gap,
            impactArea
        };
    });
  }, [results]);

  // Generate Narrative Model
  const narrative = React.useMemo(() => {
    if (!results || !narrativeDefinition || !recommendationsDefinition) return null;

    try {
        // 1. Construct OrganizationMaturity
        const maturity = getOrganizationMaturity({
            overallCurrentAvg: results.overallScore,
            confidenceRatio: 1 // Assume complete for results view
        });

        // 2. Construct OverallScoreSummary
        const overall: OverallScoreSummary = {
            currentAvg: results.overallScore,
            targetAvg: results.overallScore + results.overallGap,
            gapAvg: results.overallGap,
            completedDimensions: results.dimensions.length,
            totalDimensions: results.dimensions.length,
            confidenceRatio: 1
        };

        // 3. Construct TopGapModel[]
        const topGapsModels: TopGapModel[] = results.topGaps.map(g => {
            const dim = results.dimensions.find(d => d.title === g.dimensionTitle);
            return {
                topicId: g.topicId,
                topicLabel: g.label,
                gap: g.gap,
                dimensionId: dim?.dimensionKey || '',
                dimensionTitle: g.dimensionTitle,
                current: 0, 
                target: 0
            };
        });

        // 4. Generate Recommendations (needed for logic)
        const recommendations = generateRecommendationsFromAPI(results, recommendationsDefinition);

        // 5. Generate Narrative
        return generateNarrative({
            maturity,
            overall,
            topGaps: topGapsModels,
            recommendations,
            definition: narrativeDefinition
        });
    } catch (e) {
        console.error("Error generating narrative:", e);
        return null;
    }
  }, [results, narrativeDefinition, recommendationsDefinition]);

  if (isLoading) {
    return (
      <div className="min-h-screen bg-[#f5f5f5] font-sans flex items-center justify-center">
        <div className="text-blue-600 font-medium">Loading results...</div>
      </div>
    );
  }

  if (error || !results) {
    return (
      <div className="min-h-screen bg-[#f5f5f5] font-sans flex items-center justify-center">
         <div className="text-center">
            <div className="text-red-500 font-medium mb-4">{error || 'No results found'}</div>
            <button onClick={() => router.push('/')} className="text-blue-600 underline">Return Home</button>
         </div>
      </div>
    );
  }

  const overallTargetScore = results.overallScore + results.overallGap;

  return (
    <div className="min-h-screen bg-[#f5f5f5] font-sans">
      <Navbar />

      <main className="pt-24 pb-12 px-12">
        <div className="grid grid-cols-12 gap-6 mb-8">
          {/* AIRI Score Card */}
          <div className="col-span-3 bg-white rounded-2xl shadow-sm p-6 border border-gray-100">
            <h3 className="text-sm font-medium text-gray-700 mb-6">AIRI-HORVÁTH Score</h3>
            <MaturityGauge 
              score={results.overallScore} 
              targetScore={overallTargetScore}
              title="AIRI Score" 
            />
          </div>

          {/* AI Readiness Chart Card */}
          <div className="col-span-5 bg-white rounded-2xl shadow-sm p-6 border border-gray-100">
            <div className="flex items-center justify-between mb-2">
              <h3 className="text-sm font-medium text-gray-700">AI Readiness by HORVÁTH</h3>
              <button className="p-1 hover:bg-gray-100 rounded">
                <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 6h16M4 12h16M4 18h16" />
                </svg>
              </button>
            </div>
            <DimensionBarChart dimensions={dimensionModels} />
          </div>

          {/* Top Topics Card */}
          <div className="col-span-4 bg-white rounded-2xl shadow-sm p-6 border border-gray-100">
            <div className="flex items-center justify-between mb-4">
              <h3 className="text-sm font-medium text-gray-700">Top Topics</h3>
              <span className="text-xs font-medium text-gray-500">Score</span>
            </div>
            <div className="max-h-[360px] overflow-y-auto">
              <TopTopicsList topics={topTopics} />
            </div>
          </div>
        </div>

        {/* Narrative Section - Now Dynamic */}
        {narrative ? (
            <div className="mb-8">
                <ExecutiveSummaryCard model={narrative} />
            </div>
        ) : (
             <div className="bg-white rounded-2xl shadow-sm p-8 border border-gray-100 mb-8">
               <p className="text-base text-gray-700 leading-relaxed">
                 Based on your responses, your organization has an overall AI Readiness score of <strong>{results.overallScore.toFixed(1)}</strong> out of 5.0. 
                 The gap between your current state and target state is <strong>{results.overallGap.toFixed(1)}</strong>. 
                 Review the breakdown above to identify key areas for improvement.
               </p>
             </div>
        )}

        {/* Bottom Buttons */}
        <div className="flex items-center justify-between">
          <div className="flex items-center gap-4">
            <button
              onClick={() => router.push('/survey')}
              className="px-8 py-3 border-2 border-blue-600 text-blue-600 rounded-full font-semibold hover:bg-blue-50 transition-all"
            >
              Previous
            </button>
            <ResetButton />
          </div>

          <button
            onClick={() => router.push('/results/recommendations')}
            className="px-8 py-3 bg-blue-600 text-white rounded-full font-semibold hover:bg-blue-700 transition-all shadow-md"
          >
            See Recommendations
          </button>
        </div>
      </main>

      <div className="fixed bottom-6 left-6 w-12 h-12 bg-black text-white rounded-full flex items-center justify-center font-bold text-sm shadow-lg z-50">
        CO
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\components\results\TopGapsList.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { TopGapModel } from '@/lib/scoring/compute';
import { formatGap } from '@/lib/scoring/number';
import { AlertCircle, ArrowUpRight } from 'lucide-react';

interface TopGapsListProps {
  gaps: TopGapModel[];
}

export function TopGapsList({ gaps }: TopGapsListProps) {
  return (
    <div className="space-y-3">
      {gaps.map((gap) => (
        <div 
          key={gap.topicId}
          className="group flex items-center justify-between p-4 rounded-xl border border-slate-100 hover:bg-slate-50 transition-all"
        >
          <div className="flex items-center gap-4">
             <div className="p-2 bg-red-50 rounded-lg">
                <AlertCircle className="w-4 h-4 text-red-500" />
             </div>
             <div>
                <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest block mb-0.5">
                   {gap.dimensionTitle}
                </span>
                <h4 className="text-sm font-black text-horvath-dark uppercase tracking-tight">{gap.topicLabel}</h4>
             </div>
          </div>
          
          <div className="flex items-center gap-6">
             <div className="text-right">
                <span className="text-[9px] font-bold text-slate-400 uppercase block">Delta</span>
                <span className="text-lg font-black text-red-500 font-mono">-{formatGap(gap.gap)}</span>
             </div>
             <div className="w-8 h-8 rounded-full border border-slate-200 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                <ArrowUpRight className="w-4 h-4 text-slate-400" />
             </div>
          </div>
        </div>
      ))}
    </div>
  );
}


----------------------------------------------------------------
File: src\components\results\TopTopicsList.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { TopTopic } from '@/lib/scoring/compute';
import { formatScore } from '@/lib/scoring/number';

interface TopTopicsListProps {
  topics: TopTopic[];
  maxItems?: number;
}

/**
 * Displays the top-N topics ranked by priority score.
 * Shows rank badge, topic label, risk level, and target score.
 */
export function TopTopicsList({ topics, maxItems = 10 }: TopTopicsListProps) {
  const display = topics.slice(0, maxItems);

  return (
    <div className="space-y-0">
      {display.map((topic, idx) => (
        <TopicRow key={topic.id} topic={topic} rank={idx + 1} />
      ))}

      {display.length === 0 && (
        <div className="py-8 text-center text-sm text-gray-400">
          Complete the survey to see top topics.
        </div>
      )}
    </div>
  );
}

function TopicRow({ topic, rank }: { topic: TopTopic; rank: number }) {
  const riskColors: Record<string, string> = {
    high: 'text-rose-600 bg-rose-50',
    medium: 'text-amber-600 bg-amber-50',
    low: 'text-emerald-600 bg-emerald-50',
  };

  return (
    <div className="flex items-center gap-3 py-2.5 border-b border-gray-100 last:border-0">
      {/* Rank badge */}
      <div
        className={`flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center text-[10px] font-bold ${
          rank <= 3
            ? 'bg-gradient-to-br from-amber-400 to-amber-500 text-white'
            : 'bg-gray-100 text-gray-500'
        }`}
      >
        {rank}
      </div>

      {/* Topic info */}
      <div className="flex-1 min-w-0">
        <div className="text-sm text-gray-700 truncate">{topic.label}</div>
        <div className="flex items-center gap-2 mt-0.5">
          <span className="text-[10px] text-gray-400">{topic.dimensionName}</span>
          <span
            className={`text-[9px] font-semibold uppercase px-1.5 py-0.5 rounded-full ${riskColors[topic.riskLevel]}`}
          >
            {topic.riskLevel}
          </span>
        </div>
      </div>

      {/* Score */}
      <div className="flex-shrink-0 text-sm font-semibold text-blue-600">
        {formatScore(topic.target)}
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\survey\AssessmentGateDialog.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { useRouter } from 'next/navigation';
import { MissingItem } from '@/lib/assessment/progress';

interface AssessmentGateDialogProps {
  open: boolean;
  onClose: () => void;
  missing: MissingItem[];
}

export function AssessmentGateDialog({ open, onClose, missing }: AssessmentGateDialogProps) {
  const router = useRouter();

  if (!open) return null;

  const isComplete = missing.length === 0;

  return (
    <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
      <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 animate-in fade-in zoom-in duration-200">
        
        {isComplete ? (
          <>
            {/* Success Icon */}
            <div className="w-16 h-16 bg-gradient-to-br from-[#00549F] to-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
              <svg className="w-8 h-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
              </svg>
            </div>

            <h2 className="text-2xl font-bold text-gray-900 text-center mb-3">
              Assessment Complete!
            </h2>
            <p className="text-gray-600 text-center mb-8 leading-relaxed">
              You've successfully completed all assessment questions. 
              Would you like to view your results now?
            </p>

            <div className="flex flex-col gap-3">
              <button
                onClick={() => router.push('/results')}
                className="w-full px-6 py-4 bg-gradient-to-r from-[#00549F] to-blue-700 text-white font-semibold rounded-xl hover:from-[#004080] hover:to-blue-800 transition-all shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
              >
                View Results
              </button>
              <button
                onClick={onClose}
                className="w-full px-6 py-4 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-all"
              >
                Review My Answers
              </button>
            </div>
          </>
        ) : (
          <>
            {/* Incomplete Icon */}
            <div className="w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-6">
              <span className="text-2xl">⚠️</span>
            </div>

            <h2 className="text-2xl font-bold text-gray-900 text-center mb-2">
              Almost there!
            </h2>
            <p className="text-gray-600 text-center mb-6">
              You have {missing.length} unanswered question{missing.length === 1 ? '' : 's'}. 
              Please complete them to view your results.
            </p>

            {/* Missing Items List (Limited) */}
            <div className="bg-gray-50 rounded-xl p-4 mb-6 max-h-[200px] overflow-y-auto border border-gray-100">
              <div className="space-y-2">
                {missing.slice(0, 6).map((item) => (
                  <div key={`${item.dimensionId}-${item.topicId}`} className="text-sm text-gray-700 flex items-start gap-2">
                    <span className="text-amber-500 mt-0.5">•</span>
                    <span>
                      <span className="font-medium">{item.dimensionTitle}:</span> {item.topicLabel}
                    </span>
                  </div>
                ))}
                {missing.length > 6 && (
                  <div className="text-xs text-gray-400 italic text-center pt-2">
                    ...and {missing.length - 6} more
                  </div>
                )}
              </div>
            </div>

            <div className="flex flex-col gap-3">
              <button
                onClick={() => {
                  const first = missing[0];
                  router.push(`/survey/${first.dimensionId}?topic=${first.topicId}`);
                  onClose();
                }}
                className="w-full px-6 py-4 bg-amber-600 text-white font-semibold rounded-xl hover:bg-amber-700 transition-all shadow-md"
              >
                Go to first unanswered
              </button>
              <button
                onClick={onClose}
                className="w-full px-6 py-4 bg-gray-100 text-gray-700 font-semibold rounded-xl hover:bg-gray-200 transition-all"
              >
                Review My Answers
              </button>
            </div>
          </>
        )}
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\survey\DimensionContent.tsx
----------------------------------------------------------------
// src/components/survey/DimensionContent.tsx

'use client';

import * as React from 'react';
import { useRouter, useSearchParams } from 'next/navigation';
import { TopicCard } from '@/components/survey/TopicCard';
import { useReadinessStore } from '@/store/readiness/readiness.store';
import { AssessmentGateDialog } from '@/components/survey/AssessmentGateDialog';
// Removed static definition imports

// Helper to find missing items from store
const getMissingItemsFromStore = (assessment: any, responses: any) => {
    const missing: any[] = [];
    if (!assessment) return missing;

    assessment.dimensions.forEach((dim: any) => {
        dim.topics.forEach((topic: any) => {
            // Fix: Access topic.id instead of topic.topicId which was undefined
            // Also check topic.topicKey if id is not what we index by
            // Store responses are indexed by ID usually? 
            // `readiness.store.ts` submitAnswer takes `topicId`.
            // Let's assume `responses` key is `topic.id`.
            if (!responses[topic.id]) {
                missing.push({
                    dimensionId: dim.dimensionKey,
                    dimensionTitle: dim.title,
                    topicId: topic.id, // Fixed: topic.id
                    topicLabel: topic.label
                });
            }
        });
    });
    return missing;
};

export function DimensionContent({ dimensionId }: { dimensionId: string }) {
  const router = useRouter();
  const searchParams = useSearchParams();
  const topicKeyParam = searchParams.get('topic');
  const [showCompletionDialog, setShowCompletionDialog] = React.useState(false);
  const [missingItems, setMissingItems] = React.useState<any[]>([]);
  
  const { assessment, responses, completeAssessment, isLoading, isSubmitting } = useReadinessStore();

  // Find current dimension and topic from store data
  const dimension = assessment?.dimensions.find(d => d.dimensionKey === dimensionId);
  
  // If data not loaded yet or invalid dimension, might want to show loading or redirect
  // But parent page fallback should handle major loading.
  
  if (!assessment || !dimension) {
      return <div className="p-12 text-center text-gray-500">Loading dimension...</div>;
  }

  const currentTopicIndex = dimension.topics.findIndex((t) => t.topicKey === topicKeyParam);
  const topicIndex = currentTopicIndex >= 0 ? currentTopicIndex : 0;
  const currentTopic = dimension.topics[topicIndex];
  
  // Navigation Logic
  const allDimensions = assessment.dimensions;
  const currentDimIndex = allDimensions.findIndex((d) => d.dimensionKey === dimensionId);

  const hasPrevious = topicIndex > 0 || currentDimIndex > 0;
  const isLastTopic = topicIndex === dimension.topics.length - 1 && currentDimIndex === allDimensions.length - 1;

  const handleNext = async () => {
    if (isLastTopic) {
      const missing = getMissingItemsFromStore(assessment, responses);
      
      if (missing.length > 0) {
          setMissingItems(missing);
          setShowCompletionDialog(true);
      } else {
          // Complete assessment
          try {
             await completeAssessment();
             router.push('/results');
          } catch (e) {
             console.error('Completion failed', e);
             // Show error toast/alert
          }
      }
      return;
    }

    if (topicIndex < dimension.topics.length - 1) {
      // Next topic in same dimension
      const targetTopic = dimension.topics[topicIndex + 1];
      router.push(`/survey/${dimension.dimensionKey}?topic=${targetTopic.topicKey}`);
    } else if (currentDimIndex < allDimensions.length - 1) {
      // Next dimension
      const nextDim = allDimensions[currentDimIndex + 1];
      const nextTopic = nextDim.topics[0];
      router.push(`/survey/${nextDim.dimensionKey}?topic=${nextTopic.topicKey}`);
    }
  };

  const handlePrevious = () => {
    if (topicIndex > 0) {
      const targetTopic = dimension.topics[topicIndex - 1];
      router.push(`/survey/${dimension.dimensionKey}?topic=${targetTopic.topicKey}`);
    } else if (currentDimIndex > 0) {
      const prevDim = allDimensions[currentDimIndex - 1];
      const prevTopic = prevDim.topics[prevDim.topics.length - 1];
      router.push(`/survey/${prevDim.dimensionKey}?topic=${prevTopic.topicKey}`);
    }
  };

  return (
    <div className="fixed top-[6rem] left-[344px] right-[24px] bottom-[24px] flex flex-col z-10">
      
           {/* Saving Indicator */}
           {isSubmitting && (
            <div className="absolute top-4 right-4 bg-blue-600 text-white text-xs px-3 py-1 rounded-full shadow-lg z-20 animate-pulse">
              Saving...
            </div>
          )}

      {/* Main Card */}
      <div className="bg-white flex-1 flex flex-col rounded-[32px] 
                    shadow-[0_20px_50px_rgba(0,0,0,0.05),0_1px_4px_rgba(0,0,0,0.02)] 
                    border border-gray-100/50 overflow-hidden relative">
        
        {/* Body */}
        <div className="flex-1 flex flex-col overflow-hidden">
          {currentTopic && (
            <TopicCard
              dimensionId={dimension.dimensionKey}
              topic={currentTopic}
            />
          )}
        </div>

        {/* Footer */}
        <div className="px-12 py-8 bg-white/80 backdrop-blur-md border-t border-gray-50 flex justify-between items-center shrink-0">
          <button
            onClick={handlePrevious}
            disabled={!hasPrevious}
            className={`px-8 py-3.5 rounded-full text-sm font-bold transition-all flex items-center gap-3 border ${
              hasPrevious ? 'border-gray-100 text-gray-400 hover:text-gray-900 hover:bg-gray-50' : 'opacity-0 pointer-events-none'
            }`}
          >
            <span className="text-xl">←</span> Previous
          </button>

          <button
            onClick={handleNext}
            disabled={isLoading}
            className={`px-12 py-3.5 rounded-full text-sm font-black text-white hover:shadow-xl hover:shadow-blue-500/20 transition-all active:scale-95 flex items-center gap-3 disabled:opacity-70 ${
                isLastTopic ? 'bg-green-600 hover:bg-green-700' : 'bg-[#00549F] hover:bg-[#004080]'
            }`}
          >
            {isLoading ? 'Processing...' : (isLastTopic ? 'Complete & View Results' : 'Next Step')} <span className="text-xl">→</span>
          </button>
        </div>
      </div>

      {/* Completion Dialog */}
      <AssessmentGateDialog 
        open={showCompletionDialog} 
        onClose={() => setShowCompletionDialog(false)} 
        missing={missingItems} 
      />
    </div>
  );
}

----------------------------------------------------------------
File: src\components\survey\DimensionSummaryBar.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';
import { ShieldCheck } from 'lucide-react';

interface DimensionSummaryBarProps {
  dimensionTitle: string;
  answeredCount: number;
  totalCount: number;
}

export function DimensionSummaryBar({
  dimensionTitle,
  answeredCount,
  totalCount,
}: DimensionSummaryBarProps) {
  const percent = totalCount > 0 ? (answeredCount / totalCount) * 100 : 0;

  return (
    <div className="bg-white border-b border-slate-100 sticky top-0 z-50">
      <div className="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
        <div className="flex items-center gap-4">
           <div className="w-10 h-10 bg-horvath-base rounded-xl flex items-center justify-center border border-slate-100">
              <ShieldCheck className="w-5 h-5 text-horvath-dark" />
           </div>
           <div>
              <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest leading-none block mb-1">Strategic Stream</span>
              <h2 className="text-lg font-black text-horvath-dark uppercase tracking-tight">{dimensionTitle}</h2>
           </div>
        </div>

        <div className="flex items-center gap-8">
           <div className="flex flex-col items-end">
              <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1.5">Progress Intensity</span>
              <div className="flex items-center gap-4">
                 <div className="w-48 h-1.5 bg-slate-100 rounded-full overflow-hidden">
                    <motion.div 
                      initial={{ width: 0 }}
                      animate={{ width: `${percent}%` }}
                      transition={{ duration: 1, ease: "easeOut" }}
                      className="h-full bg-horvath-dark rounded-full"
                    />
                 </div>
                 <div className="text-sm font-black text-horvath-dark font-mono">
                   {Math.round(percent)}%
                 </div>
              </div>
           </div>

           <div className="h-8 w-px bg-slate-100" />

           <div className="flex flex-col items-end">
              <span className="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Integrity Check</span>
              <div className="text-sm font-black text-horvath-dark font-mono">
                {answeredCount} / {totalCount}
              </div>
           </div>
        </div>
      </div>
    </div>
  );
}


----------------------------------------------------------------
File: src\components\survey\TopicCard.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { TopicStructure } from '@/lib/api/types';
import { DualSlider } from '@/components/ui/sliders/DualSlider';
import { useReadinessStore } from '@/store/readiness/readiness.store';

export function TopicCard({ dimensionId, topic }: { dimensionId: string; topic: TopicStructure }) {
  // Use flat responses structure from new store
  const response = useReadinessStore((state) => state.responses[topic.id]);
  const { submitAnswer, setResponse, isSubmitting } = useReadinessStore();
  
  const currentVal = response?.current ?? 1.0;
  const targetVal = response?.target ?? 1.0;

  // Parse prompt into 5 level descriptions
  // API returns: "Level 1: ... | Level 2: ... | Level 3: ... | Level 4: ... | Level 5: ..."
  // Or could be separated by newlines or other delimiters
  const parseLevelDescriptions = React.useMemo(() => {
    if (!topic.prompt) return [];
    
    // Try pipe separator first
    if (topic.prompt.includes('|')) {
      return topic.prompt.split('|').map(s => {
        // Remove "Level X:" prefix if present
        return s.replace(/^Level\s+\d+:\s*/i, '').trim();
      }).filter(s => s.length > 0);
    }
    
    // Try newline separator
    if (topic.prompt.includes('\n')) {
      const lines = topic.prompt.split('\n').filter(line => {
        const trimmed = line.trim();
        return trimmed.length > 0 && /^Level\s+\d+/i.test(trimmed);
      });
      return lines.map(line => {
        return line.replace(/^Level\s+\d+:\s*/i, '').trim();
      }).slice(0, 5);
    }
    
    // If no clear separator, return empty array (will use default display)
    return [];
  }, [topic.prompt]);

  // Refs for debouncing - survives HMR
  const saveTimeoutRef = React.useRef<NodeJS.Timeout | null>(null);

  const debouncedSave = React.useCallback((tId: string, current: number, target: number) => {
      if (saveTimeoutRef.current) {
          clearTimeout(saveTimeoutRef.current);
      }
      
      saveTimeoutRef.current = setTimeout(() => {
          submitAnswer(tId, current, target);
      }, 1000); // 1 second debounce
  }, [submitAnswer]);

  const handleScoreChange = (field: 'current' | 'target', value: number) => {
    // Value is already snapped to valid score (1.0, 1.5, 2.0, etc.) by DualSlider
    // No need to round here - DualSlider handles snapping
    
    // Determine the new state
    const newCurrent = field === 'current' ? value : currentVal;
    const newTarget = field === 'target' ? value : targetVal;
    
    // 1. Immediate local update (optimistic)
    setResponse(topic.id, newCurrent, newTarget);
    
    // 2. Debounced API save
    debouncedSave(topic.id, newCurrent, newTarget);
  };

  return (
    <div className="flex flex-col h-full overflow-hidden font-sans relative">
       {/* Save indicator - subtle */}
       {isSubmitting && (
        <div className="absolute top-2 right-2 text-xs text-blue-500 font-medium animate-pulse">
            Saving...
        </div>
      )}

      {/* Header - Smaller and more compact */}
      <div className="px-12 py-6 bg-white border-b border-gray-100 shrink-0">
        {/* Title - Smaller */}
        <h2 className="text-4xl font-black text-gray-900 tracking-tight mb-3">
          {topic.label}
        </h2>
        
        {/* Prompt/Question - Smaller */}
        <p className="text-base font-normal text-gray-600 leading-relaxed">
          {topic.prompt}
        </p>
      </div>

      {/* Body - Centered content without scroll */}
      <div className="px-12 py-8 bg-[#f9fafb] flex-1 flex flex-col justify-center">
        {/* Slider Section - Centered */}
        <div className="w-[90%] mx-auto">
          <DualSlider
            current={currentVal}
            target={targetVal}
            onCurrentChange={(val) => handleScoreChange('current', val)}
            onTargetChange={(val) => handleScoreChange('target', val)}
            topicId={topic.id}
            min={1.0}
            max={5.0}
            step={0.5}
            labels={parseLevelDescriptions}
          />
        </div>
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\components\ui\sliders\DualSlider.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';

interface DualSliderProps {
  current: number;
  target: number;
  onCurrentChange: (val: number) => void;
  onTargetChange: (val: number) => void;
  min?: number;
  max?: number;
  step?: number;
  topicId: string;
  labels?: string[]; // 5 level descriptions from API
}

// Valid scores for 9-level slider
const VALID_SCORES = [1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0];

// Helper to snap to nearest valid score
function snapToValidScore(value: number): number {
  return VALID_SCORES.reduce((prev, curr) => 
    Math.abs(curr - value) < Math.abs(prev - value) ? curr : prev
  );
}

export function DualSlider({
  current,
  target,
  onCurrentChange,
  onTargetChange,
  min = 1.0,
  max = 5.0,
  step = 0.5, // CRITICAL: Must be 0.5 for 9 levels
  topicId,
  labels = [],
}: DualSliderProps) {
  
  const getPercentage = (val: number) => {
    const percentage = ((val - min) / (max - min)) * 100;
    return Math.max(0, Math.min(100, percentage));
  };

  // Handle change with snapping
  const handleCurrentChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const rawValue = parseFloat(e.target.value);
    const snappedValue = snapToValidScore(rawValue);
    onCurrentChange(snappedValue);
  };

  const handleTargetChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const rawValue = parseFloat(e.target.value);
    const snappedValue = snapToValidScore(rawValue);
    onTargetChange(snappedValue);
  };

  // Map value to label index (0-4 for 5 labels)
  const getLabelIndex = (value: number): number => {
    if (value <= 1.5) return 0;
    if (value <= 2.5) return 1;
    if (value <= 3.5) return 2;
    if (value <= 4.5) return 3;
    return 4;
  };

  const currentLabelIndex = getLabelIndex(current);
  const targetLabelIndex = getLabelIndex(target);
  const currentLabel = labels[currentLabelIndex] || '';
  const targetLabel = labels[targetLabelIndex] || '';

  // Scale markers for 9 levels
  const scaleMarkers = VALID_SCORES.filter(score => score % 1 === 0); // [1.0, 2.0, 3.0, 4.0, 5.0]

  return (
    <div className="w-full select-none font-sans py-4">
      <div className="flex flex-col gap-2">
        
        {/* Level Descriptions - Top (if labels provided) */}
        {labels.length > 0 && (
          <div className="flex items-center gap-4 mb-2">
            <div className="w-20 shrink-0"></div>
            <div className="flex-1 grid grid-cols-5 gap-2 px-1">
              {labels.map((label, idx) => (
                <div key={idx} className="text-center">
                  <p className="text-xs font-normal text-gray-600 leading-snug break-words">
                    {label}
                  </p>
                </div>
              ))}
            </div>
          </div>
        )}

        {/* Vertical Scale Lines - Top */}
        <div className="flex items-center gap-4">
          <div className="w-20 shrink-0"></div>
          <div className="flex-1 relative px-1">
            {/* All 9 tick marks */}
            {VALID_SCORES.map((score) => (
              <div
                key={score}
                className={`absolute w-[2px] h-3 ${
                  score % 1 === 0 ? 'bg-gray-400' : 'bg-gray-200'
                }`}
                style={{ 
                  left: `${((score - min) / (max - min)) * 100}%`,
                  transform: 'translateX(-50%)',
                }}
              />
            ))}
          </div>
        </div>

        {/* --- SCORE ROW --- */}
        <div className="flex items-center gap-4">
          <div className="w-20 text-right shrink-0">
            <span className="text-base font-bold text-[#c2185b] uppercase tracking-wide">
              SCORE
            </span>
          </div>
          
          <div className="flex-1 relative h-2">
            {/* Background track */}
            <div className="absolute inset-0 bg-gray-300 rounded-full" />
            
            {/* Progress fill */}
            <div 
              className="absolute top-0 left-0 h-full bg-gradient-to-r from-[#ec407a] to-[#c2185b] rounded-full transition-all duration-500"
              style={{ width: `${getPercentage(current)}%` }}
            />
            
            {/* Value circle */}
            <div 
              className="absolute top-1/2 -translate-y-1/2 w-8 h-8 bg-[#c2185b] rounded-full flex items-center justify-center shadow-lg border-3 border-white transition-all duration-500"
              style={{ left: `calc(${getPercentage(current)}% - 16px)` }}
            >
              <span className="text-sm font-bold text-white tabular-nums">
                {current.toFixed(1)}
              </span>
            </div>
            
            {/* Invisible input */}
            <input 
              type="range" 
              min={min} 
              max={max} 
              step={step} 
              value={current} 
              onChange={handleCurrentChange} 
              className="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-30" 
            />
          </div>
        </div>

        {/* Current Label Display */}
        {currentLabel && (
          <div className="flex items-center gap-4">
            <div className="w-20 shrink-0"></div>
            <div className="flex-1 px-1">
              <p className="text-xs text-gray-500 text-center italic">
                {currentLabel}
              </p>
            </div>
          </div>
        )}

        {/* Vertical Scale Lines - Middle */}
        <div className="flex items-center gap-4">
          <div className="w-20 shrink-0"></div>
          <div className="flex-1 relative px-1">
            {VALID_SCORES.map((score) => (
              <div
                key={score}
                className={`absolute w-[2px] h-3 ${
                  score % 1 === 0 ? 'bg-gray-400' : 'bg-gray-200'
                }`}
                style={{ 
                  left: `${((score - min) / (max - min)) * 100}%`,
                  transform: 'translateX(-50%)',
                }}
              />
            ))}
          </div>
        </div>

        {/* --- TARGET ROW --- */}
        <div className="flex items-center gap-4">
          <div className="w-20 text-right shrink-0">
            <span className="text-base font-bold text-[#1976d2] uppercase tracking-wide">
              TARGET
            </span>
          </div>
          
          <div className="flex-1 relative h-2">
            {/* Background track */}
            <div className="absolute inset-0 bg-gray-300 rounded-full" />
            
            {/* Progress fill */}
            <div 
              className="absolute top-0 left-0 h-full bg-gradient-to-r from-[#42a5f5] to-[#1976d2] rounded-full transition-all duration-500"
              style={{ width: `${getPercentage(target)}%` }}
            />
            
            {/* Value circle */}
            <div 
              className="absolute top-1/2 -translate-y-1/2 w-8 h-8 bg-[#1976d2] rounded-full flex items-center justify-center shadow-lg border-3 border-white transition-all duration-500"
              style={{ left: `calc(${getPercentage(target)}% - 16px)` }}
            >
              <span className="text-sm font-bold text-white tabular-nums">
                {target.toFixed(1)}
              </span>
            </div>
            
            {/* Invisible input */}
            <input 
              type="range" 
              min={min} 
              max={max} 
              step={step} 
              value={target} 
              onChange={handleTargetChange} 
              className="absolute inset-0 w-full h-full opacity-0 cursor-pointer z-30" 
            />
          </div>
        </div>

        {/* Target Label Display */}
        {targetLabel && (
          <div className="flex items-center gap-4">
            <div className="w-20 shrink-0"></div>
            <div className="flex-1 px-1">
              <p className="text-xs text-gray-500 text-center italic">
                {targetLabel}
              </p>
            </div>
          </div>
        )}

        {/* Vertical Scale Lines - Bottom */}
        <div className="flex items-center gap-4">
          <div className="w-20 shrink-0"></div>
          <div className="flex-1 relative px-1">
            {VALID_SCORES.map((score) => (
              <div
                key={score}
                className={`absolute w-[2px] h-3 ${
                  score % 1 === 0 ? 'bg-gray-400' : 'bg-gray-200'
                }`}
                style={{ 
                  left: `${((score - min) / (max - min)) * 100}%`,
                  transform: 'translateX(-50%)',
                }}
              />
            ))}
          </div>
        </div>

        {/* Bottom Scale Numbers */}
        <div className="flex items-center gap-4 -mt-2">
          <div className="w-20 shrink-0"></div>
          <div className="flex-1 relative px-0">
            {scaleMarkers.map((mark) => (
              <div 
                key={mark} 
                className="absolute flex justify-center"
                style={{ 
                  left: `${((mark - min) / (max - min)) * 100}%`,
                  transform: 'translateX(-50%)',
                }}
              >
                <span className="text-sm font-medium text-gray-500 tabular-nums">
                  {mark.toFixed(1)}
                </span>
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\components\ui\sliders\Slider.tsx
----------------------------------------------------------------
'use client';

import * as React from 'react';
import { motion } from 'framer-motion';

interface SliderProps {
  value: number;
  min?: number;
  max?: number;
  step?: number;
  onChange: (value: number) => void;
  label?: string;
  color?: 'blue' | 'indigo' | 'purple' | 'gray';
  disabled?: boolean;
}

const colors = {
  blue: 'bg-blue-600',
  indigo: 'bg-indigo-600',
  purple: 'bg-purple-600',
  gray: 'bg-gray-600',
};

const trackColors = {
  blue: 'bg-blue-100',
  indigo: 'bg-indigo-100',
  purple: 'bg-purple-100',
  gray: 'bg-gray-200',
};

export function Slider({
  value,
  min = 1,
  max = 5,
  step = 0.5,
  onChange,
  label,
  color = 'blue',
  disabled = false,
}: SliderProps) {
  const percentage = ((value - min) / (max - min)) * 100;
  // Clamp percentage between 0 and 100
  const clampedPercentage = Math.max(0, Math.min(100, percentage));

  return (
    <div className="w-full">
      {label && (
        <div className="flex justify-between mb-2">
          <label className="text-sm font-medium text-gray-700">{label}</label>
          <span className="text-sm font-bold text-gray-900">{value.toFixed(1)}</span>
        </div>
      )}
      
      <div className="relative w-full h-6 flex items-center select-none touch-none">
        {/* Track */}
        <div className={`absolute w-full h-2 rounded-full overflow-hidden ${trackColors[color]}`}>
           {/* Animated Fill */}
           <motion.div
            className={`h-full ${colors[color]}`}
            initial={{ width: `${clampedPercentage}%` }}
            animate={{ width: `${clampedPercentage}%` }}
            transition={{ type: 'spring', stiffness: 300, damping: 30 }}
          />
        </div>

        {/* Input - invisible but accessible */}
        <input
          type="range"
          min={min}
          max={max}
          step={step}
          value={value}
          onChange={(e) => onChange(parseFloat(e.target.value))}
          disabled={disabled}
          className="absolute w-full h-full opacity-0 cursor-pointer z-10"
        />

        {/* Thumb (Visual Only - follows percentage with proper clamping) */}
        <motion.div
           className={`absolute w-4 h-4 bg-white border-2 border-gray-300 rounded-full shadow-sm pointer-events-none z-0`}
           style={{ 
             left: `calc(${clampedPercentage}% - 8px)`,
             // Ensure thumb stays within bounds
             transform: clampedPercentage <= 0 ? 'translateX(0)' : 
                       clampedPercentage >= 100 ? 'translateX(-8px)' : 'none'
           }}
           animate={{ 
             left: `calc(${clampedPercentage}% - 8px)` 
           }}
           transition={{ type: 'spring', stiffness: 300, damping: 30 }}
        />
        
        {/* Ticks (Visual Guide) */}
        <div className="absolute w-full h-full pointer-events-none flex justify-between px-[2px]">
           {Array.from({ length: (max - min) + 1 }).map((_, i) => (
             <div key={i} className="w-[1px] h-full" /> 
           ))}
        </div>
      </div>
       
      <div className="flex justify-between mt-1 text-xs text-gray-400 font-mono">
        <span>{min}</span>
        <span>{max}</span>
      </div>
    </div>
  );
}

----------------------------------------------------------------
File: src\lib\api\adminEndpoints.ts
----------------------------------------------------------------
/**
 * Admin API Endpoint Functions
 * All backend admin API calls organized by feature
 * All endpoints require JWT authentication (except login)
 */

import { ApiClient, TokenManager } from './client';
import * as AdminTypes from './adminTypes';

const API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001/api';

/**
 * Generic fetch wrapper for admin endpoints that return raw responses
 */
async function fetchAdmin<T>(
  endpoint: string,
  options?: RequestInit
): Promise<T> {
  const token = TokenManager.getToken();
  
  const response = await fetch(`${API_BASE}${endpoint}`, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      ...(token ? { Authorization: `Bearer ${token}` } : {}),
      ...options?.headers,
    },
  });

  if (!response.ok) {
    const error = await response.text();
    throw new Error(`API Error: ${response.status} - ${error}`);
  }

  // Handle 204 No Content
  if (response.status === 204) {
    return {} as T;
  }

  const result = await response.json();
  return result;
}

/**
 * Generic fetch wrapper for admin endpoints that return wrapped responses
 */
async function fetchAdminWrapped<T>(
  endpoint: string,
  options?: RequestInit
): Promise<T> {
  const response = await fetchAdmin<any>(endpoint, options);
  
  // Check if response has success field
  if (response && response.success === false) {
    throw new Error(response.error || 'API returned error');
  }
  
  return response;
}

// ==========================================
// Authentication Endpoints
// ==========================================

export const AdminAuthAPI = {
  /**
   * Login with email and password.
   * Uses direct fetch without Authorization header so an old token is never sent.
   */
  async login(credentials: AdminTypes.AdminLoginRequest): Promise<AdminTypes.AdminAuthResponse> {
    const res = await fetch(`${API_BASE}/admin/auth/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(credentials),
    });
    if (!res.ok) {
      const text = await res.text();
      let message = `API Error: ${res.status}`;
      try {
        const json = JSON.parse(text);
        if (json.error) message = json.error;
      } catch {
        if (text) message = text;
      }
      throw new Error(message);
    }
    const response = await res.json();
    
    // Handle wrapped response format: { success: true, data: { user, token } }
    // or direct format: { success: true, user, token }
    let finalResponse: AdminTypes.AdminAuthResponse;
    
    if (response.data && response.data.user && response.data.token) {
      // Wrapped format - extract token and user
      finalResponse = {
        success: true,
        user: response.data.user,
        token: response.data.token
      };
    } else if (response.user && response.token) {
      // Backend returns { user, token } without success field
      finalResponse = {
        success: true,
        user: response.user,
        token: response.token
      };
    } else {
      finalResponse = {
        success: !!response.success,
        user: response.user,
        token: response.token
      };
    }

    // Store token whenever we have one (backend may not send success field)
    if (finalResponse.token) {
      TokenManager.setToken(finalResponse.token);
    }
    
    return finalResponse;
  },

  /**
   * Logout and invalidate token
   */
  async logout(): Promise<{ success: boolean }> {
    try {
      const response = await fetchAdminWrapped<{ success: boolean }>('/admin/auth/logout', {
        method: 'POST',
      });
      TokenManager.removeToken();
      return response;
    } catch (error) {
      // Even if server call fails, remove local token
      TokenManager.removeToken();
      return { success: true };
    }
  },

  /**
   * Verify current token is valid
   */
  async verify(): Promise<AdminTypes.AdminVerifyResponse> {
    return fetchAdminWrapped<AdminTypes.AdminVerifyResponse>('/admin/auth/verify');
  },

  /**
   * Check if user is logged in
   */
  isAuthenticated(): boolean {
    return TokenManager.hasToken();
  },

  /**
   * Get stored token
   */
  getToken(): string | null {
    return TokenManager.getToken();
  }
};

// ==========================================
// Dashboard Endpoints
// ==========================================

export const DashboardAPI = {
  /**
   * Get dashboard statistics
   * @param range - Optional time range: '30d', '90d', '1y', or 'all'
   */
  async getStats(range?: string): Promise<AdminTypes.DashboardData> {
    const params = range && range !== 'all' ? `?range=${range}` : '';
    return fetchAdminWrapped<AdminTypes.DashboardData>(`/admin/dashboard/stats${params}`);
  },

  /**
   * Get recent activity (last 24 hours)
   */
  async getActivity(): Promise<AdminTypes.DashboardActivityItem[]> {
    return fetchAdminWrapped<AdminTypes.DashboardActivityItem[]>('/admin/dashboard/activity');
  }
};

// ==========================================
// Assessment Endpoints
// ==========================================

export const AssessmentAdminAPI = {
  /**
   * Get all assessments
   */
  async list(): Promise<AdminTypes.AssessmentListItem[]> {
    return fetchAdminWrapped<AdminTypes.AssessmentListItem[]>('/admin/assessments');
  },

  /**
   * Get a single assessment with all dimensions and topics
   */
  async get(id: string): Promise<AdminTypes.AssessmentWithDimensions> {
    return fetchAdminWrapped<AdminTypes.AssessmentWithDimensions>(`/admin/assessments/${id}`);
  },

  /**
   * Create a new assessment
   */
  async create(data: AdminTypes.CreateAssessmentRequest): Promise<AdminTypes.AssessmentResponse> {
    return fetchAdminWrapped<AdminTypes.AssessmentResponse>('/admin/assessments', {
      method: 'POST',
      body: JSON.stringify(data),
    });
  },

  /**
   * Update an existing assessment (partial update)
   */
  async update(id: string, data: Partial<AdminTypes.CreateAssessmentRequest>): Promise<AdminTypes.AssessmentResponse> {
    return fetchAdminWrapped<AdminTypes.AssessmentResponse>(`/admin/assessments/${id}`, {
      method: 'PUT',
      body: JSON.stringify(data),
    });
  },

  /**
   * Publish or unpublish an assessment
   */
  async publish(id: string, isPublished: boolean): Promise<{ message: string }> {
    return fetchAdminWrapped<{ message: string }>(`/admin/assessments/${id}/publish`, {
      method: 'PATCH',
      body: JSON.stringify({ is_published: isPublished }),
    });
  },

  /**
   * Delete an assessment
   */
  async delete(id: string): Promise<{ message: string }> {
    return fetchAdminWrapped<{ message: string }>(`/admin/assessments/${id}`, {
      method: 'DELETE',
    });
  }
};

// ==========================================
// Response Endpoints
// ==========================================

export const ResponseAdminAPI = {
  /**
   * Get paginated list of responses
   */
  async list(params?: AdminTypes.ResponseListParams): Promise<AdminTypes.PaginatedResponse<AdminTypes.ResponseListItem>> {
    const queryParams = new URLSearchParams();
    
    if (params?.page) queryParams.set('page', params.page.toString());
    if (params?.limit) queryParams.set('limit', params.limit.toString());
    if (params?.status) queryParams.set('status', params.status);
    if (params?.assessment_id) queryParams.set('assessment_id', params.assessment_id);
    if (params?.search) queryParams.set('search', params.search);
    
    const queryString = queryParams.toString();
    const endpoint = `/admin/responses${queryString ? `?${queryString}` : ''}`;
    
    return fetchAdminWrapped<AdminTypes.PaginatedResponse<AdminTypes.ResponseListItem>>(endpoint);
  },

  /**
   * Get a single response with all details
   */
  async get(id: string): Promise<AdminTypes.ResponseDetail> {
    return fetchAdminWrapped<AdminTypes.ResponseDetail>(`/admin/responses/${id}`);
  }
};

// ==========================================
// Analytics Endpoints
// ==========================================

export const AnalyticsAPI = {
  /**
   * Get analytics overview
   */
  async getOverview(): Promise<AdminTypes.AnalyticsData> {
    return fetchAdminWrapped<AdminTypes.AnalyticsData>('/admin/analytics');
  },

  /**
   * Get dimension breakdown analytics
   */
  async getDimensionBreakdown(): Promise<AdminTypes.AnalyticsDimensionBreakdown[]> {
    return fetchAdminWrapped<AdminTypes.AnalyticsDimensionBreakdown[]>('/admin/analytics/dimension-breakdown');
  },

  /**
   * Export responses data
   */
  async exportResponses(assessmentId?: string): Promise<AdminTypes.ExportResponse[]> {
    const params = assessmentId ? `?assessment_id=${assessmentId}` : '';
    return fetchAdminWrapped<AdminTypes.ExportResponse[]>(`/admin/analytics/export/responses${params}`);
  }
};

// ==========================================
// Settings Endpoints
// ==========================================

export const SettingsAPI = {
  /**
   * Get all system settings
   */
  async get(): Promise<AdminTypes.SystemSettings> {
    return fetchAdminWrapped<AdminTypes.SystemSettings>('/admin/settings');
  },

  /**
   * Update system settings
   */
  async update(settings: AdminTypes.UpdateSettingsRequest['settings']): Promise<AdminTypes.SettingsUpdateResponse> {
    return fetchAdminWrapped<AdminTypes.SettingsUpdateResponse>('/admin/settings', {
      method: 'PUT',
      body: JSON.stringify({ settings }),
    });
  }
};

// ==========================================
// Recommendations Endpoints (Admin Management)
// ==========================================

export const RecommendationAdminAPI = {
  /**
   * Get all recommendations, optionally filtered by dimension
   */
  async list(dimensionId?: string): Promise<AdminTypes.AdminRecommendation[]> {
    const params = dimensionId ? `?dimension_id=${dimensionId}` : '';
    return fetchAdminWrapped<AdminTypes.AdminRecommendation[]>(`/admin/recommendations${params}`);
  },

  /**
   * Create a new recommendation
   */
  async create(data: AdminTypes.CreateRecommendationRequest): Promise<AdminTypes.AdminRecommendation> {
    return fetchAdminWrapped<AdminTypes.AdminRecommendation>('/admin/recommendations', {
      method: 'POST',
      body: JSON.stringify(data),
    });
  },

  /**
   * Update an existing recommendation
   */
  async update(id: string, data: Omit<AdminTypes.CreateRecommendationRequest, 'id'>): Promise<AdminTypes.AdminRecommendation> {
    return fetchAdminWrapped<AdminTypes.AdminRecommendation>(`/admin/recommendations/${id}`, {
      method: 'PUT',
      body: JSON.stringify(data),
    });
  },

  /**
   * Delete a recommendation
   */
  async delete(id: string): Promise<{ message: string }> {
    return fetchAdminWrapped<{ message: string }>(`/admin/recommendations/${id}`, {
      method: 'DELETE',
    });
  }
};

// ==========================================
// Export all admin APIs as a single object
// ==========================================

export const AdminAPI = {
  auth: AdminAuthAPI,
  dashboard: DashboardAPI,
  assessments: AssessmentAdminAPI,
  responses: ResponseAdminAPI,
  analytics: AnalyticsAPI,
  settings: SettingsAPI,
  recommendations: RecommendationAdminAPI,
};

export default AdminAPI;


----------------------------------------------------------------
File: src\lib\api\adminTypes.ts
----------------------------------------------------------------
/**
 * Admin API Type Definitions
 * Types for admin dashboard, authentication, and management features
 */

// ==========================================
// Authentication Types
// ==========================================

export interface AdminUser {
  userId: string;
  email: string;
  fullName: string;
  role: 'admin' | 'super_admin';
  createdAt?: string;
  lastLoginAt?: string;
}

export interface AdminLoginRequest {
  email: string;
  password: string;
}

export interface AdminAuthResponse {
  success: boolean;
  token?: string;
  user?: AdminUser;
  error?: string;
}

export interface AdminVerifyResponse {
  valid: boolean;
  user: AdminUser;
}

// ==========================================
// Dashboard Types
// ==========================================

export interface DashboardStats {
  active_assessments: number;
  total_responses: number;
  completed_responses: number;
  in_progress_responses: number;
  total_participants: number;
  active_participants: number;
  avg_overall_score: number;
  avg_overall_gap: number;
  completion_rate: number;
}

export interface DashboardActivityItem {
  id: string;
  type: 'response';
  status: string;
  timestamp: string;
  participant_name: string;
  company_name: string;
  assessment_title: string;
}

export interface DashboardDimensionStats {
  title: string;
  avg_score?: number;
  avg_gap?: number;
  avg_priority?: number;
}

export interface DashboardIndustryStats {
  industry: string;
  total: number;
  completed: number;
  completion_rate: number;
  avg_score: number;
}

export interface DashboardRecentCompletion {
  id: string;
  completed_at: string;
  overall_score: number;
  full_name: string;
  company_name: string;
  industry: string;
}

export interface DashboardData {
  overview: DashboardStats;
  recentActivity: DashboardActivityItem[];
  topDimensions: DashboardDimensionStats[];
  bottomDimensions: DashboardDimensionStats[];
  industryStats: DashboardIndustryStats[];
  recentCompletions: DashboardRecentCompletion[];
}

// ==========================================
// Assessment Types
// ==========================================

export interface AssessmentTopic {
  id: string;
  key: string;
  label: string;
  prompt: string;
  help_text?: string;
  order: number;
}

export interface AssessmentDimension {
  id: string;
  key: string;
  title: string;
  description?: string;
  category: string;
  order: number;
  topics: AssessmentTopic[];
}

export interface AssessmentListItem {
  id: string;
  title: string;
  description?: string;
  version: number;
  is_active: boolean;
  is_published: boolean;
  created_at: string;
  created_by_name?: string;
  dimension_count: number;
  topic_count: number;
  response_count: number;
}

export interface AssessmentWithDimensions {
  id: string;
  title: string;
  description?: string;
  version: number;
  is_active: boolean;
  is_published: boolean;
  created_at: string;
  created_by?: string;
  created_by_name?: string;
  dimensions: AssessmentDimension[];
}

export interface CreateAssessmentRequest {
  title: string;
  description?: string;
  version: number;
  dimensions: {
    key: string;
    title: string;
    description?: string;
    category: string;
    order: number;
    topics: {
      key: string;
      label: string;
      prompt: string;
      help_text?: string;
      order: number;
    }[];
  }[];
}

export interface AssessmentResponse {
  id: string;
  message?: string;
}

// ==========================================
// Response Types
// ==========================================

export interface ResponseListItem {
  id: string;
  assessment_id: string;
  participant_id: string;
  status: 'in_progress' | 'completed';
  overall_score: number;
  overall_gap: number;
  started_at: string;
  completed_at?: string;
  last_updated_at: string;
  full_name: string;
  email: string;
  company_name: string;
  assessment_title: string;
}

export interface TopicAnswer {
  id: string;
  topic_id: string;
  current_rating: number;
  target_rating: number;
  gap: number;
  notes?: string;
  answered_at: string;
  time_spent_seconds?: number;
  label: string;
  dimension_title: string;
}

export interface PriorityScore {
  id: string;
  dimension_id: string;
  dimension_score: number;
  dimension_gap: number;
  priority_score: number;
  rank_order: number;
  dimension_title: string;
}

export interface ResponseDetail {
  response: ResponseListItem;
  answers: TopicAnswer[];
  priorities: PriorityScore[];
}

export interface ResponseListParams {
  page?: number;
  limit?: number;
  status?: string;
  assessment_id?: string;
  search?: string;
}

// ==========================================
// Pagination Types
// ==========================================

export interface PaginationInfo {
  total: number;
  page: number;
  limit: number;
  pages: number;
}

export interface PaginatedResponse<T> {
  data: T[];
  pagination: PaginationInfo;
}

// ==========================================
// Analytics Types
// ==========================================

export interface DimensionPerformance {
  title: string;
  category: string;
  avg_score: number;
  avg_gap: number;
  min_score: number;
  max_score: number;
}

export interface ResponseTrend {
  date: string;
  count: number;
  avg_score: number;
}

export interface AnalyticsData {
  dimension_performance: DimensionPerformance[];
  response_trends: ResponseTrend[];
  generated_at: string;
}

export interface AnalyticsDimensionBreakdown {
  title: string;
  category: string;
  avg_score: number;
  avg_gap: number;
  min_score: number;
  max_score: number;
}

export interface ExportResponse {
  response_id: string;
  full_name: string;
  email: string;
  company_name: string;
  overall_score: number;
  overall_gap: number;
  completed_at: string;
}

// ==========================================
// Settings Types
// ==========================================

export interface SystemSettings {
  [key: string]: any;
}

export interface UpdateSettingsRequest {
  settings: {
    key: string;
    value: any;
  }[];
}

export interface SettingsUpdateResponse {
  message: string;
  updated: number;
}

// ==========================================
// Recommendations Types (Admin Management)
// ==========================================

export interface RecommendationResource {
  title: string;
  url: string;
  type?: string;
}

export interface AdminRecommendation {
  id: string;
  dimension_id: string;
  dimension_title: string;
  title: string;
  description: string;
  action_items: string[];
  resources: RecommendationResource[];
  min_gap: number;
  max_gap: number;
  priority_level: 'low' | 'medium' | 'high' | 'critical';
  created_at?: string;
  updated_at?: string;
}

export interface CreateRecommendationRequest {
  dimension_id: string;
  title: string;
  description: string;
  action_items: string[];
  resources?: RecommendationResource[];
  min_gap: number;
  max_gap: number;
  priority_level: 'low' | 'medium' | 'high' | 'critical';
}

export interface UpdateRecommendationRequest extends CreateRecommendationRequest {
  id: string;
}

// ==========================================
// API Response Wrappers
// ==========================================

export interface AdminApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
}

export interface AdminApiError {
  success: false;
  error: string;
  details?: any;
}


----------------------------------------------------------------
File: src\lib\api\client.ts
----------------------------------------------------------------
/**
 * Core HTTP client for API communication
 * Features:
 * - Automatic error handling
 * - Request/response interceptors
 * - TypeScript type safety
 * - Retry logic for failed requests
 * - JWT token management for authenticated requests
 */

const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001/api';

// JWT Token storage keys
const JWT_TOKEN_KEY = 'admin_jwt_token';

/**
 * JWT Token Manager for Admin API
 */
export const TokenManager = {
  /**
   * Get the stored JWT token
   */
  getToken(): string | null {
    if (typeof window === 'undefined') return null;
    return localStorage.getItem(JWT_TOKEN_KEY);
  },

  /**
   * Store the JWT token
   */
  setToken(token: string): void {
    if (typeof window === 'undefined') return;
    localStorage.setItem(JWT_TOKEN_KEY, token);
  },

  /**
   * Remove the JWT token
   */
  removeToken(): void {
    if (typeof window === 'undefined') return;
    localStorage.removeItem(JWT_TOKEN_KEY);
  },

  /**
   * Check if a valid token exists
   */
  hasToken(): boolean {
    const token = this.getToken();
    return token !== null && token.length > 0;
  }
};

interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: string;
  details?: any;
}

interface RequestOptions {
  method?: 'GET' | 'POST' | 'PUT' | 'DELETE';
  headers?: Record<string, string>;
  body?: any;
  retry?: boolean;
  retryAttempts?: number;
  requiresAuth?: boolean;
}

export class ApiClient {
  /**
   * Get authorization headers with JWT token if available
   */
  private static getAuthHeaders(additionalHeaders?: Record<string, string>): Record<string, string> {
    const headers: Record<string, string> = {
      'Content-Type': 'application/json',
      ...additionalHeaders,
    };

    const token = TokenManager.getToken();
    if (token) {
      headers['Authorization'] = `Bearer ${token}`;
    }

    return headers;
  }

  private static async request<T>(
    endpoint: string,
    options: RequestOptions = {}
  ): Promise<ApiResponse<T>> { // Changed return type to ApiResponse<T> to match usage
    const { 
      method = 'GET', 
      headers = {}, 
      body, 
      retry = false, 
      retryAttempts = 3,
      requiresAuth = false
    } = options;

    const url = `${API_BASE_URL}${endpoint.startsWith('/') ? endpoint : `/${endpoint}`}`;
    
    // Merge auth headers with any additional headers
    const authHeaders = requiresAuth ? this.getAuthHeaders(headers) : { 'Content-Type': 'application/json', ...headers };
    
    const config: RequestInit = {
      method,
      headers: authHeaders,
      body: body ? JSON.stringify(body) : undefined,
    };

    let attempts = 0;
    const maxAttempts = retry ? retryAttempts : 1;

    while (attempts < maxAttempts) {
      try {
        const response = await fetch(url, config);
        
        // Handle 204 No Content
        if (response.status === 204) {
             return { success: true } as ApiResponse<T>;
        }

        const data = await response.json();

        if (!response.ok) {
           throw new Error(data.error || `API Error: ${response.statusText}`);
        }

        return data as ApiResponse<T>;

      } catch (error: any) {
        attempts++;
        console.error(`API Request failed (Attempt ${attempts}/${maxAttempts}):`, error);

        if (attempts >= maxAttempts) {
           // Standardize error return
           throw new Error(error.message || 'Network request failed');
        }

        // Exponential backoff
        await new Promise(resolve => setTimeout(resolve, 1000 * Math.pow(2, attempts - 1)));
      }
    }

    throw new Error('Request failed after max retries');
  }

  static async get<T>(endpoint: string, requiresAuth = false): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, { method: 'GET', retry: true, requiresAuth });
  }

  static async post<T>(endpoint: string, data?: any, requiresAuth = false): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, { method: 'POST', body: data, requiresAuth });
  }

  static async put<T>(endpoint: string, data?: any, requiresAuth = false): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, { method: 'PUT', body: data, retry: true, requiresAuth });
  }

  static async delete<T>(endpoint: string, requiresAuth = false): Promise<ApiResponse<T>> {
      return this.request<T>(endpoint, { method: 'DELETE', requiresAuth });
  }

  /**
   * Authenticated request wrapper - automatically includes JWT token
   * Use this for all admin API calls
   */
  static async authenticated<T>(endpoint: string, options: Omit<RequestOptions, 'requiresAuth'> = {}): Promise<ApiResponse<T>> {
    return this.request<T>(endpoint, { ...options, requiresAuth: true });
  }
}


----------------------------------------------------------------
File: src\lib\api\endpoints.ts
----------------------------------------------------------------
/**
 * API Endpoint Functions
 * All backend API calls organized by feature
 * All responses are wrapped in { success: boolean, data: ... } format
 */

import { ApiClient } from './client';
import * as Types from './types';

const API_BASE = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001/api';

/**
 * Generic fetch wrapper for endpoints that return wrapped responses
 */
async function fetchWrapped<T>(endpoint: string, options?: RequestInit): Promise<T> {
  const response = await fetch(`${API_BASE}${endpoint}`, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      ...options?.headers,
    },
  });

  if (!response.ok) {
    const error = await response.text();
    throw new Error(`API Error: ${response.status} - ${error}`);
  }

  const result = await response.json();
  
  // Handle wrapped response format
  if (result.success === false) {
    throw new Error(result.error || 'API returned error');
  }
  
  return result.data;
}

/**
 * Generic fetch for endpoints that return unwrapped responses
 */
async function fetchRaw<T>(endpoint: string, options?: RequestInit): Promise<T> {
  const response = await fetch(`${API_BASE}${endpoint}`, {
    ...options,
    headers: {
      'Content-Type': 'application/json',
      ...options?.headers,
    },
  });

  if (!response.ok) {
    const error = await response.text();
    throw new Error(`API Error: ${response.status} - ${error}`);
  }

  return response.json();
}

export const AssessmentAPI = {
  /**
   * Get the currently active published assessment
   */
  async getActive(): Promise<Types.AssessmentResponse> {
    return fetchWrapped<Types.AssessmentResponse>('/public/assessments/active');
  },

  /**
   * Get complete assessment structure (dimensions + topics)
   * Note: The /active/structure endpoint returns unwrapped response
   */
  async getStructure(assessmentId: string): Promise<Types.AssessmentStructureResponse> {
    // Use the wrapped endpoint
    return fetchWrapped<Types.AssessmentStructureResponse>(
      `/public/assessments/${assessmentId}/structure`
    );
  },

  /**
   * Alternative: Get active assessment structure directly
   * Returns unwrapped response from /public/assessments/active/structure
   */
  async getActiveStructure(): Promise<Types.AssessmentStructureResponse> {
    return fetchRaw<Types.AssessmentStructureResponse>('/public/assessments/active/structure');
  },

  /**
   * Get recommendations definition from database
   * Returns unwrapped response
   */
  async getRecommendationsDefinition(): Promise<Types.RecommendationsDefinitionAPI> {
    return fetchRaw<Types.RecommendationsDefinitionAPI>('/public/recommendations/definition');
  },

  /**
   * Get narrative definition from database
   * Returns unwrapped response
   */
  async getNarrativeDefinition(): Promise<Types.NarrativeDefinitionAPI> {
    return fetchRaw<Types.NarrativeDefinitionAPI>('/public/narrative/definition');
  }
};

export const ParticipantAPI = {
  /**
   * Register a new participant or update existing
   */
  async register(data: Types.RegistrationData): Promise<Types.ParticipantResponseData> {
    const response = await fetchWrapped<Types.ParticipantResponseData>(
      '/public/participants',
      {
        method: 'POST',
        body: JSON.stringify(data),
      }
    );
    return response;
  },
};

export const ResponseAPI = {
  /**
   * Start a new assessment response
   */
  async start(assessmentId: string, participantId: string): Promise<Types.StartResponseData> {
    return fetchWrapped<Types.StartResponseData>(
      '/public/responses/start',
      {
        method: 'POST',
        body: JSON.stringify({ assessmentId, participantId }),
      }
    );
  },

  /**
   * Submit an answer for a topic
   */
  async submitAnswer(responseId: string, answer: {
    topicId: string;
    currentRating: number;
    targetRating: number;
    timeSpentSeconds?: number;
    notes?: string;
  }): Promise<Types.AnswerResponseData> {
    return fetchWrapped<Types.AnswerResponseData>(
      `/public/responses/${responseId}/answer`,
      {
        method: 'PUT',
        body: JSON.stringify(answer),
      }
    );
  },

  /**
   * Get session data by token (for resuming)
   */
  async getSession(sessionToken: string): Promise<Types.SessionDataInner> {
    return fetchWrapped<Types.SessionDataInner>(
      `/public/responses/session/${sessionToken}`
    );
  },

  /**
   * Complete the assessment
   */
  async complete(responseId: string): Promise<Types.CompleteResponseData> {
    return fetchWrapped<Types.CompleteResponseData>(
      `/public/responses/${responseId}/complete`,
      {
        method: 'POST',
      }
    );
  },

  /**
   * Get assessment results
   */
  async getResults(responseId: string): Promise<Types.ResultsData> {
    return fetchWrapped<Types.ResultsData>(
      `/public/responses/${responseId}/results`
    );
  },

  /**
   * Get recommendations (optional endpoint)
   */
  async getRecommendations(responseId: string): Promise<Types.RecommendationsData> {
    return fetchWrapped<Types.RecommendationsData>(
      `/public/responses/${responseId}/recommendations`
    );
  },
};


----------------------------------------------------------------
File: src\lib\api\types.ts
----------------------------------------------------------------
/**
 * API Response Type Definitions
 * These match the backend response structures exactly
 */

export interface AssessmentResponse {
  id: string;
  version: number;
  title: string;
  description: string;
  estimated_duration_minutes?: number;
}

export interface TopicStructure {
  id: string;
  topicKey: string;
  label: string;
  prompt: string;
  orderIndex: number;
  helpText?: string;
}

export interface DimensionStructure {
  id: string;
  dimensionKey: string;
  title: string;
  description?: string;
  category?: string;
  orderIndex: number;
  topics: TopicStructure[];
}

export interface AssessmentStructureResponse {
  assessment: AssessmentResponse;
  dimensions: DimensionStructure[];
}

export interface RegistrationData {
  email: string;
  fullName: string;
  companyName: string;
  jobTitle?: string;
  consentGiven: boolean;
}

export interface ParticipantResponse {
  success: boolean;
  data: {
    participantId: string;
    email: string;
    fullName: string;
    message?: string;
  };
}

export interface StartResponseResponse {
  success: boolean;
  data: {
    responseId: string;
    sessionToken: string;
  };
}

export interface AnswerData {
  topicId: string;
  currentRating: number;
  targetRating: number;
  timeSpentSeconds?: number;
  notes?: string;
}

export interface AnswerResponse {
  success: boolean;
  data: {
    topicResponseId: string;
    gap: number;
    normalizedGap: number;
    progress: number;
  };
}

export interface SessionData {
  success: boolean;
  data: {
    responseId: string;
    status: string;
    progress: number;
    answeredTopics: Array<{
      topicId: string;
      currentRating: number;
      targetRating: number;
      gap: number;
    }>;
  };
}

export interface CompleteResponse {
  success: boolean;
  data: {
    responseId: string;
    completedAt: string;
    overallScore: number;
    overallGap: number;
  };
}

export interface DimensionResult {
  dimensionKey: string;
  title: string;
  score: number;
  gap: number;
  priorityScore: number;
  topics: any[];
}

export interface TopGap {
  topicId: string;
  label: string;
  gap: number;
  dimensionTitle: string;
}

export interface Priority {
  dimensionKey: string;
  title: string;
  priorityScore: number;
  rank: number;
}

export interface ResultsDataResponse {
  success: boolean;
  data: ResultsData;
}

export interface ResultsData {
  overallScore: number;
  overallGap: number;
  maturityLevel?: string;
  dimensions: DimensionResult[];
  topGaps: TopGap[];
  priorities: Priority[];
}

export interface RecommendationItem {
  title: string;
  description: string;
  actionItems: string[];
  resources: Array<{
    title: string;
    url: string;
    type?: string;
  }>;
}

export interface DimensionRecommendation {
  dimensionKey: string;
  dimensionTitle: string;
  priorityScore: number;
  items: RecommendationItem[];
}

export interface RecommendationsData {
  recommendations: DimensionRecommendation[];
}

// ==========================================
// Recommendation Types (FROM API)
// ==========================================

export interface RecommendationRuleAPI {
  id: string;
  title: string;
  description: string;
  conditions: {
    gapMin?: number;
    gapMax?: number;
    maturityBelow?: number;
    maturityAbove?: number;
  };
  why?: string;
  what?: string;
  how?: string;
  priority: number;
  tags: string[];
  impactLevel?: string;
  effortLevel?: string;
  timeframe?: string;
  actionItems?: Array<{
    id: string;
    text: string;
    category?: string;
  }>;
  resources?: Array<{
    title: string;
    url?: string;
    type?: string;
  }>;
  kpis?: string[];
}

export interface RecommendationsDefinitionAPI {
  dimensions: Array<{
    dimensionKey: string;
    recommendations: RecommendationRuleAPI[];
  }>;
  meta: {
    dimensionColors: Record<string, string>;
    dimensionWeights: Record<string, number>;
    themeMap: Record<string, string>;
    priorityWeights?: Record<string, number>;
    urgencyTags?: string[];
    dimensionOrder?: string[];
    titleTemplates?: Record<string, string[]>;
    descriptionTemplate?: string;
  };
}

// ==========================================
// Narrative Types (FROM API)
// ==========================================

export interface NarrativeDefinitionAPI {
  version: number;
  themeMap: Record<string, string>;
  maturityThresholds: Record<string, number>;
  maturityLabels?: string[];
  gapThresholds?: {
    minor: number;
    moderate: number;
    significant: number;
  };
  headlines?: {
    lowConfidencePrefix: string;
    byStageId: Record<string, string>;
  };
  executiveSummary?: {
    sentence1: string;
    sentence2: string;
    sentence3: string;
  };
  stageRationale?: string;
  priorityWhyTemplate?: string;
  notes?: Record<string, string>;
  executiveTemplates: {
    maturityLevel: Record<string, string>;
    gapAnalysis: {
      large: string;
      moderate: string;
      minimal: string;
    };
    strengths: {
      multiple: string;
      single: string;
    };
    priorities: {
      high: string;
      balanced: string;
    };
  };
  dimensionTemplates?: Record<string, string[]>;
  gapTemplates?: Record<string, string[]>;
}

// ==========================================
// Backward-Compatible Type Aliases
// ==========================================

// For backward compatibility with existing components
export type ParticipantData = RegistrationData;
export type ParticipantResponseData = ParticipantResponse['data'];
export type StartResponseData = StartResponseResponse['data'];
export type SessionDataInner = SessionData['data'];
export type AnswerResponseData = AnswerResponse['data'];
export type CompleteResponseData = CompleteResponse['data'];

// Re-export for components expecting these types
export type { 
  NarrativeDefinitionAPI as NarrativeDefinition,
  RecommendationsDefinitionAPI as RecommendationsDefinition
};


----------------------------------------------------------------
File: src\lib\assessment\progress.ts
----------------------------------------------------------------

import { AssessmentDefinition } from './validate';
import { ReadinessState } from '../../store/readiness/types';

export type MissingItem = {
  dimensionId: string;
  dimensionTitle: string;
  topicId: string;
  topicLabel: string;
};

/**
 * Computes list of missing (untouched) topics based on definition and store state.
 */
export function getMissingItems(
  definition: AssessmentDefinition,
  touched: ReadinessState['touched']
): MissingItem[] {
  const missing: MissingItem[] = [];

  definition.dimensions.forEach((dim) => {
    const dimTouched = touched[dim.id] || {};
    
    dim.topics.forEach((topic) => {
      // "Answered" means touched is true
      if (!dimTouched[topic.id]) {
        missing.push({
          dimensionId: dim.id,
          dimensionTitle: dim.title,
          topicId: topic.id,
          topicLabel: topic.label,
        });
      }
    });
  });

  return missing;
}


----------------------------------------------------------------
File: src\lib\assessment\validate.ts
----------------------------------------------------------------
import { z } from 'zod';

// Schema for validating API response - uses orderIndex to match backend
// Note: This is used for internal validation, the API types are in @/lib/api/types

export const TopicSchema = z.object({
  id: z.string().min(1),
  topicKey: z.string().optional(),
  label: z.string().min(1),
  prompt: z.string().min(1),
  orderIndex: z.number().int().positive().optional(),
  helpText: z.string().optional(),
  anchors: z.object({
    "1": z.string().min(1),
    "2": z.string().min(1),
    "3": z.string().min(1),
    "4": z.string().min(1),
    "5": z.string().min(1),
  }).strict().optional(),
});

export const DimensionSchema = z.object({
  id: z.string().min(1),
  dimensionKey: z.string().optional(),
  title: z.string().min(1),
  description: z.string().optional(),
  category: z.string().optional(),
  orderIndex: z.number().int().positive().optional(),
  topics: z.array(TopicSchema),
});

export const AssessmentSchema = z.object({
  version: z.number().int().positive().optional(),
  dimensions: z.array(DimensionSchema),
});

export type TopicDefinition = z.infer<typeof TopicSchema>;
export type DimensionDefinition = z.infer<typeof DimensionSchema>;
export type AssessmentDefinition = z.infer<typeof AssessmentSchema>;

// Compatibility aliases
export type AssessmentTopic = TopicDefinition;
export type AssessmentDimension = DimensionDefinition;

export const validateAssessmentDefinition = (data: unknown): AssessmentDefinition => {
  return AssessmentSchema.parse(data);
};


----------------------------------------------------------------
File: src\lib\content\source.ts
----------------------------------------------------------------
import { AssessmentDefinition } from '../assessment/validate';
import { RecommendationsDefinition } from '../recommendations/validate';
import { NarrativeDefinition } from '../narrative/validate';

export interface ContentSource {
  getQuestions(): AssessmentDefinition;
  getRecommendations(): RecommendationsDefinition;
  getNarrative(): NarrativeDefinition;
}


----------------------------------------------------------------
File: src\lib\context\AdminAuthContext.tsx
----------------------------------------------------------------
'use client';

import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';
import { AdminUser, AdminAuthResponse } from '../api/adminTypes';
import { AdminAuthAPI } from '../api/adminEndpoints';

interface AdminAuthContextType {
  user: AdminUser | null;
  isLoading: boolean;
  isAuthenticated: boolean;
  login: (email: string, password: string) => Promise<void>;
  logout: () => Promise<void>;
  verify: () => Promise<boolean>;
  error: string | null;
}

const AdminAuthContext = createContext<AdminAuthContextType | undefined>(undefined);

interface AdminAuthProviderProps {
  children: React.ReactNode;
}

export function AdminAuthProvider({ children }: AdminAuthProviderProps) {
  const [user, setUser] = useState<AdminUser | null>(null);
  const [isLoading, setIsLoading] = useState(true);
  const [error, setError] = useState<string | null>(null);

  // Verify token on mount
  useEffect(() => {
    const verifyToken = async () => {
      if (typeof window === 'undefined') {
        setIsLoading(false);
        return;
      }

      try {
        if (AdminAuthAPI.isAuthenticated()) {
          const response = await AdminAuthAPI.verify();
          if (response.valid && response.user) {
            setUser(response.user);
          } else {
            // Token is invalid or expired
            AdminAuthAPI.logout();
          }
        }
      } catch (err) {
        // Token verification failed, user is not authenticated
        console.error('Token verification failed:', err);
        AdminAuthAPI.logout();
      } finally {
        setIsLoading(false);
      }
    };

    verifyToken();
  }, []);

  const login = useCallback(async (email: string, password: string) => {
    setIsLoading(true);
    setError(null);

    try {
      const response: AdminAuthResponse = await AdminAuthAPI.login({ email, password });

      if (response.user && response.token) {
        setUser(response.user);
      } else {
        throw new Error(response.error || 'Login failed');
      }
    } catch (err: any) {
      setError(err.message || 'An error occurred during login');
      throw err;
    } finally {
      setIsLoading(false);
    }
  }, []);

  const logout = useCallback(async () => {
    setIsLoading(true);
    try {
      await AdminAuthAPI.logout();
    } finally {
      setUser(null);
      setIsLoading(false);
    }
  }, []);

  const verify = useCallback(async (): Promise<boolean> => {
    try {
      const response = await AdminAuthAPI.verify();
      if (response.valid && response.user) {
        setUser(response.user);
        return true;
      }
      setUser(null);
      return false;
    } catch {
      setUser(null);
      return false;
    }
  }, []);

  const value: AdminAuthContextType = {
    user,
    isLoading,
    isAuthenticated: !!user,
    login,
    logout,
    verify,
    error,
  };

  return (
    <AdminAuthContext.Provider value={value}>
      {children}
    </AdminAuthContext.Provider>
  );
}

export function useAdminAuth(): AdminAuthContextType {
  const context = useContext(AdminAuthContext);
  if (context === undefined) {
    throw new Error('useAdminAuth must be used within an AdminAuthProvider');
  }
  return context;
}


----------------------------------------------------------------
File: src\lib\hooks\useAdminAuth.ts
----------------------------------------------------------------
'use client';

import { useAdminAuth as useAdminAuthContext } from '../context/AdminAuthContext';

export interface UseAdminAuthReturn {
  user: import('../api/adminTypes').AdminUser | null;
  isLoading: boolean;
  isAuthenticated: boolean;
  login: (email: string, password: string) => Promise<void>;
  logout: () => Promise<void>;
  verify: () => Promise<boolean>;
  error: string | null;
}

/**
 * Custom hook for accessing admin authentication state
 * 
 * @returns Object containing:
 * - user: Current authenticated user or null
 * - isLoading: Whether auth state is being loaded
 * - isAuthenticated: Whether user is logged in
 * - login: Function to login with email and password
 * - logout: Function to logout
 * - verify: Function to verify current token
 * - error: Error message if any
 * 
 * @example
 * ```tsx
 * const { user, isAuthenticated, login, logout } = useAdminAuth();
 * ```
 */
export function useAdminAuth(): UseAdminAuthReturn {
  return useAdminAuthContext();
}


----------------------------------------------------------------
File: src\lib\maturity\model.ts
----------------------------------------------------------------
export type MaturityStageId = 'explorer' | 'structured' | 'integrated' | 'optimized';

export type MaturityConfidence = 'Low' | 'Medium' | 'High';

export interface MaturityStage {
  id: MaturityStageId;
  label: string;
  description: string;
  minScore: number;
}

export interface DimensionMaturity {
  stage: MaturityStage;
  // gapAvg > 1.5 downgrade applied?
  downgradeReason?: string;
}

export interface OrganizationMaturity {
  stage: MaturityStage;
  confidenceLabel: MaturityConfidence;
  confidenceRatio: number;
  downgradeReason?: string;
}

const STAGES: Record<MaturityStageId, MaturityStage> = {
  explorer: {
    id: 'explorer',
    label: 'Explorer',
    description: 'Initial experimentation with AI. Ad-hoc initiatives with limited strategy or governance.',
    minScore: 0,
  },
  structured: {
    id: 'structured',
    label: 'Structured',
    description: 'Formalized AI programs emerging. Defined roles and basic infrastructure in place.',
    minScore: 2,
  },
  integrated: {
    id: 'integrated',
    label: 'Integrated',
    description: 'AI embedded in core workflows. Scalable platforms and cross-functional alignment.',
    minScore: 3,
  },
  optimized: {
    id: 'optimized',
    label: 'Optimized',
    description: 'AI drives strategic advantage. Continuous innovation and automated value realization.',
    minScore: 4,
  },
};

// Ordered list for easy index access
const ORDERED_STAGES: MaturityStage[] = [
  STAGES.explorer,
  STAGES.structured,
  STAGES.integrated,
  STAGES.optimized,
];

// Helper to get base stage from score
function getBaseStageIndex(score: number): number {
  if (score >= 4) return 3; // Optimized
  if (score >= 3) return 2; // Integrated
  if (score >= 2) return 1; // Structured
  return 0; // Explorer
}

/**
 * Get Dimension Maturity
 * 
 * Logic:
 * - Base stage from currentAvg
 * - If gapAvg > 1.5 -> downgrade 1 stage
 * - Clamp within bounds
 */
export function getDimensionMaturity({
  currentAvg,
  gapAvg,
}: {
  currentAvg: number;
  gapAvg: number;
}): DimensionMaturity {
  let index = getBaseStageIndex(currentAvg);
  let downgradeReason: string | undefined;

  // Downgrade logic
  if (gapAvg > 1.5) {
    if (index > 0) {
      index -= 1;
      downgradeReason = 'Large gap between current and target capabilities.';
    }
  }

  return {
    stage: ORDERED_STAGES[index],
    downgradeReason,
  };
}

/**
 * Get Organization Maturity
 * 
 * Logic:
 * - Base stage from overallCurrentAvg
 * - If confidenceRatio < 0.4 -> downgrade 1 stage
 * - If confidenceRatio < 0.2 -> downgrade 2 stages
 * - Clamp within bounds [Explorer..Optimized]
 */
export function getOrganizationMaturity({
  overallCurrentAvg,
  confidenceRatio,
}: {
  overallCurrentAvg: number;
  confidenceRatio: number;
}): OrganizationMaturity {
  let index = getBaseStageIndex(overallCurrentAvg);
  let downgradeReason: string | undefined;

  // Confidence Downgrades
  // Note: These do not stack with each other (a ratio < 0.2 matches both < 0.4 and < 0.2 conditions in theory, 
  // but we should apply the strongest penalty or sequential logic).
  // The prompt says: 
  // - < 0.4 -> downgrade 1
  // - < 0.2 -> downgrade 2
  // Let's interpret strict checks:
  
  if (confidenceRatio < 0.2) {
    if (index >= 2) {
      index -= 2;
      downgradeReason = 'Very low assessment confidence.';
    } else if (index === 1) {
      index = 0;
      downgradeReason = 'Very low assessment confidence.';
    }
  } else if (confidenceRatio < 0.4) {
    if (index > 0) {
      index -= 1;
      downgradeReason = 'Low assessment confidence.';
    }
  }

  // Determine Confidence Label
  let confidenceLabel: MaturityConfidence = 'High';
  if (confidenceRatio < 0.4) confidenceLabel = 'Low';
  else if (confidenceRatio < 0.7) confidenceLabel = 'Medium';

  return {
    stage: ORDERED_STAGES[index],
    confidenceLabel,
    confidenceRatio,
    downgradeReason,
  };
}

/*
  Boundary Case Checklist:
  [x] currentAvg = 1.9 -> Explorer
  [x] currentAvg = 2.0 -> Structured
  [x] currentAvg = 2.9 -> Structured
  [x] currentAvg = 3.0 -> Integrated
  [x] currentAvg = 3.9 -> Integrated
  [x] currentAvg = 4.0 -> Optimized
  [x] gapAvg = 1.5 -> No downgrade
  [x] gapAvg = 1.51 -> Downgrade 1 level (if possible)
  [x] confidence = 0.39 -> Downgrade 1 level
  [x] confidence = 0.19 -> Downgrade 2 levels
  [x] Downgrade clamped at Explorer (index 0)
*/


----------------------------------------------------------------
File: src\lib\narrative\generate.ts
----------------------------------------------------------------
// import { localSource } from '../content/localSource';
import { OrganizationMaturity } from '../maturity/model';
import { OverallScoreSummary, TopGapModel, EnhancedResultsModel, DimensionComparison } from '../scoring/compute';
// import { RecommendationsModel, RecommendationResult } from '../recommendations/engine'; // REMOVED
// ... actually we just need EnhancedRecommendation now

import type { NarrativeDefinition } from '../api/types';
import { EnhancedRecommendation } from '../recommendations/definition';

/**
 * Replace placeholders in template string with values from vars.
 * @param template "Hello {name}"
 * @param vars { name: "World" }
 * @returns "Hello World"
 */
function formatTemplate(template: string, vars: Record<string, string | number>): string {
  return template.replace(/\{(\w+)\}/g, (match, key) => {
    return vars[key] !== undefined ? String(vars[key]) : match;
  });
}

function buildHeadline(def: NarrativeDefinition, maturity: OrganizationMaturity): string {
  if (!def.headlines || !def.headlines.byStageId) return `Assessment Complete: ${maturity.stage.label}`;

  const stageId = maturity.stage.id;
  const isLowConfidence = maturity.confidenceLabel === 'Low';

  if (isLowConfidence) {
    const prefix = formatTemplate(def.headlines.lowConfidencePrefix, {
      stageLabel: maturity.stage.label
    });
    return `${prefix} potential`;
  }
  
  const template = def.headlines.byStageId[stageId] || def.headlines.byStageId.default;
  return formatTemplate(template, {
      stageLabel: maturity.stage.label
  });
}

function buildNotes(def: NarrativeDefinition, maturity: OrganizationMaturity): string[] {
  const notes: string[] = [];
  if (!def.notes) return notes;
  
  if (maturity.confidenceRatio < 0.4) {
      notes.push(def.notes.low || 'Confidence is low.');
  } else if (maturity.confidenceRatio < 0.7) {
      notes.push(def.notes.moderate || 'Confidence is moderate.');
  }
  return notes;
}

function buildStageRationale(def: NarrativeDefinition, maturity: OrganizationMaturity, overall: OverallScoreSummary): string {
  let rationale = "";
  if (def.stageRationale) {
      rationale = formatTemplate(def.stageRationale, {
          currentAvg: overall.currentAvg.toFixed(1),
          confidenceLabel: maturity.confidenceLabel.toLowerCase(),
          confidenceRatio: (maturity.confidenceRatio * 100).toFixed(0)
      });
  } else {
      rationale = `This stage determination reflects a calculated aggregate score of ${overall.currentAvg.toFixed(1)}.`;
  }
  
  if (maturity.downgradeReason) {
      rationale += ` Note: ${maturity.downgradeReason}`;
  }
  return rationale;
}

export type NarrativeModel = {
  headline: string;
  executiveSummary: string;
  stageRationale: string;
  priorities: Array<{ title: string; why: string }>;
  quickWins: string[];
  notes: string[];
};

export function generateNarrative(args: {
  maturity: OrganizationMaturity;
  overall: OverallScoreSummary;
  topGaps: TopGapModel[];
  recommendations: EnhancedRecommendation[];
  definition: NarrativeDefinition;
}): NarrativeModel {
  const { maturity, overall, topGaps, recommendations, definition: def } = args;
  // const def = localSource.getNarrative(); // REMOVED

  // 0. Helpers & Maps
  const getThemeLabel = (tags: string[] = []): string => {
      for (const t of tags) {
          if (def.themeMap[t]) return def.themeMap[t];
      }
      return "General Capability";
  };

  const getDimensionTitle = (id: string): string => {
      const found = topGaps.find(g => g.dimensionId === id);
      return found ? found.dimensionTitle : id.charAt(0).toUpperCase() + id.slice(1);
  };

  // 1. Headline
  const headline = buildHeadline(def, maturity);

  // 2. Theme & Executive Summary
  // Derive theme from most frequent tag in top 5 recs
  const tagCounts: Record<string, number> = {};
  const top5Recs = recommendations.slice(0, 5);
  top5Recs.forEach(r => {
      if (r.tags) r.tags.forEach(t => {
          const label = def.themeMap[t] || t;
          tagCounts[label] = (tagCounts[label] || 0) + 1;
      });
  });
  
  // Find max tag
  let topTheme = '';
  let maxCount = 0;
  Object.entries(tagCounts).forEach(([theme, count]) => {
      if (count > maxCount) {
          maxCount = count;
          topTheme = theme;
      }
  });

  // Fallback if no tags
  if (!topTheme) {
      topTheme = topGaps.length > 0 ? topGaps[0].dimensionTitle : 'General Readiness';
  }

  // Clean strings construction
  let executiveSummary = "";
  if (def.executiveSummary) {
      const sentence1 = formatTemplate(def.executiveSummary.sentence1, {
          stageLabel: maturity.stage.label,
          currentAvg: overall.currentAvg.toFixed(1)
      });
          
      const sentence2 = formatTemplate(def.executiveSummary.sentence2, {
          topTheme: topTheme.toLowerCase()
      });
          
      const sentence3 = formatTemplate(def.executiveSummary.sentence3, {
          gapAvg: overall.gapAvg.toFixed(1)
      });

      executiveSummary = [sentence1, sentence2, sentence3].join(' ');
  } else {
      executiveSummary = `The organization is at the ${maturity.stage.label} stage with a score of ${overall.currentAvg.toFixed(1)}.`;
  }

  // 3. Stage Rationale
  const rationale = buildStageRationale(def, maturity, overall);

  // 4. Priorities (Dedupe by Theme)
  const priorities: Array<{ title: string; why: string }> = [];
  const startRecs = recommendations; // Was recommendations.recommendations 
  const seenThemes = new Set<string>();

  for (const rec of startRecs) {
    if (priorities.length >= 3) break;
    
    const theme = getThemeLabel(rec.tags);
    const dimTitle = getDimensionTitle(rec.dimension);
    
    // Construct "why" using template
    const whyTemplate = def.priorityWhyTemplate || "Closes a +{gap} gap in {dimensionTitle} by targeting {theme}.";
    const why = formatTemplate(whyTemplate, {
        gap: (rec.gap || 0).toFixed(1),
        dimensionTitle: dimTitle,
        theme: theme
    });

    if (!seenThemes.has(theme)) {
        seenThemes.add(theme);
        priorities.push({
            title: rec.title,
            why
        });
    }
  }

  // Fallback if not enough themes found
  if (priorities.length < 3) {
      const seenTitles = new Set(priorities.map(p => p.title));
      for (const rec of startRecs) {
          if (priorities.length >= 3) break;
          if (!seenTitles.has(rec.title)) {
              seenTitles.add(rec.title);
              const theme = getThemeLabel(rec.tags);
              const dimTitle = getDimensionTitle(rec.dimension);
              
              const whyTemplate = def.priorityWhyTemplate || "Closes a +{gap} gap in {dimensionTitle} by targeting {theme}.";
              const why = formatTemplate(whyTemplate, {
                  gap: (rec.gap || 0).toFixed(1),
                  dimensionTitle: dimTitle,
                  theme: theme
              });
                  
              priorities.push({ title: rec.title, why });
          }
      }
  }
  
  // Last fallback to gaps
  if (priorities.length < 3) {
    topGaps.forEach(gap => {
        if (priorities.length >= 3) return;
        const title = `Strengthen ${gap.topicLabel}`; 
        const exists = priorities.some(p => p.title === title);
        if (!exists) {
             priorities.push({
                title: title,
                why: `Critical gap of ${gap.gap.toFixed(1)} in ${gap.dimensionTitle}.`
            });
        }
    });
  }

  // 5. Quick Wins (Distinct Themes preferred)
  const quickWins: string[] = [];
  const winsSeenActions = new Set<string>();
  const winsSeenThemes = new Set<string>();

  // Pass 1: Distinct themes
  for (const rec of startRecs) {
      if (quickWins.length >= 5) break; 
      const action = rec.actions && rec.actions.length > 0 ? rec.actions[0] : rec.title;
      const theme = getThemeLabel(rec.tags);

      if (!winsSeenThemes.has(theme) && !winsSeenActions.has(action)) {
          winsSeenThemes.add(theme);
          winsSeenActions.add(action);
          quickWins.push(action);
      }
  }

  // Pass 2: Fill rest
  if (quickWins.length < 5) {
      for (const rec of startRecs) {
        if (quickWins.length >= 5) break;
        const action = rec.actions && rec.actions.length > 0 ? rec.actions[0] : rec.title;
        if (!winsSeenActions.has(action)) {
            winsSeenActions.add(action);
            quickWins.push(action);
        }
      }
  }

  // 6. Notes
  const notes = buildNotes(def, maturity);

  return {
    headline,
    executiveSummary,
    stageRationale: rationale,
    priorities,
    quickWins,
    notes
  };
}

// ---------------------------------------------------------------------------
// Standalone Executive Summary (no recommendations/maturity pipeline needed)
// ---------------------------------------------------------------------------

type MaturityLevelKey = 'leading' | 'advanced' | 'ready' | 'exploring' | 'beginner';

function getMaturityLevelKey(score: number, thresholds: Record<string, number>): MaturityLevelKey {
  if (score >= thresholds.leading) return 'leading';
  if (score >= thresholds.advanced) return 'advanced';
  if (score >= thresholds.ready) return 'ready';
  if (score >= thresholds.exploring) return 'exploring';
  return 'beginner';
}

/**
 * Generate a short executive summary from enhanced results.
 */
export function generateExecutiveSummary(results: EnhancedResultsModel, def: NarrativeDefinition): string {
  const { overall, dimensionComparisons, topTopics } = results;
  // const def = localSource.getNarrative(); // REMOVED
  const templates = def.executiveTemplates;
  const thresholds = def.maturityThresholds;

  // 1. Maturity statement
  const levelKey = getMaturityLevelKey(overall.currentAvg, thresholds);
  let maturityStatement = templates.maturityLevel[levelKey]
    .replace('{score}', overall.currentAvg.toFixed(1));

  // 2. Gap statement
  const largeGaps = dimensionComparisons.filter(d => Math.abs(d.gap) > 1.0);
  let gapStatement = '';
  
  if (largeGaps.length > 2) {
    gapStatement = templates.gapAnalysis.large
        .replace('{count}', largeGaps.length.toString())
        .replace('{pluralS}', 's')
        .replace('{dimensions}', largeGaps.slice(0, 3).map(d => d.name).join(', '))
        .replace('{verbS}', '');
  } else if (largeGaps.length > 0) {
      gapStatement = templates.gapAnalysis.moderate
        .replace('{count}', largeGaps.length.toString())
        .replace('{pluralS}', largeGaps.length > 1 ? 's' : '')
        .replace('{verbS}', largeGaps.length > 1 ? ' show' : ' shows');
  } else {
      gapStatement = templates.gapAnalysis.minimal;
  }

  // 3. Strengths
  const strengths = dimensionComparisons.filter(d => d.current >= 4.0);
  let strengthStatement = '';
  if (strengths.length > 1) {
    const list = strengths.slice(0, -1).map(s => s.name).join(', ');
    const last = strengths[strengths.length - 1].name;
    strengthStatement = templates.strengths.multiple
        .replace('{list}', list)
        .replace('{lastItem}', last);
  } else if (strengths.length === 1) {
    strengthStatement = templates.strengths.single
        .replace('{area}', strengths[0].name);
  }

  // 4. Priorities
  let priorityStatement = '';
  if (topTopics.length >= 3) {
      const topicList = topTopics.slice(0, 3).map(t => t.label).join(', ');
      priorityStatement = templates.priorities.high.replace('{topics}', topicList);
  } else {
      priorityStatement = templates.priorities.balanced;
  }

  return [maturityStatement, strengthStatement, gapStatement, priorityStatement]
    .filter(Boolean)
    .join(' ');
}


----------------------------------------------------------------
File: src\lib\narrative\validate.ts
----------------------------------------------------------------
import { z } from 'zod';

export const NarrativeDefinitionSchema = z.object({
  version: z.number(),
  themeMap: z.record(z.string(), z.string()),
  headlines: z.object({
    lowConfidencePrefix: z.string(),
    byStageId: z.record(z.string(), z.string()),
  }),
  executiveSummary: z.object({
    sentence1: z.string(),
    sentence2: z.string(),
    sentence3: z.string(),
  }),
  stageRationale: z.string().optional(),
  priorityWhyTemplate: z.string().optional(),
  notes: z.record(z.string(), z.string()),
  maturityThresholds: z.object({
    leading: z.number(),
    advanced: z.number(),
    ready: z.number(),
    exploring: z.number(),
  }),
  executiveTemplates: z.object({
    maturityLevel: z.record(z.string(), z.string()),
    gapAnalysis: z.object({
      large: z.string(),
      moderate: z.string(),
      minimal: z.string(),
    }),
    strengths: z.object({
      multiple: z.string(),
      single: z.string(),
    }),
    priorities: z.object({
      high: z.string(),
      balanced: z.string(),
    }),
  }),
});

export type NarrativeDefinition = z.infer<typeof NarrativeDefinitionSchema>;

export function validateNarrativeDefinition(data: unknown): NarrativeDefinition {
  return NarrativeDefinitionSchema.parse(data);
}


----------------------------------------------------------------
File: src\lib\recommendations\apiEngine.ts
----------------------------------------------------------------
import { RecommendationsDefinitionAPI, ResultsData } from '@/lib/api/types';
import { EnhancedRecommendation, RecommendationMetrics, RecommendationBubble } from './definition';
import { roundToStep } from '@/lib/scoring/number';

/**
 * Generate recommendations from API definition based on results
 */
export function generateRecommendationsFromAPI(
  results: ResultsData,
  definition: RecommendationsDefinitionAPI
): EnhancedRecommendation[] {
  const recommendations: EnhancedRecommendation[] = [];
  const meta = definition.meta || {};
  const weights = meta.dimensionWeights || {};
  const colors = meta.dimensionColors || {};

  // Iterate through each dimension in results
  results.dimensions.forEach((dimResult) => {
    // Find matching dimension in definition
    const dimDef = definition.dimensions.find(
      d => d.dimensionKey === dimResult.dimensionKey
    );

    if (!dimDef) return;

    // Check each recommendation rule
    dimDef.recommendations.forEach((rule) => {
      const conditions = rule.conditions;
      
      const gap = dimResult.gap;
      const current = dimResult.score;
      // Target is not explicitly in dimResult but target = score + gap
      const target = current + gap; 

      // Check gap condition
      const matchesGap = 
        (!conditions.gapMin || gap >= conditions.gapMin) &&
        (!conditions.gapMax || gap <= conditions.gapMax);

      // Check maturity condition
      const matchesMaturity = 
        (!conditions.maturityBelow || current < conditions.maturityBelow) &&
        (!conditions.maturityAbove || current > conditions.maturityAbove);

      if (matchesGap && matchesMaturity) {
        // Calculate Metrics
        const dimWeight = weights[dimResult.dimensionKey] ?? 0.5;
        const metrics = calculateMetrics(current, target, gap, dimWeight);
        
        // Determine category (mapped from legacy tags if possible, or metrics)
        // If rule has explicit category tag like 'Quick Win', use it. Otherwise use metrics.
        let category: EnhancedRecommendation['category'] = 'Project';
        if (rule.tags?.includes('Quick Win')) category = 'Quick Win';
        else if (rule.tags?.includes('Big Bet')) category = 'Big Bet';
        else category = determineCategory(metrics);

        // Use rule.priority from API, fallback to computed priority if not available
        const priority = rule.priority ?? computeRankingPriority(metrics);

        recommendations.push({
          id: rule.id,
          rank: 0, // Assigned later
          title: rule.title,
          description: rule.description,
          dimension: dimResult.dimensionKey,
          category,
          metrics,
          color: colors[dimResult.dimensionKey] || '#666666',
          topics: [], // API rules aren't strictly topic-bound in the same way, or we can use keys
          // Narrative fields
          why: rule.why,
          what: rule.what,
          how: rule.how,
          actions: rule.actionItems?.map(a => a.text) || [], 
          gap: gap,
          priority: priority, // Use rule.priority from API, or computed if not available
          tags: rule.tags || []
        });
      }
    });
  });

  // Sort by priority (highest first) and assign ranks
  return recommendations
    .sort((a, b) => (b.priority || 0) - (a.priority || 0))
    .map((rec, index) => ({
      ...rec,
      rank: index + 1
    }));
}

/**
 * Generate bubble data for visualization
 */
export function generateBubbleData(recommendations: EnhancedRecommendation[]): RecommendationBubble[] {
  return recommendations.slice(0, 12).map((rec, index) => ({
    id: rec.id,
    rank: rec.rank,
    x: rec.metrics.urgency,
    y: rec.metrics.importance,
    size: normalizeBubbleSize(rec.metrics.resourceNeed),
    color: rec.color,
    label: String(rec.rank)
  }));
}

// ---------------------------------------------------------------------------
// Metrics Helpers (Ported from engine.ts)
// ---------------------------------------------------------------------------

function clamp10(v: number): number {
  return Math.max(0, Math.min(10, v));
}

function round1(v: number): number {
  return roundToStep(v, 0.1);
}

function calculateMetrics(
    current: number, 
    target: number, 
    gap: number, 
    dimensionWeight: number
): RecommendationMetrics {
  const gapRatio = gap / 4; // max gap is 4 (5-1)

  // URGENCY: gap size (60%) + low current maturity (40%)
  const gapUrgency = gapRatio * 10;
  const maturityUrgency = ((5 - current) / 4) * 10;
  const urgency = clamp10(round1(gapUrgency * 0.6 + maturityUrgency * 0.4));

  // IMPORTANCE: target ambition × dimension weight
  const targetAmbition = (target / 5) * 10;
  const importance = clamp10(round1(targetAmbition * dimensionWeight));

  // COMPLEXITY: larger gaps from lower maturity = higher complexity
  let complexityBase: number;
  if (current < 2.0 && gap > 2.0) complexityBase = 0.9;
  else if (current < 3.0 && gap > 1.5) complexityBase = 0.7;
  else if (gap > 1.0) complexityBase = 0.5;
  else complexityBase = 0.3;
  const complexity = clamp10(round1(complexityBase * 10));

  // RESOURCE NEED: gap size + complexity
  const resourceNeed = clamp10(round1((gap * 0.5 + complexityBase * 0.5) * 2.5));

  // TIMEFRAME
  let timeframe: RecommendationMetrics['timeframe'];
  if (urgency > 8 && resourceNeed < 6) timeframe = 'immediate';
  else if (urgency > 6) timeframe = 'short';
  else if (resourceNeed > 7) timeframe = 'long';
  else timeframe = 'medium';

  return { urgency, importance, resourceNeed, complexity, timeframe };
}

function determineCategory(m: RecommendationMetrics): EnhancedRecommendation['category'] {
  if (m.importance > 8 && m.resourceNeed > 7) return 'Big Bet';
  if (m.urgency > 7 && m.resourceNeed < 5) return 'Quick Win';
  return 'Project';
}

function computeRankingPriority(m: RecommendationMetrics): number {
  return round1(m.urgency * 0.50 + m.importance * 0.30 + (10 - m.resourceNeed) * 0.20);
}

function normalizeBubbleSize(resourceNeed: number): number {
  const minSize = 30;
  const maxSize = 70;
  return Math.round(minSize + (resourceNeed / 10) * (maxSize - minSize));
}


----------------------------------------------------------------
File: src\lib\recommendations\definition.ts
----------------------------------------------------------------
// Legacy localSource removed.
// Use useReadinessStore to access recommendations definition from API.

// ---------------------------------------------------------------------------
// Enhanced Recommendation Types (Phase 7)
// ---------------------------------------------------------------------------

export type RecommendationMetrics = {
  urgency: number;        // 0-10: How urgent is this recommendation
  importance: number;     // 0-10: How important strategically
  resourceNeed: number;   // 0-10: How many resources needed
  complexity: number;     // 0-10: Implementation complexity
  timeframe: 'immediate' | 'short' | 'medium' | 'long';
};

export type EnhancedRecommendation = {
  id: string;
  rank: number;
  title: string;
  description: string;
  dimension: string;
  category: 'Quick Win' | 'Project' | 'Big Bet';
  metrics: RecommendationMetrics;
  link?: string;
  color: string;
  topics: string[];
  tags?: string[]; // Added for narrative generation (was topics)
  actions?: string[]; // Added for narrative generation
  gap?: number;      // Added for narrative generation
  priority?: number; // Added for narrative generation
  why?: string;
  what?: string;
  how?: string;
};

export type RecommendationBubble = {
  id: string;
  rank: number;
  x: number;          // Urgency (0-10)
  y: number;          // Importance (0-10)
  size: number;       // Resource need (px radius)
  color: string;      // Dimension color
  label: string;      // Rank number
};


----------------------------------------------------------------
File: src\lib\recommendations\validate.ts
----------------------------------------------------------------
import { z } from 'zod';

// Conditions schema: min/max constraints on current, target, or gap
const ConditionsSchema = z.object({
  gapMin: z.number().optional(),
  gapMax: z.number().optional(),
  currentMin: z.number().optional(),
  currentMax: z.number().optional(),
  targetMin: z.number().optional(),
  targetMax: z.number().optional(),
});

// Rule schema
export const RecommendationRuleSchema = z.object({
  id: z.string().min(1),
  dimensionId: z.string().min(1),
  topicId: z.string().min(1),
  priority: z.number().min(0).max(100),
  conditions: ConditionsSchema,
  title: z.string().min(1),
  summary: z.string().min(1),
  actions: z.array(z.string().min(1)),
  tags: z.array(z.string()).optional(),
  
  // v2 Fields
  appliesTo: z.enum(['topic', 'dimension', 'global']).default('topic').optional(),
  maxPerDimension: z.number().optional(),
  scoreWeights: z
    .object({
      priority: z.number().optional(),
      gap: z.number().optional(),
      lowCurrent: z.number().optional(),
      urgencyTag: z.number().optional(),
    })
    .optional(),
});

// Meta schema (v2)
// Meta schema (v2)
export const RecommendationsMetaSchema = z.object({
  themeMap: z.record(z.string(), z.string()).optional(),
  urgencyTags: z.array(z.string()).optional(),
  dimensionOrder: z.array(z.string()).optional(),
  dimensionWeights: z.record(z.string(), z.number()).optional(),
  dimensionColors: z.record(z.string(), z.string()).optional(),
  titleTemplates: z.record(z.string(), z.array(z.string())).optional(),
  descriptionTemplate: z.string().optional(),
});

// Full definition schema
export const RecommendationsDefinitionSchema = z.object({
  version: z.number(),
  rules: z.array(RecommendationRuleSchema),
  meta: RecommendationsMetaSchema.optional(),
});

export type RecommendationRule = z.infer<typeof RecommendationRuleSchema>;
export type RecommendationsDefinition = z.infer<typeof RecommendationsDefinitionSchema>;

export function validateRecommendationsDefinition(data: unknown): RecommendationsDefinition {
  return RecommendationsDefinitionSchema.parse(data);
}


----------------------------------------------------------------
File: src\lib\scoring\compute.ts
----------------------------------------------------------------
import { AssessmentDefinition, DimensionDefinition } from '../assessment/validate';
import { ReadinessState, TopicScore } from '../../store/readiness/types';
import { normalizeScore, normalizeGap, roundToStep, calculateGap } from './number';

export type DimensionScoreSummary = {
  currentAvg: number;
  targetAvg: number;
  gapAvg: number;
  answeredCount: number;
  totalCount: number;
  progress: number; // 0..100
  currentSum: number; // Added for weighted aggregation
  targetSum: number; // Added for weighted aggregation
};

export type OverallScoreSummary = {
  currentAvg: number;
  targetAvg: number;
  gapAvg: number;
  completedDimensions: number;
  totalDimensions: number;
  confidenceRatio: number;
};

export type DimensionResultModel = {
  id: string;
  title: string;
  currentAvg: number;
  targetAvg: number;
  gapAvg: number;
  answeredCount: number;
  totalCount: number;
  progress: number;
  isComplete: boolean;
};

export type TopGapModel = {
  dimensionId: string;
  dimensionTitle: string;
  topicId: string;
  topicLabel: string;
  current: number;
  target: number;
  gap: number;
};

export type ResultsModel = {
  overall: OverallScoreSummary;
  dimensions: DimensionResultModel[];
  topGaps: TopGapModel[];
};

/** Gap analysis comparison for a single dimension. */
export type DimensionComparison = {
  id: string;
  name: string;
  current: number;
  target: number;
  gap: number;
  gapPercentage: number;
  variance: number;
  trend: 'positive' | 'negative' | 'neutral';
};

/** A prioritized topic with risk assessment. */
export type TopTopic = {
  id: string;
  label: string;
  dimensionId: string;
  dimensionName: string;
  current: number;
  target: number;
  gap: number;
  priorityScore: number;
  riskLevel: 'high' | 'medium' | 'low';
  impactArea: string;
};

/** Extended results with gap analysis and prioritized topics. */
export type EnhancedResultsModel = ResultsModel & {
  dimensionComparisons: DimensionComparison[];
  topTopics: TopTopic[];
  overallGap: number;
  maturityTrend: 'improving' | 'stable' | 'declining';
};



export function computeDimensionSummary(
  definition: DimensionDefinition,
  dimensionScores: Record<string, TopicScore>,
  dimensionTouched: Record<string, boolean>
): DimensionScoreSummary {
  const topics = definition.topics;
  
  let currentSum = 0;
  let targetSum = 0;
  let answeredCount = 0;

  topics.forEach((topic) => {
    const isTouched = dimensionTouched[topic.id];
    
    if (isTouched) {
      // Only include score if touched
      const score = dimensionScores[topic.id];
      if (score) {
        // Defensive normalization
        currentSum += normalizeScore(score.current);
        targetSum += normalizeScore(score.target);
        answeredCount++;
      } else {
        // Missing score for touched topic: SKIP IT (Do not fallback to 1)
      }
    }
  });

  const totalCount = topics.length;

  // Prevent division by zero if nothing is answered
  if (answeredCount === 0) {
    return {
      currentAvg: 0,
      targetAvg: 0,
      gapAvg: 0,
      answeredCount: 0,
      totalCount,
      progress: 0,
      currentSum: 0,
      targetSum: 0,
    };
  }

  // Average is based on ANSWERED count, not total count
  const currentAvg = normalizeScore(currentSum / answeredCount);
  const targetAvg = normalizeScore(targetSum / answeredCount);
const gapAvg = calculateGap(targetAvg, currentAvg);
  
  const progress = totalCount > 0 ? Math.round((answeredCount / totalCount) * 100) : 0;

  return {
    currentAvg,
    targetAvg,
    gapAvg,
    answeredCount,
    totalCount,
    progress,
    currentSum,
    targetSum,
  };
}

export function computeOverallSummary(
  definition: AssessmentDefinition,
  scores: ReadinessState['scores'],
  touched: ReadinessState['touched'],
  completion: ReadinessState['completion']
): OverallScoreSummary {
  let totalCurrentSum = 0;
  let totalTargetSum = 0;
  let completedDimensions = 0;
  let totalAnsweredQuestions = 0;
  let totalQuestions = 0;

  const definitions = definition.dimensions;
  
  definitions.forEach((dim) => {
    const dimScores = scores[dim.id] || {};
    const dimTouched = touched[dim.id] || {};
    const summary = computeDimensionSummary(dim, dimScores, dimTouched);
    
    totalAnsweredQuestions += summary.answeredCount;
    totalQuestions += summary.totalCount;

    // Accumulate sums directly for weighted average
    totalCurrentSum += summary.currentSum;
    totalTargetSum += summary.targetSum;

    if (completion[dim.id]) {
      completedDimensions++;
    }
  });

  const totalDimensions = definitions.length;
  
  const confidenceRatio = totalQuestions > 0 
    ? Math.round((totalAnsweredQuestions / totalQuestions) * 100) / 100
    : 0;

  if (totalAnsweredQuestions === 0) {
    return {
      currentAvg: 0,
      targetAvg: 0,
      gapAvg: 0,
      completedDimensions,
      totalDimensions,
      confidenceRatio: 0,
    };
  }

  // Overall weighted average = Total Sum / Total Answered Questions
  const currentAvg = normalizeScore(totalCurrentSum / totalAnsweredQuestions);
  const targetAvg = normalizeScore(totalTargetSum / totalAnsweredQuestions);
const gapAvg = calculateGap(targetAvg, currentAvg);

  return {
    currentAvg,
    targetAvg,
    gapAvg,
    completedDimensions,
    totalDimensions,
    confidenceRatio,
  };
}

export function computeResultsModel(
  definition: AssessmentDefinition,
  scores: ReadinessState['scores'],
  touched: ReadinessState['touched'],
  completion: ReadinessState['completion']
): EnhancedResultsModel {
  const overall = computeOverallSummary(definition, scores, touched, completion);
  
  const dimensions: DimensionResultModel[] = [];
  const allGaps: TopGapModel[] = [];

  definition.dimensions.forEach((dim) => {
    const dimScores = scores[dim.id] || {};
    const dimTouched = touched[dim.id] || {};
    const summary = computeDimensionSummary(dim, dimScores, dimTouched);
    const isComplete = !!completion[dim.id];

    dimensions.push({
      id: dim.id,
      title: dim.title,
      currentAvg: summary.currentAvg,
      targetAvg: summary.targetAvg,
      gapAvg: summary.gapAvg,
      answeredCount: summary.answeredCount,
      totalCount: summary.totalCount,
      progress: summary.progress,
      isComplete,
    });

    // Collect gaps - ONLY for touched topics
    dim.topics.forEach(topic => {
      const isTouched = dimTouched[topic.id];
      if (isTouched) {
        const score = dimScores[topic.id];
        if (score) {
            const current = normalizeScore(score.current);
            const target = normalizeScore(score.target);
            const gap = calculateGap(target, current);
            if (gap > 0) {
                allGaps.push({
                dimensionId: dim.id,
                dimensionTitle: dim.title,
                topicId: topic.id,
                topicLabel: topic.label,
                current: current,
                target: target,
                gap: gap,
                });
            }
        }
      }
    });
  });

  // Sort gaps descending by gap size
  const topGaps = allGaps
    .sort((a, b) => b.gap - a.gap)
    .slice(0, 5);

  // Enhanced analytics
  const dimensionComparisons = computeDimensionComparisons(dimensions);
  const topTopics = computeTopTopics(definition, scores, touched);
  const overallGap = roundToStep(overall.targetAvg - overall.currentAvg, 0.1);

  return {
    overall,
    dimensions,
    topGaps,
    dimensionComparisons,
    topTopics,
    overallGap,
    maturityTrend: 'stable',
  };
}

export function getNextIncompleteDimensionId(
  definition: AssessmentDefinition,
  completion: ReadinessState['completion']
): string | null {
  const incompleteDim = definition.dimensions.find(d => !completion[d.id]);
  return incompleteDim ? incompleteDim.id : null;
}

// ---------------------------------------------------------------------------
// Enhanced Analytics
// ---------------------------------------------------------------------------

function calculateVariance(values: number[]): number {
  if (values.length === 0) return 0;
  const mean = values.reduce((a, b) => a + b, 0) / values.length;
  const sumSquares = values.reduce((sum, v) => sum + Math.pow(v - mean, 2), 0);
  return Math.sqrt(sumSquares / values.length);
}

function determineTrend(
  current: number,
  target: number,
  variance: number
): 'positive' | 'negative' | 'neutral' {
  const gap = target - current;
  if (gap > 0.5 && variance < 0.5) return 'positive';
  if (gap < -0.5 || variance > 1.0) return 'negative';
  return 'neutral';
}

/** Multi-factor priority: 40% gap size, 30% target importance, 30% current weakness. */
export function calculatePriorityScore(current: number, target: number, gap: number): number {
  // Gap is already clamped to >= 0 by calculateGap
  const gapWeight = gap * 0.40;
  const targetWeight = (target / 5) * 0.30;
  const currentWeight = ((5 - current) / 5) * 0.30;
  // Ensure non-negative priority
  return roundToStep(Math.max(0, gapWeight + targetWeight + currentWeight), 0.1);
}

function determineRiskLevel(current: number, gap: number): 'high' | 'medium' | 'low' {
  // Gap is clamped >= 0
  if (current <= 2.0 || gap >= 2.0) return 'high';
  if (current <= 3.5 || gap >= 1.0) return 'medium';
  return 'low';
}

/** Build dimension-level gap analysis from DimensionResultModel[]. */
export function computeDimensionComparisons(
  dimensions: DimensionResultModel[]
): DimensionComparison[] {
  return dimensions.map(dim => {
    const gap = calculateGap(dim.targetAvg, dim.currentAvg);
    const gapPercentage = roundToStep((Math.abs(gap) / 5) * 100, 0.1);
    // Variance across topic-level scores is approximated from the dimension averages
    // (we don't have per-topic scores here, so variance defaults to 0 — trend uses gap only)
    const variance = 0;
    return {
      id: dim.id,
      name: dim.title,
      current: dim.currentAvg,
      target: dim.targetAvg,
      gap,
      gapPercentage,
      variance,
      trend: determineTrend(dim.currentAvg, dim.targetAvg, variance),
    };
  }).sort((a, b) => b.gap - a.gap);
}

/** Rank all touched topics by multi-factor priority. */
export function computeTopTopics(
  definition: AssessmentDefinition,
  scores: ReadinessState['scores'],
  touched: ReadinessState['touched'],
  limit = 10
): TopTopic[] {
  const topics: TopTopic[] = [];

  definition.dimensions.forEach(dim => {
    const dimScores = scores[dim.id] || {};
    const dimTouched = touched[dim.id] || {};

    dim.topics.forEach(topic => {
      if (!dimTouched[topic.id]) return;
      const score = dimScores[topic.id];
      if (!score) return;

      const current = normalizeScore(score.current);
      const target = normalizeScore(score.target);
      const gap = calculateGap(target, current);
      const priorityScore = calculatePriorityScore(current, target, gap);

      topics.push({
        id: topic.id,
        label: topic.label,
        dimensionId: dim.id,
        dimensionName: dim.title,
        current,
        target,
        gap,
        priorityScore,
        riskLevel: determineRiskLevel(current, gap),
        impactArea: dim.title,
      });
    });
  });

  return topics
    .sort((a, b) => b.priorityScore - a.priorityScore)
    .slice(0, limit);
}


----------------------------------------------------------------
File: src\lib\scoring\number.ts
----------------------------------------------------------------

/**
 * Normalizes a number to the nearest step to avoid floating point artifacts.
 * Example: 1.50000002 -> 1.5
 */
export function roundToStep(value: number, step = 0.5): number {
  const inv = 1 / step;
  return Math.round(value * inv) / inv;
}

/**
 * Clamps a number between a minimum and maximum value.
 */
export function clamp(value: number, min: number, max: number): number {
  return Math.max(min, Math.min(max, value));
}

/**
 * Normalizes a score to be within the valid range (1..5) and step (0.5).
 */
export function normalizeScore(value: number): number {
  const v = roundToStep(value, 0.5);
  return clamp(v, 1, 5);
}

/**
 * Normalizes a gap to be within the valid range (0..4) and step (0.5).
 */
export function normalizeGap(value: number): number {
  const v = roundToStep(value, 0.5);
  return clamp(v, 0, 4); // 5-1=4 max gap
}

/**
 * Calculates the gap between target and current scores.
 * Clamps to 0 if current > target (negative gap).
 */
export function calculateGap(target: number, current: number): number {
  return normalizeGap(Math.max(0, target - current));
}

/**
 * Formats a score to always show 1 decimal place.
 * Example: 3.5, 4.0
 */
export function formatScore(value: number): string {
  return normalizeScore(value).toFixed(1);
}

/**
 * Formats a gap value to 1 decimal place.
 * Handles negative zero (-0.0) by converting it to 0.0.
 */
export function formatGap(value: number): string {
  const v = Math.round(value * 10) / 10;
  const clean = Object.is(v, -0) ? 0 : v;
  return clean.toFixed(1);
}


----------------------------------------------------------------
File: src\lib\storage\zustandStorage.ts
----------------------------------------------------------------
import { StateStorage } from 'zustand/middleware';

export const safeJSONStorage: StateStorage = {
  getItem: (name: string): string | null => {
    if (typeof window === 'undefined') {
      return null;
    }
    return localStorage.getItem(name);
  },
  setItem: (name: string, value: string): void => {
    if (typeof window !== 'undefined') {
      localStorage.setItem(name, value);
    }
  },
  removeItem: (name: string): void => {
    if (typeof window !== 'undefined') {
      localStorage.removeItem(name);
    }
  },
};


----------------------------------------------------------------
File: src\store\readiness\readiness.store.ts
----------------------------------------------------------------
/**
 * Updated Zustand Store with API Integration
 * 
 * Changes from original:
 * - Removed JSON imports
 * - Added API fetching actions
 * - Added loading/error states
 * - Added session management
 * - Added auto-save functionality
 */

import { create } from 'zustand';
import { persist, createJSONStorage } from 'zustand/middleware';
import { AssessmentAPI, ParticipantAPI, ResponseAPI } from '@/lib/api/endpoints';
import type { 
  AssessmentStructureResponse,
  ParticipantData,
  RecommendationsDefinitionAPI,
  NarrativeDefinitionAPI
} from '@/lib/api/types';

interface ReadinessState {
  // API State
  isLoading: boolean;
  isLoadingDefinitions: boolean;
  error: string | null;
  
  // Assessment Data (from API)
  assessment: AssessmentStructureResponse | null;
  recommendationsDefinition: RecommendationsDefinitionAPI | null;
  narrativeDefinition: NarrativeDefinitionAPI | null;
  
  // Participant & Session
  participantInfo: ParticipantData | null;
  participantId: string | null;
  responseId: string | null;
  sessionToken: string | null;
  
  // User Responses (local state)
  responses: Record<string, { current: number; target: number }>;
  
  // Progress
  currentDimensionIndex: number;
  progress: number;
  
  // Actions - API Calls
  loadAssessment: () => Promise<void>;
  loadDefinitions: () => Promise<void>;
  registerParticipant: (data: ParticipantData) => Promise<void>;
  startAssessment: () => Promise<void>;
  submitAnswer: (topicId: string, current: number, target: number) => Promise<void>;
  completeAssessment: () => Promise<void>;
  resumeSession: (token: string) => Promise<void>;
  isSubmitting: boolean;
  
  // Actions - Local State
  setResponse: (topicId: string, current: number, target: number) => void;
  nextDimension: () => void;
  previousDimension: () => void;
  clearAllData: () => void;
  
  // Error Handling
  setError: (error: string | null) => void;
  clearError: () => void;
}

export const useReadinessStore = create<ReadinessState>()(
  persist(
    (set, get) => ({
      // Initial State
      isLoading: false,
      isLoadingDefinitions: false,
      isSubmitting: false,
      error: null,
      assessment: null,
      recommendationsDefinition: null,
      narrativeDefinition: null,
      participantInfo: null,
      participantId: null,
      responseId: null,
      sessionToken: null,
      responses: {},
      currentDimensionIndex: 0,
      progress: 0,

      loadAssessment: async () => {
        set({ isLoading: true, error: null });
        try {
          // 1. Get active assessment
          const active = await AssessmentAPI.getActive();
          // 2. Get structure
          const structure = await AssessmentAPI.getStructure(active.id);
          // 3. Store in state
          set({ assessment: structure, isLoading: false });
          console.log('✅ Assessment loaded from API');
        } catch (error: any) {
          set({ error: error.message || 'Failed to load assessment', isLoading: false });
        }
      },

      loadDefinitions: async () => {
        // Skip if already loaded
        const { recommendationsDefinition, narrativeDefinition } = get();
        if (recommendationsDefinition && narrativeDefinition) {
          console.log('ℹ️ Definitions already loaded');
          return;
        }

        set({ isLoadingDefinitions: true, error: null });
        
        try {
          const [recDef, narDef] = await Promise.all([
            AssessmentAPI.getRecommendationsDefinition(),
            AssessmentAPI.getNarrativeDefinition()
          ]);
          
          set({
            recommendationsDefinition: recDef,
            narrativeDefinition: narDef,
            isLoadingDefinitions: false
          });
          
          console.log('✅ Definitions loaded from API');
          console.log(`   - ${recDef.dimensions.length} dimensions with recommendations`);
          console.log(`   - ${Object.keys(narDef.themeMap).length} narrative themes`);
          
        } catch (error: any) {
          console.error('❌ Failed to load definitions:', error);
          set({ 
            error: error.message || 'Failed to load definitions',
            isLoadingDefinitions: false 
          });
        }
      },

      registerParticipant: async (data: ParticipantData) => {
        set({ isLoading: true, error: null });
        try {
          const response = await ParticipantAPI.register(data);
          set({ 
            participantId: response.participantId, 
            participantInfo: data,
            isLoading: false 
          });
          console.log('✅ Participant registered:', response.participantId);
        } catch (error: any) {
          set({ error: error.message || 'Failed to register participant', isLoading: false });
          throw error; // Re-throw to allow component to handle validation errors if needed
        }
      },

      startAssessment: async () => {
         const { assessment, participantId } = get();
         if (!assessment || !assessment.assessment.id || !participantId) {
             set({ error: 'Missing assessment or participant data' });
             return;
         }

        set({ isLoading: true, error: null });
        try {
          const response = await ResponseAPI.start(assessment.assessment.id, participantId);
          set({ 
            responseId: response.responseId, 
            sessionToken: response.sessionToken,
            isLoading: false 
          });
          
          if (typeof window !== 'undefined') {
              localStorage.setItem('sessionToken', response.sessionToken);
          }
          console.log('✅ Assessment started:', response.responseId);
        } catch (error: any) {
          set({ error: error.message || 'Failed to start assessment', isLoading: false });
          throw error;
        }
      },

      // Simplified submitAnswer - just saves, no debouncing (debouncing moved to component)
      submitAnswer: async (topicId: string, current: number, target: number) => {
        const { responseId } = get();
        if (!responseId) {
             console.error('No active response session');
             return;
        }

        // Round to nearest 0.5 before sending to API
        // This ensures values are always valid: 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0
        const roundedCurrent = Math.round(current * 2) / 2;
        const roundedTarget = Math.round(target * 2) / 2;

        // Optimistic update (use rounded values)
        set((state) => ({
            responses: {
                ...state.responses,
                [topicId]: { current: roundedCurrent, target: roundedTarget }
            }
        }));

        set({ isSubmitting: true });

        try {
            const response = await ResponseAPI.submitAnswer(responseId, {
                topicId,
                currentRating: roundedCurrent,
                targetRating: roundedTarget
            });
            
            set({ progress: response.progress, isSubmitting: false });
        } catch (error: any) {
            console.error('Failed to submit answer:', error);
            set({ isSubmitting: false });
        }
      },

      completeAssessment: async () => {
        const { responseId } = get();
        if (!responseId) return;

        set({ isLoading: true, error: null });
        try {
          await ResponseAPI.complete(responseId);
          set({ isLoading: false });
          console.log('✅ Assessment completed');
        } catch (error: any) {
          set({ error: error.message || 'Failed to complete assessment', isLoading: false });
          throw error;
        }
      },

      resumeSession: async (token: string) => {
        set({ isLoading: true, error: null });
        try {
          const session = await ResponseAPI.getSession(token);
          
          // Reconstruct local responses from session data
          const responses: Record<string, { current: number; target: number }> = {};
          session.answeredTopics.forEach(t => {
              responses[t.topicId] = {
                  current: t.currentRating,
                  target: t.targetRating
              };
          });

          set({ 
            responseId: session.responseId,
            sessionToken: token,
            progress: session.progress,
            responses,
            isLoading: false 
          });
          
          // If we don't have assessment loaded, we should load it
           const { assessment } = get();
           if (!assessment) {
               await get().loadAssessment();
           }

        } catch (error: any) {
          set({ error: error.message || 'Failed to resume session', isLoading: false });
          // safeJSONStorage handles window check internally if implemented well, 
          // or we can wrap it. But since we use persist, better to use the storage engine.
          // However, manual removal:
          if (typeof window !== 'undefined') localStorage.removeItem('sessionToken'); 
        }
      },

      // Local state management
      setResponse: (topicId, current, target) => {
        set((state) => ({
          responses: {
            ...state.responses,
            [topicId]: { current, target }
          }
        }));
      },

      nextDimension: () => {
        set((state) => ({
          currentDimensionIndex: Math.min(
            state.currentDimensionIndex + 1,
            (state.assessment?.dimensions.length || 1) - 1
          )
        }));
      },

      previousDimension: () => {
        set((state) => ({
          currentDimensionIndex: Math.max(state.currentDimensionIndex - 1, 0)
        }));
      },

      clearAllData: () => {
        if (typeof window !== 'undefined') {
             localStorage.removeItem('sessionToken');
             localStorage.removeItem('readiness-storage'); // Also clear persisted store
        }
        set({
          assessment: null,
          recommendationsDefinition: null,
          narrativeDefinition: null,
          participantInfo: null,
          participantId: null,
          responseId: null,
          sessionToken: null,
          responses: {},
          currentDimensionIndex: 0,
          progress: 0,
          error: null
        });
        console.log('🗑️ All data cleared');
      },

      setError: (error) => set({ error, isLoading: false }),
      clearError: () => set({ error: null }),
    }),
    {
      name: 'readiness-storage',
      partialize: (state) => ({
        // Only persist essential data
        participantInfo: state.participantInfo,
        participantId: state.participantId,
        responseId: state.responseId,
        sessionToken: state.sessionToken,
        responses: state.responses,
        currentDimensionIndex: state.currentDimensionIndex,
        // Persist definitions nicely so we don't refetch every reload if not needed?
        // Actually, let's NOT persist definitions to ensure freshness, or persist them.
        // User request didn't specify, but persisting reduces network load.
        // I will persist them for now as it's static configuration data.
        recommendationsDefinition: state.recommendationsDefinition,
        narrativeDefinition: state.narrativeDefinition,
      }),
    }
  )
);


----------------------------------------------------------------
File: src\store\readiness\types.ts
----------------------------------------------------------------
export type DimensionSlug = string;
export type TopicId = string;

export type ScoreValue = 1 | 1.5 | 2 | 2.5 | 3 | 3.5 | 4 | 4.5 | 5;

export interface TopicScore {
  current: ScoreValue;
  target: ScoreValue;
}

export interface ReadinessState {
  scores: Record<DimensionSlug, Record<TopicId, TopicScore>>;
  touched: Record<DimensionSlug, Record<TopicId, boolean>>;
  completion: Record<DimensionSlug, boolean>;
  
  setScore: (payload: {
    dimensionId: DimensionSlug;
    topicId: TopicId;
    field: 'current' | 'target';
    value: number; // Relaxed from ScoreValue to allow raw input, coerced internally
  }) => void;
  
  markDimensionComplete: (dimensionId: DimensionSlug, done: boolean) => void;
  
  initDimensionIfNeeded: (payload: {
    dimensionId: string;
    topicIds: string[];
    defaults?: Partial<TopicScore>;
  }) => void;
  
  resetAll: () => void;
  resetAndClearStorage: () => void;
}


----------------------------------------------------------------
File: src\types\assessment.ts
----------------------------------------------------------------
export type {
  AssessmentDefinition,
  DimensionDefinition,
  TopicDefinition
} from '../lib/assessment/validate';


----------------------------------------------------------------
File: tailwind.config.js
----------------------------------------------------------------
module.exports = {
  content: [
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        horvath: {
          base: '#F9FAFB',
          surface: '#FFFFFF',
          primary: '#348AC7',
          dark: '#1A4563',
          slate: '#64748B',
        },
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        border: 'hsl(var(--border))',
        card: 'hsl(var(--card))',
        'card-foreground': 'hsl(var(--card-foreground))',
        popover: 'hsl(var(--popover))',
        'popover-foreground': 'hsl(var(--popover-foreground))',
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))',
        },
        muted: {
          DEFAULT: 'hsl(var(--muted))',
          foreground: 'hsl(var(--muted-foreground))',
        },
        accent: {
          DEFAULT: 'hsl(var(--accent))',
          foreground: 'hsl(var(--accent-foreground))',
        },
        destructive: {
          DEFAULT: 'hsl(var(--destructive))',
          foreground: 'hsl(var(--destructive-foreground))',
        },
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
      },
      borderRadius: {
        'xl': '1rem',
        '2xl': '1.5rem',
        'pill': '100px',
      },
      boxShadow: {
        'sm': '0 1px 2px 0 rgba(0, 0, 0, 0.05)',
        'md': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
        'swiss': '0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.02)',
        'glow': '0 25px 80px rgba(26, 69, 99, 0.2), 0 0 60px rgba(26, 69, 99, 0.1)',
      },
      fontFamily: {
        sans: ['Arial', 'Helvetica', 'sans-serif'],
      },
      backgroundImage: {
        'swiss-gradient': 'linear-gradient(to bottom, #F9FAFB, #F3F4F6)',
      }
    },
  },
  plugins: [],
}


----------------------------------------------------------------
File: tsconfig.json
----------------------------------------------------------------
{
  "compilerOptions": {
    "target": "es5",
    "lib": [
      "dom",
      "dom.iterable",
      "esnext"
    ],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "react-jsx",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": [
        "./src/*"
      ]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".next/dev/types/**/*.ts"
  ],
  "exclude": [
    "node_modules",
    "new",
    "DimensionContent-FINAL.tsx",
    "TopicCard-FINAL.tsx",
    "layout-FINAL.tsx",
    "DimensionContent-ULTRA-CLEAN.tsx",
    "TopicCard-ULTRA-CLEAN.tsx",
    "DimensionContent-PROFESSIONAL-FINAL.tsx",
    "TopicCard-PROFESSIONAL-FINAL.tsx",
    "*-REFERENCE-MATCH.tsx"
  ]
}


----------------------------------------------------------------
File: tsconfig.tsbuildinfo
----------------------------------------------------------------
{"fileNames":["./node_modules/typescript/lib/lib.es5.d.ts","./node_modules/typescript/lib/lib.es2015.d.ts","./node_modules/typescript/lib/lib.es2016.d.ts","./node_modules/typescript/lib/lib.es2017.d.ts","./node_modules/typescript/lib/lib.es2018.d.ts","./node_modules/typescript/lib/lib.es2019.d.ts","./node_modules/typescript/lib/lib.es2020.d.ts","./node_modules/typescript/lib/lib.es2021.d.ts","./node_modules/typescript/lib/lib.es2022.d.ts","./node_modules/typescript/lib/lib.es2023.d.ts","./node_modules/typescript/lib/lib.es2024.d.ts","./node_modules/typescript/lib/lib.esnext.d.ts","./node_modules/typescript/lib/lib.dom.d.ts","./node_modules/typescript/lib/lib.dom.iterable.d.ts","./node_modules/typescript/lib/lib.es2015.core.d.ts","./node_modules/typescript/lib/lib.es2015.collection.d.ts","./node_modules/typescript/lib/lib.es2015.generator.d.ts","./node_modules/typescript/lib/lib.es2015.iterable.d.ts","./node_modules/typescript/lib/lib.es2015.promise.d.ts","./node_modules/typescript/lib/lib.es2015.proxy.d.ts","./node_modules/typescript/lib/lib.es2015.reflect.d.ts","./node_modules/typescript/lib/lib.es2015.symbol.d.ts","./node_modules/typescript/lib/lib.es2015.symbol.wellknown.d.ts","./node_modules/typescript/lib/lib.es2016.array.include.d.ts","./node_modules/typescript/lib/lib.es2016.intl.d.ts","./node_modules/typescript/lib/lib.es2017.arraybuffer.d.ts","./node_modules/typescript/lib/lib.es2017.date.d.ts","./node_modules/typescript/lib/lib.es2017.object.d.ts","./node_modules/typescript/lib/lib.es2017.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2017.string.d.ts","./node_modules/typescript/lib/lib.es2017.intl.d.ts","./node_modules/typescript/lib/lib.es2017.typedarrays.d.ts","./node_modules/typescript/lib/lib.es2018.asyncgenerator.d.ts","./node_modules/typescript/lib/lib.es2018.asynciterable.d.ts","./node_modules/typescript/lib/lib.es2018.intl.d.ts","./node_modules/typescript/lib/lib.es2018.promise.d.ts","./node_modules/typescript/lib/lib.es2018.regexp.d.ts","./node_modules/typescript/lib/lib.es2019.array.d.ts","./node_modules/typescript/lib/lib.es2019.object.d.ts","./node_modules/typescript/lib/lib.es2019.string.d.ts","./node_modules/typescript/lib/lib.es2019.symbol.d.ts","./node_modules/typescript/lib/lib.es2019.intl.d.ts","./node_modules/typescript/lib/lib.es2020.bigint.d.ts","./node_modules/typescript/lib/lib.es2020.date.d.ts","./node_modules/typescript/lib/lib.es2020.promise.d.ts","./node_modules/typescript/lib/lib.es2020.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2020.string.d.ts","./node_modules/typescript/lib/lib.es2020.symbol.wellknown.d.ts","./node_modules/typescript/lib/lib.es2020.intl.d.ts","./node_modules/typescript/lib/lib.es2020.number.d.ts","./node_modules/typescript/lib/lib.es2021.promise.d.ts","./node_modules/typescript/lib/lib.es2021.string.d.ts","./node_modules/typescript/lib/lib.es2021.weakref.d.ts","./node_modules/typescript/lib/lib.es2021.intl.d.ts","./node_modules/typescript/lib/lib.es2022.array.d.ts","./node_modules/typescript/lib/lib.es2022.error.d.ts","./node_modules/typescript/lib/lib.es2022.intl.d.ts","./node_modules/typescript/lib/lib.es2022.object.d.ts","./node_modules/typescript/lib/lib.es2022.string.d.ts","./node_modules/typescript/lib/lib.es2022.regexp.d.ts","./node_modules/typescript/lib/lib.es2023.array.d.ts","./node_modules/typescript/lib/lib.es2023.collection.d.ts","./node_modules/typescript/lib/lib.es2023.intl.d.ts","./node_modules/typescript/lib/lib.es2024.arraybuffer.d.ts","./node_modules/typescript/lib/lib.es2024.collection.d.ts","./node_modules/typescript/lib/lib.es2024.object.d.ts","./node_modules/typescript/lib/lib.es2024.promise.d.ts","./node_modules/typescript/lib/lib.es2024.regexp.d.ts","./node_modules/typescript/lib/lib.es2024.sharedmemory.d.ts","./node_modules/typescript/lib/lib.es2024.string.d.ts","./node_modules/typescript/lib/lib.esnext.array.d.ts","./node_modules/typescript/lib/lib.esnext.collection.d.ts","./node_modules/typescript/lib/lib.esnext.intl.d.ts","./node_modules/typescript/lib/lib.esnext.disposable.d.ts","./node_modules/typescript/lib/lib.esnext.promise.d.ts","./node_modules/typescript/lib/lib.esnext.decorators.d.ts","./node_modules/typescript/lib/lib.esnext.iterator.d.ts","./node_modules/typescript/lib/lib.esnext.float16.d.ts","./node_modules/typescript/lib/lib.esnext.error.d.ts","./node_modules/typescript/lib/lib.esnext.sharedmemory.d.ts","./node_modules/typescript/lib/lib.decorators.d.ts","./node_modules/typescript/lib/lib.decorators.legacy.d.ts","./node_modules/@types/react/global.d.ts","./node_modules/csstype/index.d.ts","./node_modules/@types/react/index.d.ts","./node_modules/next/dist/styled-jsx/types/css.d.ts","./node_modules/next/dist/styled-jsx/types/macro.d.ts","./node_modules/next/dist/styled-jsx/types/style.d.ts","./node_modules/next/dist/styled-jsx/types/global.d.ts","./node_modules/next/dist/styled-jsx/types/index.d.ts","./node_modules/next/dist/server/get-page-files.d.ts","./node_modules/@types/node/compatibility/iterators.d.ts","./node_modules/@types/node/globals.typedarray.d.ts","./node_modules/@types/node/buffer.buffer.d.ts","./node_modules/@types/node/globals.d.ts","./node_modules/@types/node/web-globals/abortcontroller.d.ts","./node_modules/@types/node/web-globals/blob.d.ts","./node_modules/@types/node/web-globals/console.d.ts","./node_modules/@types/node/web-globals/crypto.d.ts","./node_modules/@types/node/web-globals/domexception.d.ts","./node_modules/@types/node/web-globals/encoding.d.ts","./node_modules/@types/node/web-globals/events.d.ts","./node_modules/buffer/index.d.ts","./node_modules/undici-types/utility.d.ts","./node_modules/undici-types/header.d.ts","./node_modules/undici-types/readable.d.ts","./node_modules/undici-types/fetch.d.ts","./node_modules/undici-types/formdata.d.ts","./node_modules/undici-types/connector.d.ts","./node_modules/undici-types/client-stats.d.ts","./node_modules/undici-types/client.d.ts","./node_modules/undici-types/errors.d.ts","./node_modules/undici-types/dispatcher.d.ts","./node_modules/undici-types/global-dispatcher.d.ts","./node_modules/undici-types/global-origin.d.ts","./node_modules/undici-types/pool-stats.d.ts","./node_modules/undici-types/pool.d.ts","./node_modules/undici-types/handlers.d.ts","./node_modules/undici-types/balanced-pool.d.ts","./node_modules/undici-types/h2c-client.d.ts","./node_modules/undici-types/agent.d.ts","./node_modules/undici-types/mock-interceptor.d.ts","./node_modules/undici-types/mock-call-history.d.ts","./node_modules/undici-types/mock-agent.d.ts","./node_modules/undici-types/mock-client.d.ts","./node_modules/undici-types/mock-pool.d.ts","./node_modules/undici-types/snapshot-agent.d.ts","./node_modules/undici-types/mock-errors.d.ts","./node_modules/undici-types/proxy-agent.d.ts","./node_modules/undici-types/env-http-proxy-agent.d.ts","./node_modules/undici-types/retry-handler.d.ts","./node_modules/undici-types/retry-agent.d.ts","./node_modules/undici-types/api.d.ts","./node_modules/undici-types/cache-interceptor.d.ts","./node_modules/undici-types/interceptors.d.ts","./node_modules/undici-types/util.d.ts","./node_modules/undici-types/cookies.d.ts","./node_modules/undici-types/patch.d.ts","./node_modules/undici-types/websocket.d.ts","./node_modules/undici-types/eventsource.d.ts","./node_modules/undici-types/diagnostics-channel.d.ts","./node_modules/undici-types/content-type.d.ts","./node_modules/undici-types/cache.d.ts","./node_modules/undici-types/index.d.ts","./node_modules/@types/node/web-globals/fetch.d.ts","./node_modules/@types/node/web-globals/importmeta.d.ts","./node_modules/@types/node/web-globals/messaging.d.ts","./node_modules/@types/node/web-globals/navigator.d.ts","./node_modules/@types/node/web-globals/performance.d.ts","./node_modules/@types/node/web-globals/storage.d.ts","./node_modules/@types/node/web-globals/streams.d.ts","./node_modules/@types/node/web-globals/timers.d.ts","./node_modules/@types/node/web-globals/url.d.ts","./node_modules/@types/node/assert.d.ts","./node_modules/@types/node/assert/strict.d.ts","./node_modules/@types/node/async_hooks.d.ts","./node_modules/@types/node/buffer.d.ts","./node_modules/@types/node/child_process.d.ts","./node_modules/@types/node/cluster.d.ts","./node_modules/@types/node/console.d.ts","./node_modules/@types/node/constants.d.ts","./node_modules/@types/node/crypto.d.ts","./node_modules/@types/node/dgram.d.ts","./node_modules/@types/node/diagnostics_channel.d.ts","./node_modules/@types/node/dns.d.ts","./node_modules/@types/node/dns/promises.d.ts","./node_modules/@types/node/domain.d.ts","./node_modules/@types/node/events.d.ts","./node_modules/@types/node/fs.d.ts","./node_modules/@types/node/fs/promises.d.ts","./node_modules/@types/node/http.d.ts","./node_modules/@types/node/http2.d.ts","./node_modules/@types/node/https.d.ts","./node_modules/@types/node/inspector.d.ts","./node_modules/@types/node/inspector.generated.d.ts","./node_modules/@types/node/inspector/promises.d.ts","./node_modules/@types/node/module.d.ts","./node_modules/@types/node/net.d.ts","./node_modules/@types/node/os.d.ts","./node_modules/@types/node/path.d.ts","./node_modules/@types/node/path/posix.d.ts","./node_modules/@types/node/path/win32.d.ts","./node_modules/@types/node/perf_hooks.d.ts","./node_modules/@types/node/process.d.ts","./node_modules/@types/node/punycode.d.ts","./node_modules/@types/node/querystring.d.ts","./node_modules/@types/node/quic.d.ts","./node_modules/@types/node/readline.d.ts","./node_modules/@types/node/readline/promises.d.ts","./node_modules/@types/node/repl.d.ts","./node_modules/@types/node/sea.d.ts","./node_modules/@types/node/sqlite.d.ts","./node_modules/@types/node/stream.d.ts","./node_modules/@types/node/stream/consumers.d.ts","./node_modules/@types/node/stream/promises.d.ts","./node_modules/@types/node/stream/web.d.ts","./node_modules/@types/node/string_decoder.d.ts","./node_modules/@types/node/test.d.ts","./node_modules/@types/node/test/reporters.d.ts","./node_modules/@types/node/timers.d.ts","./node_modules/@types/node/timers/promises.d.ts","./node_modules/@types/node/tls.d.ts","./node_modules/@types/node/trace_events.d.ts","./node_modules/@types/node/tty.d.ts","./node_modules/@types/node/url.d.ts","./node_modules/@types/node/util.d.ts","./node_modules/@types/node/util/types.d.ts","./node_modules/@types/node/v8.d.ts","./node_modules/@types/node/vm.d.ts","./node_modules/@types/node/wasi.d.ts","./node_modules/@types/node/worker_threads.d.ts","./node_modules/@types/node/zlib.d.ts","./node_modules/@types/node/index.d.ts","./node_modules/@types/react/canary.d.ts","./node_modules/@types/react/experimental.d.ts","./node_modules/next/dist/lib/fallback.d.ts","./node_modules/next/dist/compiled/webpack/webpack.d.ts","./node_modules/next/dist/shared/lib/modern-browserslist-target.d.ts","./node_modules/next/dist/shared/lib/entry-constants.d.ts","./node_modules/next/dist/shared/lib/constants.d.ts","./node_modules/next/dist/server/config.d.ts","./node_modules/next/dist/lib/load-custom-routes.d.ts","./node_modules/next/dist/shared/lib/image-config.d.ts","./node_modules/next/dist/build/webpack/plugins/subresource-integrity-plugin.d.ts","./node_modules/next/dist/server/body-streams.d.ts","./node_modules/next/dist/server/lib/cache-control.d.ts","./node_modules/next/dist/lib/setup-exception-listeners.d.ts","./node_modules/next/dist/lib/worker.d.ts","./node_modules/next/dist/lib/constants.d.ts","./node_modules/next/dist/lib/bundler.d.ts","./node_modules/next/dist/server/lib/experimental/ppr.d.ts","./node_modules/next/dist/lib/page-types.d.ts","./node_modules/next/dist/build/segment-config/app/app-segment-config.d.ts","./node_modules/next/dist/build/segment-config/pages/pages-segment-config.d.ts","./node_modules/next/dist/build/analysis/get-page-static-info.d.ts","./node_modules/next/dist/build/webpack/loaders/get-module-build-info.d.ts","./node_modules/next/dist/build/webpack/plugins/middleware-plugin.d.ts","./node_modules/next/dist/server/require-hook.d.ts","./node_modules/next/dist/server/node-polyfill-crypto.d.ts","./node_modules/next/dist/server/node-environment-baseline.d.ts","./node_modules/next/dist/server/node-environment-extensions/error-inspect.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-file.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-exit.d.ts","./node_modules/next/dist/server/node-environment-extensions/console-dim.external.d.ts","./node_modules/next/dist/server/node-environment-extensions/unhandled-rejection.d.ts","./node_modules/next/dist/server/node-environment-extensions/random.d.ts","./node_modules/next/dist/server/node-environment-extensions/date.d.ts","./node_modules/next/dist/server/node-environment-extensions/web-crypto.d.ts","./node_modules/next/dist/server/node-environment-extensions/node-crypto.d.ts","./node_modules/next/dist/server/node-environment-extensions/fast-set-immediate.external.d.ts","./node_modules/next/dist/server/node-environment.d.ts","./node_modules/next/dist/build/page-extensions-type.d.ts","./node_modules/next/dist/server/route-kind.d.ts","./node_modules/next/dist/server/route-definitions/route-definition.d.ts","./node_modules/next/dist/server/route-definitions/app-page-route-definition.d.ts","./node_modules/next/dist/server/lib/cache-handlers/types.d.ts","./node_modules/next/dist/server/response-cache/types.d.ts","./node_modules/next/dist/server/resume-data-cache/cache-store.d.ts","./node_modules/next/dist/server/resume-data-cache/resume-data-cache.d.ts","./node_modules/next/dist/client/components/app-router-headers.d.ts","./node_modules/next/dist/server/render-result.d.ts","./node_modules/next/dist/server/instrumentation/types.d.ts","./node_modules/next/dist/lib/coalesced-function.d.ts","./node_modules/next/dist/shared/lib/router/utils/middleware-route-matcher.d.ts","./node_modules/next/dist/server/lib/router-utils/types.d.ts","./node_modules/next/dist/trace/types.d.ts","./node_modules/next/dist/trace/trace.d.ts","./node_modules/next/dist/trace/shared.d.ts","./node_modules/next/dist/trace/index.d.ts","./node_modules/next/dist/build/load-jsconfig.d.ts","./node_modules/@next/env/dist/index.d.ts","./node_modules/next/dist/build/webpack/plugins/telemetry-plugin/use-cache-tracker-utils.d.ts","./node_modules/next/dist/build/webpack/plugins/telemetry-plugin/telemetry-plugin.d.ts","./node_modules/next/dist/telemetry/storage.d.ts","./node_modules/next/dist/build/build-context.d.ts","./node_modules/next/dist/shared/lib/bloom-filter.d.ts","./node_modules/next/dist/build/webpack-config.d.ts","./node_modules/next/dist/build/swc/generated-native.d.ts","./node_modules/next/dist/build/swc/types.d.ts","./node_modules/next/dist/server/dev/parse-version-info.d.ts","./node_modules/next/dist/next-devtools/shared/types.d.ts","./node_modules/next/dist/server/dev/dev-indicator-server-state.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/cache-indicator.d.ts","./node_modules/next/dist/server/lib/parse-stack.d.ts","./node_modules/next/dist/next-devtools/server/shared.d.ts","./node_modules/next/dist/next-devtools/shared/stack-frame.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/utils/get-error-by-type.d.ts","./node_modules/@types/react/jsx-runtime.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/container/runtime-error/render-error.d.ts","./node_modules/next/dist/next-devtools/dev-overlay/shared.d.ts","./node_modules/next/dist/server/dev/debug-channel.d.ts","./node_modules/next/dist/server/dev/hot-reloader-types.d.ts","./node_modules/next/dist/server/lib/i18n-provider.d.ts","./node_modules/next/dist/server/web/next-url.d.ts","./node_modules/next/dist/compiled/@edge-runtime/cookies/index.d.ts","./node_modules/next/dist/server/web/spec-extension/cookies.d.ts","./node_modules/next/dist/server/web/spec-extension/request.d.ts","./node_modules/next/dist/server/after/builtin-request-context.d.ts","./node_modules/next/dist/server/web/spec-extension/fetch-event.d.ts","./node_modules/next/dist/server/web/spec-extension/response.d.ts","./node_modules/next/dist/build/segment-config/middleware/middleware-config.d.ts","./node_modules/next/dist/server/web/types.d.ts","./node_modules/next/dist/build/webpack/plugins/pages-manifest-plugin.d.ts","./node_modules/next/dist/shared/lib/router/utils/parse-url.d.ts","./node_modules/next/dist/server/route-definitions/locale-route-definition.d.ts","./node_modules/next/dist/server/route-definitions/pages-route-definition.d.ts","./node_modules/next/dist/build/webpack/plugins/flight-manifest-plugin.d.ts","./node_modules/next/dist/build/webpack/plugins/next-font-manifest-plugin.d.ts","./node_modules/next/dist/shared/lib/deep-readonly.d.ts","./node_modules/next/dist/next-devtools/userspace/pages/pages-dev-overlay-setup.d.ts","./node_modules/next/dist/server/render.d.ts","./node_modules/next/dist/shared/lib/mitt.d.ts","./node_modules/next/dist/client/with-router.d.ts","./node_modules/next/dist/client/router.d.ts","./node_modules/next/dist/client/route-loader.d.ts","./node_modules/next/dist/client/page-loader.d.ts","./node_modules/next/dist/shared/lib/router/router.d.ts","./node_modules/next/dist/shared/lib/router-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/loadable-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/loadable.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/image-config-context.shared-runtime.d.ts","./node_modules/next/dist/client/components/readonly-url-search-params.d.ts","./node_modules/next/dist/shared/lib/hooks-client-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/head-manager-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/app-router-types.d.ts","./node_modules/next/dist/client/flight-data-helpers.d.ts","./node_modules/next/dist/client/components/router-reducer/ppr-navigations.d.ts","./node_modules/next/dist/client/components/segment-cache/types.d.ts","./node_modules/next/dist/client/components/segment-cache/navigation.d.ts","./node_modules/next/dist/client/components/segment-cache/cache-key.d.ts","./node_modules/next/dist/client/components/router-reducer/fetch-server-response.d.ts","./node_modules/next/dist/client/components/router-reducer/router-reducer-types.d.ts","./node_modules/next/dist/shared/lib/app-router-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/server-inserted-html.shared-runtime.d.ts","./node_modules/next/dist/server/route-modules/pages/vendored/contexts/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/pages/module.compiled.d.ts","./node_modules/next/dist/build/templates/pages.d.ts","./node_modules/next/dist/server/route-modules/pages/module.d.ts","./node_modules/next/dist/server/route-modules/pages/builtin/_error.d.ts","./node_modules/next/dist/server/load-default-error-components.d.ts","./node_modules/next/dist/server/base-http/node.d.ts","./node_modules/next/dist/server/response-cache/index.d.ts","./node_modules/next/dist/server/route-definitions/pages-api-route-definition.d.ts","./node_modules/next/dist/server/route-matches/pages-api-route-match.d.ts","./node_modules/next/dist/server/route-matchers/route-matcher.d.ts","./node_modules/next/dist/server/route-matcher-providers/route-matcher-provider.d.ts","./node_modules/next/dist/server/route-matcher-managers/route-matcher-manager.d.ts","./node_modules/next/dist/server/normalizers/normalizer.d.ts","./node_modules/next/dist/server/normalizers/locale-route-normalizer.d.ts","./node_modules/next/dist/server/normalizers/request/pathname-normalizer.d.ts","./node_modules/next/dist/server/normalizers/request/suffix.d.ts","./node_modules/next/dist/server/normalizers/request/rsc.d.ts","./node_modules/next/dist/server/normalizers/request/next-data.d.ts","./node_modules/next/dist/server/normalizers/request/segment-prefix-rsc.d.ts","./node_modules/next/dist/build/static-paths/types.d.ts","./node_modules/next/dist/server/base-server.d.ts","./node_modules/next/dist/server/lib/async-callback-set.d.ts","./node_modules/next/dist/shared/lib/router/utils/route-regex.d.ts","./node_modules/next/dist/shared/lib/router/utils/route-matcher.d.ts","./node_modules/sharp/lib/index.d.ts","./node_modules/next/dist/server/image-optimizer.d.ts","./node_modules/next/dist/server/next-server.d.ts","./node_modules/next/dist/server/lib/types.d.ts","./node_modules/next/dist/server/lib/lru-cache.d.ts","./node_modules/next/dist/server/lib/dev-bundler-service.d.ts","./node_modules/next/dist/server/use-cache/cache-life.d.ts","./node_modules/next/dist/server/dev/static-paths-worker.d.ts","./node_modules/next/dist/server/dev/next-dev-server.d.ts","./node_modules/next/dist/server/next.d.ts","./node_modules/next/dist/server/lib/render-server.d.ts","./node_modules/next/dist/server/lib/router-server.d.ts","./node_modules/next/dist/shared/lib/router/utils/path-match.d.ts","./node_modules/next/dist/server/lib/router-utils/filesystem.d.ts","./node_modules/next/dist/server/lib/router-utils/setup-dev-bundler.d.ts","./node_modules/next/dist/server/lib/router-utils/router-server-context.d.ts","./node_modules/next/dist/server/route-modules/route-module.d.ts","./node_modules/next/dist/server/load-components.d.ts","./node_modules/next/dist/server/web/adapter.d.ts","./node_modules/next/dist/server/app-render/types.d.ts","./node_modules/next/dist/build/webpack/loaders/metadata/types.d.ts","./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.d.ts","./node_modules/next/dist/server/lib/app-dir-module.d.ts","./node_modules/next/dist/server/web/spec-extension/adapters/request-cookies.d.ts","./node_modules/next/dist/server/async-storage/draft-mode-provider.d.ts","./node_modules/next/dist/server/web/spec-extension/adapters/headers.d.ts","./node_modules/next/dist/server/app-render/cache-signal.d.ts","./node_modules/next/dist/server/app-render/dynamic-rendering.d.ts","./node_modules/next/dist/server/request/fallback-params.d.ts","./node_modules/next/dist/server/app-render/work-unit-async-storage-instance.d.ts","./node_modules/next/dist/server/lib/lazy-result.d.ts","./node_modules/next/dist/server/lib/implicit-tags.d.ts","./node_modules/next/dist/server/app-render/staged-rendering.d.ts","./node_modules/next/dist/server/app-render/work-unit-async-storage.external.d.ts","./node_modules/next/dist/shared/lib/router/utils/parse-relative-url.d.ts","./node_modules/next/dist/server/app-render/app-render.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/contexts/entrypoints.d.ts","./node_modules/next/dist/client/components/error-boundary.d.ts","./node_modules/next/dist/client/components/layout-router.d.ts","./node_modules/next/dist/client/components/render-from-template-context.d.ts","./node_modules/next/dist/server/app-render/action-async-storage-instance.d.ts","./node_modules/next/dist/server/app-render/action-async-storage.external.d.ts","./node_modules/next/dist/client/components/client-page.d.ts","./node_modules/next/dist/client/components/client-segment.d.ts","./node_modules/next/dist/server/request/search-params.d.ts","./node_modules/next/dist/client/components/hooks-server-context.d.ts","./node_modules/next/dist/client/components/http-access-fallback/error-boundary.d.ts","./node_modules/next/dist/lib/metadata/types/alternative-urls-types.d.ts","./node_modules/next/dist/lib/metadata/types/extra-types.d.ts","./node_modules/next/dist/lib/metadata/types/metadata-types.d.ts","./node_modules/next/dist/lib/metadata/types/manifest-types.d.ts","./node_modules/next/dist/lib/metadata/types/opengraph-types.d.ts","./node_modules/next/dist/lib/metadata/types/twitter-types.d.ts","./node_modules/next/dist/lib/metadata/types/metadata-interface.d.ts","./node_modules/next/dist/lib/metadata/types/resolvers.d.ts","./node_modules/next/dist/lib/metadata/types/icons.d.ts","./node_modules/next/dist/lib/metadata/resolve-metadata.d.ts","./node_modules/next/dist/lib/metadata/metadata.d.ts","./node_modules/next/dist/lib/framework/boundary-components.d.ts","./node_modules/next/dist/server/app-render/rsc/preloads.d.ts","./node_modules/next/dist/server/app-render/rsc/postpone.d.ts","./node_modules/next/dist/server/app-render/rsc/taint.d.ts","./node_modules/next/dist/shared/lib/segment-cache/segment-value-encoding.d.ts","./node_modules/next/dist/server/app-render/collect-segment-data.d.ts","./node_modules/next/dist/next-devtools/userspace/app/segment-explorer-node.d.ts","./node_modules/next/dist/server/app-render/entry-base.d.ts","./node_modules/next/dist/build/templates/app-page.d.ts","./node_modules/next/dist/build/rendering-mode.d.ts","./node_modules/@types/react/jsx-dev-runtime.d.ts","./node_modules/@types/react/compiler-runtime.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/entrypoints.d.ts","./node_modules/next/dist/server/route-modules/app-page/module.d.ts","./node_modules/next/dist/server/route-modules/app-page/module.compiled.d.ts","./node_modules/next/dist/server/route-definitions/app-route-route-definition.d.ts","./node_modules/next/dist/server/async-storage/work-store.d.ts","./node_modules/next/dist/server/web/http.d.ts","./node_modules/next/dist/server/route-modules/app-route/shared-modules.d.ts","./node_modules/next/dist/client/components/redirect-status-code.d.ts","./node_modules/next/dist/client/components/redirect-error.d.ts","./node_modules/next/dist/build/templates/app-route.d.ts","./node_modules/next/dist/server/route-modules/app-route/module.d.ts","./node_modules/next/dist/server/route-modules/app-route/module.compiled.d.ts","./node_modules/next/dist/build/segment-config/app/app-segments.d.ts","./node_modules/next/dist/build/utils.d.ts","./node_modules/next/dist/server/lib/router-utils/build-prefetch-segment-data-route.d.ts","./node_modules/next/dist/build/turborepo-access-trace/types.d.ts","./node_modules/next/dist/build/turborepo-access-trace/result.d.ts","./node_modules/next/dist/build/turborepo-access-trace/helpers.d.ts","./node_modules/next/dist/build/turborepo-access-trace/index.d.ts","./node_modules/next/dist/export/routes/types.d.ts","./node_modules/next/dist/export/types.d.ts","./node_modules/next/dist/export/worker.d.ts","./node_modules/next/dist/build/worker.d.ts","./node_modules/next/dist/build/index.d.ts","./node_modules/next/dist/server/lib/incremental-cache/index.d.ts","./node_modules/next/dist/server/after/after.d.ts","./node_modules/next/dist/server/after/after-context.d.ts","./node_modules/next/dist/server/app-render/work-async-storage-instance.d.ts","./node_modules/next/dist/server/app-render/create-error-handler.d.ts","./node_modules/next/dist/shared/lib/action-revalidation-kind.d.ts","./node_modules/next/dist/server/app-render/work-async-storage.external.d.ts","./node_modules/next/dist/server/request/params.d.ts","./node_modules/next/dist/server/route-matches/route-match.d.ts","./node_modules/next/dist/server/request-meta.d.ts","./node_modules/next/dist/cli/next-test.d.ts","./node_modules/next/dist/shared/lib/size-limit.d.ts","./node_modules/next/dist/server/config-shared.d.ts","./node_modules/next/dist/server/base-http/index.d.ts","./node_modules/next/dist/server/api-utils/index.d.ts","./node_modules/next/dist/build/adapter/build-complete.d.ts","./node_modules/next/dist/types.d.ts","./node_modules/next/dist/shared/lib/html-context.shared-runtime.d.ts","./node_modules/next/dist/shared/lib/utils.d.ts","./node_modules/next/dist/pages/_app.d.ts","./node_modules/next/app.d.ts","./node_modules/next/dist/server/web/spec-extension/unstable-cache.d.ts","./node_modules/next/dist/server/web/spec-extension/revalidate.d.ts","./node_modules/next/dist/server/web/spec-extension/unstable-no-store.d.ts","./node_modules/next/dist/server/use-cache/cache-tag.d.ts","./node_modules/next/cache.d.ts","./node_modules/next/dist/pages/_document.d.ts","./node_modules/next/document.d.ts","./node_modules/next/dist/shared/lib/dynamic.d.ts","./node_modules/next/dynamic.d.ts","./node_modules/next/dist/pages/_error.d.ts","./node_modules/next/error.d.ts","./node_modules/next/dist/shared/lib/head.d.ts","./node_modules/next/head.d.ts","./node_modules/next/dist/server/request/cookies.d.ts","./node_modules/next/dist/server/request/headers.d.ts","./node_modules/next/dist/server/request/draft-mode.d.ts","./node_modules/next/headers.d.ts","./node_modules/next/dist/shared/lib/get-img-props.d.ts","./node_modules/next/dist/client/image-component.d.ts","./node_modules/next/dist/shared/lib/image-external.d.ts","./node_modules/next/image.d.ts","./node_modules/next/dist/client/link.d.ts","./node_modules/next/link.d.ts","./node_modules/next/dist/client/components/unrecognized-action-error.d.ts","./node_modules/next/dist/client/components/redirect.d.ts","./node_modules/next/dist/client/components/not-found.d.ts","./node_modules/next/dist/client/components/forbidden.d.ts","./node_modules/next/dist/client/components/unauthorized.d.ts","./node_modules/next/dist/client/components/unstable-rethrow.server.d.ts","./node_modules/next/dist/client/components/unstable-rethrow.d.ts","./node_modules/next/dist/client/components/navigation.react-server.d.ts","./node_modules/next/dist/client/components/navigation.d.ts","./node_modules/next/navigation.d.ts","./node_modules/next/router.d.ts","./node_modules/next/dist/client/script.d.ts","./node_modules/next/script.d.ts","./node_modules/next/dist/server/web/spec-extension/user-agent.d.ts","./node_modules/next/dist/compiled/@edge-runtime/primitives/url.d.ts","./node_modules/next/dist/server/web/spec-extension/image-response.d.ts","./node_modules/next/dist/compiled/@vercel/og/satori/index.d.ts","./node_modules/next/dist/compiled/@vercel/og/emoji/index.d.ts","./node_modules/next/dist/compiled/@vercel/og/types.d.ts","./node_modules/next/dist/server/after/index.d.ts","./node_modules/next/dist/server/request/connection.d.ts","./node_modules/next/server.d.ts","./node_modules/next/types/global.d.ts","./node_modules/next/types/compiled.d.ts","./node_modules/next/types.d.ts","./node_modules/next/index.d.ts","./node_modules/next/image-types/global.d.ts","./.next/dev/types/routes.d.ts","./next-env.d.ts","./node_modules/zod/v4/core/json-schema.d.cts","./node_modules/zod/v4/core/standard-schema.d.cts","./node_modules/zod/v4/core/registries.d.cts","./node_modules/zod/v4/core/to-json-schema.d.cts","./node_modules/zod/v4/core/util.d.cts","./node_modules/zod/v4/core/versions.d.cts","./node_modules/zod/v4/core/schemas.d.cts","./node_modules/zod/v4/core/checks.d.cts","./node_modules/zod/v4/core/errors.d.cts","./node_modules/zod/v4/core/core.d.cts","./node_modules/zod/v4/core/parse.d.cts","./node_modules/zod/v4/core/regexes.d.cts","./node_modules/zod/v4/locales/ar.d.cts","./node_modules/zod/v4/locales/az.d.cts","./node_modules/zod/v4/locales/be.d.cts","./node_modules/zod/v4/locales/bg.d.cts","./node_modules/zod/v4/locales/ca.d.cts","./node_modules/zod/v4/locales/cs.d.cts","./node_modules/zod/v4/locales/da.d.cts","./node_modules/zod/v4/locales/de.d.cts","./node_modules/zod/v4/locales/en.d.cts","./node_modules/zod/v4/locales/eo.d.cts","./node_modules/zod/v4/locales/es.d.cts","./node_modules/zod/v4/locales/fa.d.cts","./node_modules/zod/v4/locales/fi.d.cts","./node_modules/zod/v4/locales/fr.d.cts","./node_modules/zod/v4/locales/fr-ca.d.cts","./node_modules/zod/v4/locales/he.d.cts","./node_modules/zod/v4/locales/hu.d.cts","./node_modules/zod/v4/locales/hy.d.cts","./node_modules/zod/v4/locales/id.d.cts","./node_modules/zod/v4/locales/is.d.cts","./node_modules/zod/v4/locales/it.d.cts","./node_modules/zod/v4/locales/ja.d.cts","./node_modules/zod/v4/locales/ka.d.cts","./node_modules/zod/v4/locales/kh.d.cts","./node_modules/zod/v4/locales/km.d.cts","./node_modules/zod/v4/locales/ko.d.cts","./node_modules/zod/v4/locales/lt.d.cts","./node_modules/zod/v4/locales/mk.d.cts","./node_modules/zod/v4/locales/ms.d.cts","./node_modules/zod/v4/locales/nl.d.cts","./node_modules/zod/v4/locales/no.d.cts","./node_modules/zod/v4/locales/ota.d.cts","./node_modules/zod/v4/locales/ps.d.cts","./node_modules/zod/v4/locales/pl.d.cts","./node_modules/zod/v4/locales/pt.d.cts","./node_modules/zod/v4/locales/ru.d.cts","./node_modules/zod/v4/locales/sl.d.cts","./node_modules/zod/v4/locales/sv.d.cts","./node_modules/zod/v4/locales/ta.d.cts","./node_modules/zod/v4/locales/th.d.cts","./node_modules/zod/v4/locales/tr.d.cts","./node_modules/zod/v4/locales/ua.d.cts","./node_modules/zod/v4/locales/uk.d.cts","./node_modules/zod/v4/locales/ur.d.cts","./node_modules/zod/v4/locales/uz.d.cts","./node_modules/zod/v4/locales/vi.d.cts","./node_modules/zod/v4/locales/zh-cn.d.cts","./node_modules/zod/v4/locales/zh-tw.d.cts","./node_modules/zod/v4/locales/yo.d.cts","./node_modules/zod/v4/locales/index.d.cts","./node_modules/zod/v4/core/doc.d.cts","./node_modules/zod/v4/core/api.d.cts","./node_modules/zod/v4/core/json-schema-processors.d.cts","./node_modules/zod/v4/core/json-schema-generator.d.cts","./node_modules/zod/v4/core/index.d.cts","./node_modules/zod/v4/classic/errors.d.cts","./node_modules/zod/v4/classic/parse.d.cts","./node_modules/zod/v4/classic/schemas.d.cts","./node_modules/zod/v4/classic/checks.d.cts","./node_modules/zod/v4/classic/compat.d.cts","./node_modules/zod/v4/classic/from-json-schema.d.cts","./node_modules/zod/v4/classic/iso.d.cts","./node_modules/zod/v4/classic/coerce.d.cts","./node_modules/zod/v4/classic/external.d.cts","./node_modules/zod/index.d.cts","./src/lib/assessment/validate.ts","./verify_schema.ts","./src/lib/scoring/number.ts","./src/store/readiness/types.ts","./src/lib/scoring/compute.ts","./scripts/verify-scoring.ts","./src/lib/api/client.ts","./src/lib/api/admintypes.ts","./src/lib/api/adminendpoints.ts","./src/lib/api/types.ts","./src/lib/api/endpoints.ts","./src/lib/assessment/progress.ts","./src/lib/recommendations/validate.ts","./src/lib/narrative/validate.ts","./src/lib/content/source.ts","./src/lib/context/adminauthcontext.tsx","./src/lib/hooks/useadminauth.ts","./src/lib/maturity/model.ts","./src/lib/recommendations/definition.ts","./src/lib/narrative/generate.ts","./src/lib/recommendations/apiengine.ts","./node_modules/zustand/esm/vanilla.d.mts","./node_modules/zustand/esm/middleware/redux.d.mts","./node_modules/zustand/esm/middleware/devtools.d.mts","./node_modules/zustand/esm/middleware/subscribewithselector.d.mts","./node_modules/zustand/esm/middleware/combine.d.mts","./node_modules/zustand/esm/middleware/persist.d.mts","./node_modules/zustand/esm/middleware/ssrsafe.d.mts","./node_modules/zustand/esm/middleware.d.mts","./src/lib/storage/zustandstorage.ts","./node_modules/zustand/esm/react.d.mts","./node_modules/zustand/esm/index.d.mts","./src/store/readiness/readiness.store.ts","./src/types/assessment.ts","./node_modules/next/dist/compiled/@next/font/dist/types.d.ts","./node_modules/next/dist/compiled/@next/font/dist/google/index.d.ts","./node_modules/next/font/google/index.d.ts","./src/app/layout.tsx","./src/components/layout/navbar.tsx","./src/app/page.tsx","./src/app/admin/layout.tsx","./node_modules/lucide-react/dist/lucide-react.d.ts","./src/components/admin/statcard.tsx","./src/app/admin/analytics/page.tsx","./src/components/admin/assessmentform.tsx","./src/app/admin/assessments/page.tsx","./src/app/admin/assessments/[id]/page.tsx","./src/components/admin/activityfeed.tsx","./src/app/admin/dashboard/page.tsx","./src/app/admin/login/page.tsx","./src/app/admin/responses/page.tsx","./src/app/admin/responses/[id]/page.tsx","./src/components/admin/settingsform.tsx","./src/app/admin/settings/page.tsx","./node_modules/motion-utils/dist/index.d.ts","./node_modules/motion-dom/dist/index.d.ts","./node_modules/framer-motion/dist/types.d-cq4vrm6h.d.ts","./node_modules/framer-motion/dist/types/index.d.ts","./src/components/results/charts/maturitygauge.tsx","./src/components/results/charts/dimensionbarchart.tsx","./src/components/results/toptopicslist.tsx","./src/components/common/resetbutton.tsx","./src/components/results/executivesummarycard.tsx","./src/components/results/resultsclient.tsx","./src/app/results/page.tsx","./src/components/results/charts/bubblechart.tsx","./src/components/results/recommendationslist.tsx","./src/components/results/recommendationspageclient.tsx","./src/app/results/recommendations/page.tsx","./src/components/survey/assessmentgatedialog.tsx","./src/components/layout/sidebar/sidebar.tsx","./src/app/survey/layout.tsx","./src/app/survey/page.tsx","./src/components/ui/sliders/dualslider.tsx","./src/components/survey/topiccard.tsx","./src/components/survey/dimensioncontent.tsx","./src/app/survey/[dimensionid]/page.tsx","./node_modules/tailwind-merge/dist/types.d.ts","./src/components/results/dimensionresultcard.tsx","./src/components/results/maturityradar.tsx","./src/components/results/overallsummarycard.tsx","./src/components/results/topgapslist.tsx","./src/components/results/charts/gapvariancechart.tsx","./src/components/results/charts/prioritymatrix.tsx","./src/components/results/charts/riskheatmap.tsx","./src/components/survey/dimensionsummarybar.tsx","./src/components/ui/sliders/slider.tsx","./.next/types/routes.d.ts","./.next/types/validator.ts","./.next/dev/types/cache-life.d.ts","./.next/dev/types/validator.ts","./node_modules/@types/estree/index.d.ts","./node_modules/@types/json-schema/index.d.ts","./node_modules/@types/json5/index.d.ts"],"fileIdsList":[[94,157,165,169,172,174,175,176,188,476,477,478,479],[94,157,165,169,172,174,175,176,188],[94,157,165,169,172,174,175,176,188,288,523,526,642,644,645,648,650,651,653,654,655,656,658,669,673,676,677,681],[94,157,165,169,172,174,175,176,188,288,523,642,644,645,650,651,653,654,655,656,669,673,676,677,681,692],[94,157,165,169,172,174,175,176,188,524,525,526],[94,154,155,157,165,169,172,174,175,176,188],[94,156,157,165,169,172,174,175,176,188],[157,165,169,172,174,175,176,188],[94,157,165,169,172,174,175,176,188,196],[94,157,158,163,165,168,169,172,174,175,176,178,188,193,205],[94,157,158,159,165,168,169,172,174,175,176,188],[94,157,160,165,169,172,174,175,176,188,206],[94,157,161,162,165,169,172,174,175,176,179,188],[94,157,162,165,169,172,174,175,176,188,193,202],[94,157,163,165,168,169,172,174,175,176,178,188],[94,156,157,164,165,169,172,174,175,176,188],[94,157,165,166,169,172,174,175,176,188],[94,157,165,167,168,169,172,174,175,176,188],[94,156,157,165,168,169,172,174,175,176,188],[94,157,165,168,169,170,172,174,175,176,188,193,205],[94,157,165,168,169,170,172,174,175,176,188,193,196],[94,144,157,165,168,169,171,172,174,175,176,178,188,193,205],[94,157,165,168,169,171,172,174,175,176,178,188,193,202,205],[94,157,165,169,171,172,173,174,175,176,188,193,202,205],[92,93,94,95,96,97,98,99,100,101,102,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212],[94,157,165,168,169,172,174,175,176,188],[94,157,165,169,172,174,176,188],[94,157,165,169,172,174,175,176,177,188,205],[94,157,165,168,169,172,174,175,176,178,188,193],[94,157,165,169,172,174,175,176,179,188],[94,157,165,169,172,174,175,176,180,188],[94,157,165,168,169,172,174,175,176,183,188],[94,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212],[94,157,165,169,172,174,175,176,185,188],[94,157,165,169,172,174,175,176,186,188],[94,157,162,165,169,172,174,175,176,178,188,196],[94,157,165,168,169,172,174,175,176,188,189],[94,157,165,169,172,174,175,176,188,190,206,209],[94,157,165,168,169,172,174,175,176,188,193,195,196],[94,157,165,169,172,174,175,176,188,194,196],[94,157,165,169,172,174,175,176,188,196,206],[94,157,165,169,172,174,175,176,188,197],[94,154,157,165,169,172,174,175,176,188,193,199,205],[94,157,165,169,172,174,175,176,188,193,198],[94,157,165,168,169,172,174,175,176,188,200,201],[94,157,165,169,172,174,175,176,188,200,201],[94,157,162,165,169,172,174,175,176,178,188,193,202],[94,157,165,169,172,174,175,176,188,203],[94,157,165,169,172,174,175,176,178,188,204],[94,157,165,169,171,172,174,175,176,186,188,205],[94,157,165,169,172,174,175,176,188,206,207],[94,157,162,165,169,172,174,175,176,188,207],[94,157,165,169,172,174,175,176,188,193,208],[94,157,165,169,172,174,175,176,177,188,209],[94,157,165,169,172,174,175,176,188,210],[94,157,160,165,169,172,174,175,176,188],[94,157,162,165,169,172,174,175,176,188],[94,157,165,169,172,174,175,176,188,206],[94,144,157,165,169,172,174,175,176,188],[94,157,165,169,172,174,175,176,188,205],[94,157,165,169,172,174,175,176,188,211],[94,157,165,169,172,174,175,176,183,188],[94,157,165,169,172,174,175,176,188,201],[94,144,157,165,168,169,170,172,174,175,176,183,188,193,196,205,208,209,211],[94,157,165,169,172,174,175,176,188,193,212],[85,89,94,157,165,169,172,174,175,176,188,215,471,517],[85,89,94,157,165,169,172,174,175,176,188,214,471,517],[83,84,94,157,165,169,172,174,175,176,188],[85,94,157,165,169,172,174,175,176,188],[85,94,157,165,169,172,174,175,176,188,660],[85,94,157,165,169,172,174,175,176,188,288,659,660,661],[94,157,165,169,172,174,175,176,188,659],[94,157,165,169,172,174,175,176,188,474],[94,157,165,169,172,174,175,176,188,220,222,226,237,427,454,467],[94,157,165,169,172,174,175,176,188,222,232,233,234,236,467],[94,157,165,169,172,174,175,176,188,222,269,271,273,274,277,467,469],[94,157,165,169,172,174,175,176,188,222,226,228,229,230,260,355,427,444,445,453,467,469],[94,157,165,169,172,174,175,176,188,467],[94,157,165,169,172,174,175,176,188,233,325,433,442,462],[94,157,165,169,172,174,175,176,188,222],[94,157,165,169,172,174,175,176,188,216,325,462],[94,157,165,169,172,174,175,176,188,279],[94,157,165,169,172,174,175,176,188,278,467],[94,157,165,169,171,172,174,175,176,188,425,433,522],[94,157,165,169,171,172,174,175,176,188,393,405,442,461],[94,157,165,169,171,172,174,175,176,188,336],[94,157,165,169,172,174,175,176,188,447],[94,157,165,169,172,174,175,176,188,446,447,448],[94,157,165,169,172,174,175,176,188,446],[91,94,157,165,169,171,172,174,175,176,188,216,222,226,229,231,233,237,238,251,252,279,355,366,443,454,467,471],[94,157,165,169,172,174,175,176,188,220,222,235,269,270,275,276,467,522],[94,157,165,169,172,174,175,176,188,235,522],[94,157,165,169,172,174,175,176,188,220,252,380,467,522],[94,157,165,169,172,174,175,176,188,522],[94,157,165,169,172,174,175,176,188,222,235,236,522],[94,157,165,169,172,174,175,176,188,272,522],[94,157,165,169,172,174,175,176,188,238,444,452],[94,157,165,169,172,174,175,176,186,188,288,462],[94,157,165,169,172,174,175,176,188,288,462],[85,94,157,165,169,172,174,175,176,188,288],[85,94,157,165,169,172,174,175,176,188,397],[94,157,165,169,172,174,175,176,188,323,333,334,462,499,506],[94,157,165,169,172,174,175,176,188,322,439,500,501,502,503,505],[94,157,165,169,172,174,175,176,188,438],[94,157,165,169,172,174,175,176,188,438,439],[94,157,165,169,172,174,175,176,188,260,325,326,330],[94,157,165,169,172,174,175,176,188,325],[94,157,165,169,172,174,175,176,188,325,329,331],[94,157,165,169,172,174,175,176,188,325,326,327,328],[94,157,165,169,172,174,175,176,188,504],[85,94,157,165,169,172,174,175,176,188,223,493],[85,94,157,165,169,172,174,175,176,188,205],[85,94,157,165,169,172,174,175,176,188,235,315],[85,94,157,165,169,172,174,175,176,188,235,454],[94,157,165,169,172,174,175,176,188,313,317],[85,94,157,165,169,172,174,175,176,188,314,473],[94,157,165,169,172,174,175,176,188,639],[85,89,94,157,165,169,171,172,174,175,176,188,213,214,215,471,515,516],[94,157,165,169,171,172,174,175,176,188],[94,157,165,169,171,172,174,175,176,188,226,259,311,356,377,379,449,450,454,467,468],[94,157,165,169,172,174,175,176,188,251,451],[94,157,165,169,172,174,175,176,188,471],[94,157,165,169,172,174,175,176,188,221],[85,94,157,165,169,172,174,175,176,188,382,395,404,414,416,461],[94,157,165,169,172,174,175,176,186,188,382,395,413,414,415,461,521],[94,157,165,169,172,174,175,176,188,407,408,409,410,411,412],[94,157,165,169,172,174,175,176,188,409],[94,157,165,169,172,174,175,176,188,413],[94,157,165,169,172,174,175,176,188,286,287,288,290],[85,94,157,165,169,172,174,175,176,188,280,281,282,283,289],[94,157,165,169,172,174,175,176,188,286,289],[94,157,165,169,172,174,175,176,188,284],[94,157,165,169,172,174,175,176,188,285],[85,94,157,165,169,172,174,175,176,188,288,314,473],[85,94,157,165,169,172,174,175,176,188,288,472,473],[85,94,157,165,169,172,174,175,176,188,288,473],[94,157,165,169,172,174,175,176,188,356,456],[94,157,165,169,172,174,175,176,188,456],[94,157,165,169,171,172,174,175,176,188,468,473],[94,157,165,169,172,174,175,176,188,401],[94,156,157,165,169,172,174,175,176,188,400],[94,157,165,169,172,174,175,176,188,261,325,342,379,388,391,393,394,432,461,464,468],[94,157,165,169,172,174,175,176,188,307,325,422],[94,157,165,169,172,174,175,176,188,393,461],[85,94,157,165,169,172,174,175,176,188,393,398,399,401,402,403,404,405,406,417,418,419,420,421,423,424,461,462,522],[94,157,165,169,172,174,175,176,188,387],[94,157,165,169,171,172,174,175,176,186,188,223,259,262,283,308,309,356,366,377,378,432,455,467,468,469,471,522],[94,157,165,169,172,174,175,176,188,461],[94,156,157,165,169,172,174,175,176,188,233,309,366,390,455,457,458,459,460,468],[94,157,165,169,172,174,175,176,188,393],[94,156,157,165,169,172,174,175,176,188,259,296,342,383,384,385,386,387,388,389,391,392,461,462],[94,157,165,169,171,172,174,175,176,188,296,297,383,468,469],[94,157,165,169,172,174,175,176,188,233,356,366,379,455,461,468],[94,157,165,169,171,172,174,175,176,188,467,469],[94,157,165,169,171,172,174,175,176,188,193,464,468,469],[94,157,165,169,171,172,174,175,176,186,188,205,216,226,235,261,262,264,293,298,303,307,308,309,311,340,342,344,347,349,352,353,354,355,377,379,454,455,462,464,467,468,469],[94,157,165,169,171,172,174,175,176,188,193],[94,157,165,169,172,174,175,176,188,222,223,224,231,464,465,466,471,473,522],[94,157,165,169,172,174,175,176,188,220,467],[94,157,165,169,172,174,175,176,188,292],[94,157,165,169,171,172,174,175,176,188,193,205,254,277,279,280,281,282,283,290,291,522],[94,157,165,169,172,174,175,176,186,188,205,216,254,269,302,303,304,340,341,342,347,355,356,362,365,367,377,379,455,462,464,467],[94,157,165,169,172,174,175,176,188,231,238,251,355,366,455,467],[94,157,165,169,171,172,174,175,176,188,205,223,226,342,360,464,467],[94,157,165,169,172,174,175,176,188,381],[94,157,165,169,171,172,174,175,176,188,292,363,364,374],[94,157,165,169,172,174,175,176,188,464,467],[94,157,165,169,172,174,175,176,188,388,390],[94,157,165,169,172,174,175,176,188,309,342,454,473],[94,157,165,169,171,172,174,175,176,186,188,265,269,341,347,362,365,369,464],[94,157,165,169,171,172,174,175,176,188,238,251,269,370],[94,157,165,169,172,174,175,176,188,222,264,372,454,467],[94,157,165,169,171,172,174,175,176,188,205,283,467],[94,157,165,169,171,172,174,175,176,188,235,263,264,265,274,292,371,373,454,467],[91,94,157,165,169,171,172,174,175,176,188,309,376,471,473],[94,157,165,169,172,174,175,176,188,339,377],[94,157,165,169,171,172,174,175,176,186,188,205,226,237,238,251,261,262,298,302,303,304,308,340,341,342,344,356,357,359,361,377,379,454,455,462,463,464,473],[94,157,165,169,171,172,174,175,176,188,193,238,362,368,374,464],[94,157,165,169,172,174,175,176,188,241,242,243,244,245,246,247,248,249,250],[94,157,165,169,172,174,175,176,188,293,348],[94,157,165,169,172,174,175,176,188,350],[94,157,165,169,172,174,175,176,188,348],[94,157,165,169,172,174,175,176,188,350,351],[94,157,165,169,171,172,174,175,176,188,226,229,259,260,468],[94,157,165,169,171,172,174,175,176,186,188,221,223,261,307,308,309,310,338,377,464,469,471,473],[94,157,165,169,171,172,174,175,176,186,188,205,225,260,310,342,388,455,463,468],[94,157,165,169,172,174,175,176,188,383],[94,157,165,169,172,174,175,176,188,384],[94,157,165,169,172,174,175,176,188,325,355,432],[94,157,165,169,172,174,175,176,188,385],[94,157,165,169,172,174,175,176,188,253,257],[94,157,165,169,171,172,174,175,176,188,226,253,261],[94,157,165,169,172,174,175,176,188,256,257],[94,157,165,169,172,174,175,176,188,258],[94,157,165,169,172,174,175,176,188,253,254],[94,157,165,169,172,174,175,176,188,253,305],[94,157,165,169,172,174,175,176,188,253],[94,157,165,169,172,174,175,176,188,293,346,463],[94,157,165,169,172,174,175,176,188,345],[94,157,165,169,172,174,175,176,188,254,462,463],[94,157,165,169,172,174,175,176,188,343,463],[94,157,165,169,172,174,175,176,188,254,462],[94,157,165,169,172,174,175,176,188,432],[94,157,165,169,172,174,175,176,188,226,255,261,309,325,342,376,379,382,388,395,396,426,427,430,431,454,464,468],[94,157,165,169,172,174,175,176,188,318,321,323,324,333,334],[85,94,157,165,169,172,174,175,176,188,288,428,429],[94,157,165,169,172,174,175,176,188,441],[94,157,165,169,172,174,175,176,188,233,297,309,376,379,393,401,405,434,435,436,437,439,440,443,454,461,467],[94,157,165,169,172,174,175,176,188,333],[94,157,165,169,171,172,174,175,176,188,338],[94,157,165,169,172,174,175,176,188,338],[94,157,165,169,171,172,174,175,176,188,261,306,311,335,337,376,464,471,473],[94,157,165,169,172,174,175,176,188,318,319,320,321,323,324,333,334,472],[91,94,157,165,169,171,172,174,175,176,186,188,205,253,254,262,308,309,342,374,375,377,454,455,464,467,468,471],[94,157,165,169,172,174,175,176,188,297,299,302,455],[94,157,165,169,171,172,174,175,176,188,293,467],[94,157,165,169,172,174,175,176,188,296,393],[94,157,165,169,172,174,175,176,188,295],[94,157,165,169,172,174,175,176,188,297,298],[94,157,165,169,172,174,175,176,188,294,296,467],[94,157,165,169,171,172,174,175,176,188,225,297,299,300,301,467,468],[85,94,157,165,169,172,174,175,176,188,325,332,462],[94,157,165,169,172,174,175,176,188,218,219],[85,94,157,165,169,172,174,175,176,188,223],[85,94,157,165,169,172,174,175,176,188,322,462],[85,91,94,157,165,169,172,174,175,176,188,308,309,471,473],[94,157,165,169,172,174,175,176,188,223,493,494],[85,94,157,165,169,172,174,175,176,188,317],[85,94,157,165,169,172,174,175,176,186,188,205,221,276,312,314,316,473],[94,157,165,169,172,174,175,176,188,235,462,468],[94,157,165,169,172,174,175,176,188,358,462],[85,94,157,165,169,171,172,174,175,176,186,188,220,221,271,317,471,472],[85,94,157,165,169,172,174,175,176,188,214,215,471,517],[85,86,87,88,89,94,157,165,169,172,174,175,176,188],[94,157,165,169,172,174,175,176,188,266,267,268],[94,157,165,169,172,174,175,176,188,266],[85,89,94,157,165,169,171,172,173,174,175,176,186,188,213,214,215,216,221,262,369,413,469,470,473,517],[94,157,165,169,172,174,175,176,188,481],[94,157,165,169,172,174,175,176,188,483],[94,157,165,169,172,174,175,176,188,485],[94,157,165,169,172,174,175,176,188,640],[94,157,165,169,172,174,175,176,188,487],[94,157,165,169,172,174,175,176,188,489,490,491],[94,157,165,169,172,174,175,176,188,495],[90,94,157,165,169,172,174,175,176,188,475,480,482,484,486,488,492,496,498,508,509,511,520,521,522,523],[94,157,165,169,172,174,175,176,188,497],[94,157,165,169,172,174,175,176,188,507],[94,157,165,169,172,174,175,176,188,314],[94,157,165,169,172,174,175,176,188,510],[94,156,157,165,169,172,174,175,176,188,297,299,300,302,512,513,514,517,518,519],[94,157,165,169,172,174,175,176,188,213],[94,157,165,169,172,174,175,176,188,193,213],[94,110,113,116,117,157,165,169,172,174,175,176,188,205],[94,113,157,165,169,172,174,175,176,188,193,205],[94,113,117,157,165,169,172,174,175,176,188,205],[94,157,165,169,172,174,175,176,188,193],[94,107,157,165,169,172,174,175,176,188],[94,111,157,165,169,172,174,175,176,188],[94,109,110,113,157,165,169,172,174,175,176,188,205],[94,157,165,169,172,174,175,176,178,188,202],[94,107,157,165,169,172,174,175,176,188,213],[94,109,113,157,165,169,172,174,175,176,178,188,205],[94,104,105,106,108,112,157,165,168,169,172,174,175,176,188,193,205],[94,113,121,129,157,165,169,172,174,175,176,188],[94,105,111,157,165,169,172,174,175,176,188],[94,113,138,139,157,165,169,172,174,175,176,188],[94,105,108,113,157,165,169,172,174,175,176,188,196,205,213],[94,113,157,165,169,172,174,175,176,188],[94,109,113,157,165,169,172,174,175,176,188,205],[94,104,157,165,169,172,174,175,176,188],[94,107,108,109,111,112,113,114,115,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,139,140,141,142,143,157,165,169,172,174,175,176,188],[94,113,131,134,157,165,169,172,174,175,176,188],[94,113,121,122,123,157,165,169,172,174,175,176,188],[94,111,113,122,124,157,165,169,172,174,175,176,188],[94,112,157,165,169,172,174,175,176,188],[94,105,107,113,157,165,169,172,174,175,176,188],[94,113,117,122,124,157,165,169,172,174,175,176,188],[94,117,157,165,169,172,174,175,176,188],[94,111,113,116,157,165,169,172,174,175,176,188,205],[94,105,109,113,121,157,165,169,172,174,175,176,188],[94,113,131,157,165,169,172,174,175,176,188],[94,124,157,165,169,172,174,175,176,188],[94,107,113,138,157,165,169,172,174,175,176,188,196,211,213],[94,157,165,169,172,174,175,176,188,603],[94,157,165,169,172,174,175,176,188,594],[94,157,165,169,172,174,175,176,188,594,597],[94,157,165,169,172,174,175,176,188,589,592,594,595,596,597,598,599,600,601,602],[94,157,165,169,172,174,175,176,188,528,530,597],[94,157,165,169,172,174,175,176,188,594,595],[94,157,165,169,172,174,175,176,188,529,594,596],[94,157,165,169,172,174,175,176,188,530,532,534,535,536,537],[94,157,165,169,172,174,175,176,188,532,534,536,537],[94,157,165,169,172,174,175,176,188,532,534,536],[94,157,165,169,172,174,175,176,188,529,532,534,535,537],[94,157,165,169,172,174,175,176,188,528,530,531,532,533,534,535,536,537,538,539,589,590,591,592,593],[94,157,165,169,172,174,175,176,188,528,530,531,534],[94,157,165,169,172,174,175,176,188,530,531,534],[94,157,165,169,172,174,175,176,188,534,537],[94,157,165,169,172,174,175,176,188,528,529,531,532,533,535,536,537],[94,157,165,169,172,174,175,176,188,528,529,530,534,594],[94,157,165,169,172,174,175,176,188,534,535,536,537],[94,157,165,169,172,174,175,176,188,536],[94,157,165,169,172,174,175,176,188,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588],[94,157,165,169,172,174,175,176,188,626,627,628,629,631,635],[94,157,165,169,172,174,175,176,188,627,628,629,630,631,632],[94,157,165,169,172,174,175,176,188,626,627,628,629,631],[94,157,165,169,172,174,175,176,188,288,607,609],[85,94,157,165,169,172,174,175,176,188,288,612,613,646,647],[85,94,157,165,169,172,174,175,176,188,288,498,508,612,613,646,649],[85,94,157,165,169,172,174,175,176,188,288,612,613,646,647,652],[85,94,157,165,169,172,174,175,176,188,288,498,508,620],[85,94,157,165,169,172,174,175,176,188,288,508,621],[85,94,157,165,169,172,174,175,176,188,288,498,508,612,613],[85,94,157,165,169,172,174,175,176,188,288,508,612,613],[85,94,157,165,169,172,174,175,176,188,288,612,613,646,657],[94,157,165,169,172,174,175,176,188,288,524,641],[85,94,157,165,169,172,174,175,176,188,288,508,637,643],[94,157,165,169,172,174,175,176,188,288,524,668],[94,157,165,169,172,174,175,176,188,288,524,672],[85,94,157,165,169,172,174,175,176,188,288,680],[94,157,165,169,172,174,175,176,188,288,643,675],[94,157,165,169,172,174,175,176,188,288,612,646],[85,94,157,165,169,172,174,175,176,188,288,612,613,646],[85,94,157,165,169,172,174,175,176,188,288,646],[94,157,165,169,172,174,175,176,188,288,646],[85,94,157,165,169,172,174,175,176,188,288,508,637],[94,157,165,169,172,174,175,176,188,288,508],[85,94,157,165,169,172,174,175,176,188,288,498,508,616,637,666,674],[85,94,157,165,169,172,174,175,176,188,288,623,662],[85,94,157,165,169,172,174,175,176,188,288,607,609,662],[85,94,157,165,169,172,174,175,176,188,288,662],[85,94,157,165,169,172,174,175,176,188,288,498,607,609,622,646,682],[85,94,157,165,169,172,174,175,176,188,288,624,646,662],[85,94,157,165,169,172,174,175,176,188,288,605,607,609,662],[85,94,157,165,169,172,174,175,176,188,288,607,609,646,662],[85,94,157,165,169,172,174,175,176,188,288,623,646,662],[85,94,157,165,169,172,174,175,176,188,288,508,614,615,625,637,643,666,670,671],[85,94,157,165,169,172,174,175,176,188,288,508,609,614,615,622,624,625,637,643,663,664,665,666,667],[85,94,157,165,169,172,174,175,176,188,288,607,609,646],[85,94,157,165,169,172,174,175,176,188,288,607,609],[85,94,157,165,169,172,174,175,176,188,288,508,616],[85,94,157,165,169,172,174,175,176,188,288,508,637,674,679],[85,94,157,165,169,172,174,175,176,188,288,646,662],[85,94,157,165,169,172,174,175,176,188,288,614,637,678],[94,157,165,169,172,174,175,176,188,288,611,612],[94,157,165,169,172,174,175,176,188,288],[94,157,165,169,172,174,175,176,188,288,611,614],[94,157,165,169,172,174,175,176,188,288,605,608],[94,157,165,169,172,174,175,176,188,288,604],[94,157,165,169,172,174,175,176,188,288,605,617,618],[85,94,157,165,169,172,174,175,176,188,288,612,613],[94,157,165,169,172,174,175,176,188,288,612,620],[94,157,165,169,172,174,175,176,188,288,609,614,622,623],[94,157,165,169,172,174,175,176,188,288,607,614,623],[94,157,165,169,172,174,175,176,188,288,605,607,608],[94,157,165,169,172,174,175,176,188,288,633],[94,157,165,169,172,174,175,176,188,288,614,615,633,636],[94,157,165,169,172,174,175,176,188,288,605],[94,157,165,169,172,174,175,176,180,188,288,605]],"fileInfos":[{"version":"c430d44666289dae81f30fa7b2edebf186ecc91a2d4c71266ea6ae76388792e1","affectsGlobalScope":true,"impliedFormat":1},{"version":"45b7ab580deca34ae9729e97c13cfd999df04416a79116c3bfb483804f85ded4","impliedFormat":1},{"version":"3facaf05f0c5fc569c5649dd359892c98a85557e3e0c847964caeb67076f4d75","impliedFormat":1},{"version":"e44bb8bbac7f10ecc786703fe0a6a4b952189f908707980ba8f3c8975a760962","impliedFormat":1},{"version":"5e1c4c362065a6b95ff952c0eab010f04dcd2c3494e813b493ecfd4fcb9fc0d8","impliedFormat":1},{"version":"68d73b4a11549f9c0b7d352d10e91e5dca8faa3322bfb77b661839c42b1ddec7","impliedFormat":1},{"version":"5efce4fc3c29ea84e8928f97adec086e3dc876365e0982cc8479a07954a3efd4","impliedFormat":1},{"version":"feecb1be483ed332fad555aff858affd90a48ab19ba7272ee084704eb7167569","impliedFormat":1},{"version":"ee7bad0c15b58988daa84371e0b89d313b762ab83cb5b31b8a2d1162e8eb41c2","impliedFormat":1},{"version":"27bdc30a0e32783366a5abeda841bc22757c1797de8681bbe81fbc735eeb1c10","impliedFormat":1},{"version":"8fd575e12870e9944c7e1d62e1f5a73fcf23dd8d3a321f2a2c74c20d022283fe","impliedFormat":1},{"version":"2ab096661c711e4a81cc464fa1e6feb929a54f5340b46b0a07ac6bbf857471f0","impliedFormat":1},{"version":"080941d9f9ff9307f7e27a83bcd888b7c8270716c39af943532438932ec1d0b9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2e80ee7a49e8ac312cc11b77f1475804bee36b3b2bc896bead8b6e1266befb43","affectsGlobalScope":true,"impliedFormat":1},{"version":"c57796738e7f83dbc4b8e65132f11a377649c00dd3eee333f672b8f0a6bea671","affectsGlobalScope":true,"impliedFormat":1},{"version":"dc2df20b1bcdc8c2d34af4926e2c3ab15ffe1160a63e58b7e09833f616efff44","affectsGlobalScope":true,"impliedFormat":1},{"version":"515d0b7b9bea2e31ea4ec968e9edd2c39d3eebf4a2d5cbd04e88639819ae3b71","affectsGlobalScope":true,"impliedFormat":1},{"version":"0559b1f683ac7505ae451f9a96ce4c3c92bdc71411651ca6ddb0e88baaaad6a3","affectsGlobalScope":true,"impliedFormat":1},{"version":"0dc1e7ceda9b8b9b455c3a2d67b0412feab00bd2f66656cd8850e8831b08b537","affectsGlobalScope":true,"impliedFormat":1},{"version":"ce691fb9e5c64efb9547083e4a34091bcbe5bdb41027e310ebba8f7d96a98671","affectsGlobalScope":true,"impliedFormat":1},{"version":"8d697a2a929a5fcb38b7a65594020fcef05ec1630804a33748829c5ff53640d0","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ff2a353abf8a80ee399af572debb8faab2d33ad38c4b4474cff7f26e7653b8d","affectsGlobalScope":true,"impliedFormat":1},{"version":"fb0f136d372979348d59b3f5020b4cdb81b5504192b1cacff5d1fbba29378aa1","affectsGlobalScope":true,"impliedFormat":1},{"version":"d15bea3d62cbbdb9797079416b8ac375ae99162a7fba5de2c6c505446486ac0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"68d18b664c9d32a7336a70235958b8997ebc1c3b8505f4f1ae2b7e7753b87618","affectsGlobalScope":true,"impliedFormat":1},{"version":"eb3d66c8327153d8fa7dd03f9c58d351107fe824c79e9b56b462935176cdf12a","affectsGlobalScope":true,"impliedFormat":1},{"version":"38f0219c9e23c915ef9790ab1d680440d95419ad264816fa15009a8851e79119","affectsGlobalScope":true,"impliedFormat":1},{"version":"69ab18c3b76cd9b1be3d188eaf8bba06112ebbe2f47f6c322b5105a6fbc45a2e","affectsGlobalScope":true,"impliedFormat":1},{"version":"a680117f487a4d2f30ea46f1b4b7f58bef1480456e18ba53ee85c2746eeca012","affectsGlobalScope":true,"impliedFormat":1},{"version":"2f11ff796926e0832f9ae148008138ad583bd181899ab7dd768a2666700b1893","affectsGlobalScope":true,"impliedFormat":1},{"version":"4de680d5bb41c17f7f68e0419412ca23c98d5749dcaaea1896172f06435891fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"954296b30da6d508a104a3a0b5d96b76495c709785c1d11610908e63481ee667","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac9538681b19688c8eae65811b329d3744af679e0bdfa5d842d0e32524c73e1c","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a969edff4bd52585473d24995c5ef223f6652d6ef46193309b3921d65dd4376","affectsGlobalScope":true,"impliedFormat":1},{"version":"9e9fbd7030c440b33d021da145d3232984c8bb7916f277e8ffd3dc2e3eae2bdb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811ec78f7fefcabbda4bfa93b3eb67d9ae166ef95f9bff989d964061cbf81a0c","affectsGlobalScope":true,"impliedFormat":1},{"version":"717937616a17072082152a2ef351cb51f98802fb4b2fdabd32399843875974ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"d7e7d9b7b50e5f22c915b525acc5a49a7a6584cf8f62d0569e557c5cfc4b2ac2","affectsGlobalScope":true,"impliedFormat":1},{"version":"71c37f4c9543f31dfced6c7840e068c5a5aacb7b89111a4364b1d5276b852557","affectsGlobalScope":true,"impliedFormat":1},{"version":"576711e016cf4f1804676043e6a0a5414252560eb57de9faceee34d79798c850","affectsGlobalScope":true,"impliedFormat":1},{"version":"89c1b1281ba7b8a96efc676b11b264de7a8374c5ea1e6617f11880a13fc56dc6","affectsGlobalScope":true,"impliedFormat":1},{"version":"74f7fa2d027d5b33eb0471c8e82a6c87216223181ec31247c357a3e8e2fddc5b","affectsGlobalScope":true,"impliedFormat":1},{"version":"d6d7ae4d1f1f3772e2a3cde568ed08991a8ae34a080ff1151af28b7f798e22ca","affectsGlobalScope":true,"impliedFormat":1},{"version":"063600664504610fe3e99b717a1223f8b1900087fab0b4cad1496a114744f8df","affectsGlobalScope":true,"impliedFormat":1},{"version":"934019d7e3c81950f9a8426d093458b65d5aff2c7c1511233c0fd5b941e608ab","affectsGlobalScope":true,"impliedFormat":1},{"version":"52ada8e0b6e0482b728070b7639ee42e83a9b1c22d205992756fe020fd9f4a47","affectsGlobalScope":true,"impliedFormat":1},{"version":"3bdefe1bfd4d6dee0e26f928f93ccc128f1b64d5d501ff4a8cf3c6371200e5e6","affectsGlobalScope":true,"impliedFormat":1},{"version":"59fb2c069260b4ba00b5643b907ef5d5341b167e7d1dbf58dfd895658bda2867","affectsGlobalScope":true,"impliedFormat":1},{"version":"639e512c0dfc3fad96a84caad71b8834d66329a1f28dc95e3946c9b58176c73a","affectsGlobalScope":true,"impliedFormat":1},{"version":"368af93f74c9c932edd84c58883e736c9e3d53cec1fe24c0b0ff451f529ceab1","affectsGlobalScope":true,"impliedFormat":1},{"version":"af3dd424cf267428f30ccfc376f47a2c0114546b55c44d8c0f1d57d841e28d74","affectsGlobalScope":true,"impliedFormat":1},{"version":"995c005ab91a498455ea8dfb63aa9f83fa2ea793c3d8aa344be4a1678d06d399","affectsGlobalScope":true,"impliedFormat":1},{"version":"959d36cddf5e7d572a65045b876f2956c973a586da58e5d26cde519184fd9b8a","affectsGlobalScope":true,"impliedFormat":1},{"version":"965f36eae237dd74e6cca203a43e9ca801ce38824ead814728a2807b1910117d","affectsGlobalScope":true,"impliedFormat":1},{"version":"3925a6c820dcb1a06506c90b1577db1fdbf7705d65b62b99dce4be75c637e26b","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a3d63ef2b853447ec4f749d3f368ce642264246e02911fcb1590d8c161b8005","affectsGlobalScope":true,"impliedFormat":1},{"version":"8cdf8847677ac7d20486e54dd3fcf09eda95812ac8ace44b4418da1bbbab6eb8","affectsGlobalScope":true,"impliedFormat":1},{"version":"8444af78980e3b20b49324f4a16ba35024fef3ee069a0eb67616ea6ca821c47a","affectsGlobalScope":true,"impliedFormat":1},{"version":"3287d9d085fbd618c3971944b65b4be57859f5415f495b33a6adc994edd2f004","affectsGlobalScope":true,"impliedFormat":1},{"version":"b4b67b1a91182421f5df999988c690f14d813b9850b40acd06ed44691f6727ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"df83c2a6c73228b625b0beb6669c7ee2a09c914637e2d35170723ad49c0f5cd4","affectsGlobalScope":true,"impliedFormat":1},{"version":"436aaf437562f276ec2ddbee2f2cdedac7664c1e4c1d2c36839ddd582eeb3d0a","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e3c06ea092138bf9fa5e874a1fdbc9d54805d074bee1de31b99a11e2fec239d","affectsGlobalScope":true,"impliedFormat":1},{"version":"87dc0f382502f5bbce5129bdc0aea21e19a3abbc19259e0b43ae038a9fc4e326","affectsGlobalScope":true,"impliedFormat":1},{"version":"b1cb28af0c891c8c96b2d6b7be76bd394fddcfdb4709a20ba05a7c1605eea0f9","affectsGlobalScope":true,"impliedFormat":1},{"version":"2fef54945a13095fdb9b84f705f2b5994597640c46afeb2ce78352fab4cb3279","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac77cb3e8c6d3565793eb90a8373ee8033146315a3dbead3bde8db5eaf5e5ec6","affectsGlobalScope":true,"impliedFormat":1},{"version":"56e4ed5aab5f5920980066a9409bfaf53e6d21d3f8d020c17e4de584d29600ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"4ece9f17b3866cc077099c73f4983bddbcb1dc7ddb943227f1ec070f529dedd1","affectsGlobalScope":true,"impliedFormat":1},{"version":"0a6282c8827e4b9a95f4bf4f5c205673ada31b982f50572d27103df8ceb8013c","affectsGlobalScope":true,"impliedFormat":1},{"version":"1c9319a09485199c1f7b0498f2988d6d2249793ef67edda49d1e584746be9032","affectsGlobalScope":true,"impliedFormat":1},{"version":"e3a2a0cee0f03ffdde24d89660eba2685bfbdeae955a6c67e8c4c9fd28928eeb","affectsGlobalScope":true,"impliedFormat":1},{"version":"811c71eee4aa0ac5f7adf713323a5c41b0cf6c4e17367a34fbce379e12bbf0a4","affectsGlobalScope":true,"impliedFormat":1},{"version":"51ad4c928303041605b4d7ae32e0c1ee387d43a24cd6f1ebf4a2699e1076d4fa","affectsGlobalScope":true,"impliedFormat":1},{"version":"60037901da1a425516449b9a20073aa03386cce92f7a1fd902d7602be3a7c2e9","affectsGlobalScope":true,"impliedFormat":1},{"version":"d4b1d2c51d058fc21ec2629fff7a76249dec2e36e12960ea056e3ef89174080f","affectsGlobalScope":true,"impliedFormat":1},{"version":"22adec94ef7047a6c9d1af3cb96be87a335908bf9ef386ae9fd50eeb37f44c47","affectsGlobalScope":true,"impliedFormat":1},{"version":"196cb558a13d4533a5163286f30b0509ce0210e4b316c56c38d4c0fd2fb38405","affectsGlobalScope":true,"impliedFormat":1},{"version":"73f78680d4c08509933daf80947902f6ff41b6230f94dd002ae372620adb0f60","affectsGlobalScope":true,"impliedFormat":1},{"version":"c5239f5c01bcfa9cd32f37c496cf19c61d69d37e48be9de612b541aac915805b","affectsGlobalScope":true,"impliedFormat":1},{"version":"8e7f8264d0fb4c5339605a15daadb037bf238c10b654bb3eee14208f860a32ea","affectsGlobalScope":true,"impliedFormat":1},{"version":"782dec38049b92d4e85c1585fbea5474a219c6984a35b004963b00beb1aab538","affectsGlobalScope":true,"impliedFormat":1},{"version":"7e29f41b158de217f94cb9676bf9cbd0cd9b5a46e1985141ed36e075c52bf6ad","affectsGlobalScope":true,"impliedFormat":1},{"version":"ac51dd7d31333793807a6abaa5ae168512b6131bd41d9c5b98477fc3b7800f9f","impliedFormat":1},{"version":"dc0a7f107690ee5cd8afc8dbf05c4df78085471ce16bdd9881642ec738bc81fe","impliedFormat":1},{"version":"acd8fd5090ac73902278889c38336ff3f48af6ba03aa665eb34a75e7ba1dccc4","impliedFormat":1},{"version":"d6258883868fb2680d2ca96bc8b1352cab69874581493e6d52680c5ffecdb6cc","impliedFormat":1},{"version":"1b61d259de5350f8b1e5db06290d31eaebebc6baafd5f79d314b5af9256d7153","impliedFormat":1},{"version":"f258e3960f324a956fc76a3d3d9e964fff2244ff5859dcc6ce5951e5413ca826","impliedFormat":1},{"version":"643f7232d07bf75e15bd8f658f664d6183a0efaca5eb84b48201c7671a266979","impliedFormat":1},{"version":"21da358700a3893281ce0c517a7a30cbd46be020d9f0c3f2834d0a8ad1f5fc75","impliedFormat":1},{"version":"d153a11543fd884b596587ccd97aebbeed950b26933ee000f94009f1ab142848","affectsGlobalScope":true,"impliedFormat":1},{"version":"0ccdaa19852d25ecd84eec365c3bfa16e7859cadecf6e9ca6d0dbbbee439743f","affectsGlobalScope":true,"impliedFormat":1},{"version":"438b41419b1df9f1fbe33b5e1b18f5853432be205991d1b19f5b7f351675541e","affectsGlobalScope":true,"impliedFormat":1},{"version":"096116f8fedc1765d5bd6ef360c257b4a9048e5415054b3bf3c41b07f8951b0b","affectsGlobalScope":true,"impliedFormat":1},{"version":"e5e01375c9e124a83b52ee4b3244ed1a4d214a6cfb54ac73e164a823a4a7860a","affectsGlobalScope":true,"impliedFormat":1},{"version":"f90ae2bbce1505e67f2f6502392e318f5714bae82d2d969185c4a6cecc8af2fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"4b58e207b93a8f1c88bbf2a95ddc686ac83962b13830fe8ad3f404ffc7051fb4","affectsGlobalScope":true,"impliedFormat":1},{"version":"1fefabcb2b06736a66d2904074d56268753654805e829989a46a0161cd8412c5","affectsGlobalScope":true,"impliedFormat":1},{"version":"9798340ffb0d067d69b1ae5b32faa17ab31b82466a3fc00d8f2f2df0c8554aaa","affectsGlobalScope":true,"impliedFormat":1},{"version":"c18a99f01eb788d849ad032b31cafd49de0b19e083fe775370834c5675d7df8e","affectsGlobalScope":true,"impliedFormat":1},{"version":"5247874c2a23b9a62d178ae84f2db6a1d54e6c9a2e7e057e178cc5eea13757fc","affectsGlobalScope":true,"impliedFormat":1},{"version":"4967529644e391115ca5592184d4b63980569adf60ee685f968fd59ab1557188","impliedFormat":1},{"version":"cdcf9ea426ad970f96ac930cd176d5c69c6c24eebd9fc580e1572d6c6a88f62c","impliedFormat":1},{"version":"23cd712e2ce083d68afe69224587438e5914b457b8acf87073c22494d706a3d0","impliedFormat":1},{"version":"487b694c3de27ddf4ad107d4007ad304d29effccf9800c8ae23c2093638d906a","impliedFormat":1},{"version":"3a80bc85f38526ca3b08007ee80712e7bb0601df178b23fbf0bf87036fce40ce","impliedFormat":1},{"version":"ccf4552357ce3c159ef75f0f0114e80401702228f1898bdc9402214c9499e8c0","impliedFormat":1},{"version":"c6fd2c5a395f2432786c9cb8deb870b9b0e8ff7e22c029954fabdd692bff6195","impliedFormat":1},{"version":"68834d631c8838c715f225509cfc3927913b9cc7a4870460b5b60c8dbdb99baf","impliedFormat":1},{"version":"2931540c47ee0ff8a62860e61782eb17b155615db61e36986e54645ec67f67c2","impliedFormat":1},{"version":"ccab02f3920fc75c01174c47fcf67882a11daf16baf9e81701d0a94636e94556","impliedFormat":1},{"version":"f6faf5f74e4c4cc309a6c6a6c4da02dbb840be5d3e92905a23dcd7b2b0bd1986","impliedFormat":1},{"version":"ea6bc8de8b59f90a7a3960005fd01988f98fd0784e14bc6922dde2e93305ec7d","impliedFormat":1},{"version":"36107995674b29284a115e21a0618c4c2751b32a8766dd4cb3ba740308b16d59","impliedFormat":1},{"version":"914a0ae30d96d71915fc519ccb4efbf2b62c0ddfb3a3fc6129151076bc01dc60","impliedFormat":1},{"version":"33e981bf6376e939f99bd7f89abec757c64897d33c005036b9a10d9587d80187","impliedFormat":1},{"version":"7fd1b31fd35876b0aa650811c25ec2c97a3c6387e5473eb18004bed86cdd76b6","impliedFormat":1},{"version":"b41767d372275c154c7ea6c9d5449d9a741b8ce080f640155cc88ba1763e35b3","impliedFormat":1},{"version":"3bacf516d686d08682751a3bd2519ea3b8041a164bfb4f1d35728993e70a2426","impliedFormat":1},{"version":"7fb266686238369442bd1719bc0d7edd0199da4fb8540354e1ff7f16669b4323","impliedFormat":1},{"version":"0a60a292b89ca7218b8616f78e5bbd1c96b87e048849469cccb4355e98af959a","impliedFormat":1},{"version":"0b6e25234b4eec6ed96ab138d96eb70b135690d7dd01f3dd8a8ab291c35a683a","impliedFormat":1},{"version":"9666f2f84b985b62400d2e5ab0adae9ff44de9b2a34803c2c5bd3c8325b17dc0","impliedFormat":1},{"version":"40cd35c95e9cf22cfa5bd84e96408b6fcbca55295f4ff822390abb11afbc3dca","impliedFormat":1},{"version":"b1616b8959bf557feb16369c6124a97a0e74ed6f49d1df73bb4b9ddf68acf3f3","impliedFormat":1},{"version":"5b03a034c72146b61573aab280f295b015b9168470f2df05f6080a2122f9b4df","impliedFormat":1},{"version":"40b463c6766ca1b689bfcc46d26b5e295954f32ad43e37ee6953c0a677e4ae2b","impliedFormat":1},{"version":"249b9cab7f5d628b71308c7d9bb0a808b50b091e640ba3ed6e2d0516f4a8d91d","impliedFormat":1},{"version":"80aae6afc67faa5ac0b32b5b8bc8cc9f7fa299cff15cf09cc2e11fd28c6ae29e","impliedFormat":1},{"version":"f473cd2288991ff3221165dcf73cd5d24da30391f87e85b3dd4d0450c787a391","impliedFormat":1},{"version":"499e5b055a5aba1e1998f7311a6c441a369831c70905cc565ceac93c28083d53","impliedFormat":1},{"version":"54c3e2371e3d016469ad959697fd257e5621e16296fa67082c2575d0bf8eced0","impliedFormat":1},{"version":"beb8233b2c220cfa0feea31fbe9218d89fa02faa81ef744be8dce5acb89bb1fd","impliedFormat":1},{"version":"c183b931b68ad184bc8e8372bf663f3d33304772fb482f29fb91b3c391031f3e","impliedFormat":1},{"version":"5d0375ca7310efb77e3ef18d068d53784faf62705e0ad04569597ae0e755c401","impliedFormat":1},{"version":"59af37caec41ecf7b2e76059c9672a49e682c1a2aa6f9d7dc78878f53aa284d6","impliedFormat":1},{"version":"addf417b9eb3f938fddf8d81e96393a165e4be0d4a8b6402292f9c634b1cb00d","impliedFormat":1},{"version":"48cc3ec153b50985fb95153258a710782b25975b10dd4ac8a4f3920632d10790","impliedFormat":1},{"version":"adf27937dba6af9f08a68c5b1d3fce0ca7d4b960c57e6d6c844e7d1a8e53adae","impliedFormat":1},{"version":"e1528ca65ac90f6fa0e4a247eb656b4263c470bb22d9033e466463e13395e599","impliedFormat":1},{"version":"2e85db9e6fd73cfa3d7f28e0ab6b55417ea18931423bd47b409a96e4a169e8e6","impliedFormat":1},{"version":"c46e079fe54c76f95c67fb89081b3e399da2c7d109e7dca8e4b58d83e332e605","impliedFormat":1},{"version":"866078923a56d026e39243b4392e282c1c63159723996fa89243140e1388a98d","impliedFormat":1},{"version":"c3f5289820990ab66b70c7fb5b63cb674001009ff84b13de40619619a9c8175f","affectsGlobalScope":true,"impliedFormat":1},{"version":"b3275d55fac10b799c9546804126239baf020d220136163f763b55a74e50e750","affectsGlobalScope":true,"impliedFormat":1},{"version":"fa68a0a3b7cb32c00e39ee3cd31f8f15b80cac97dce51b6ee7fc14a1e8deb30b","affectsGlobalScope":true,"impliedFormat":1},{"version":"1cf059eaf468efcc649f8cf6075d3cb98e9a35a0fe9c44419ec3d2f5428d7123","affectsGlobalScope":true,"impliedFormat":1},{"version":"6c36e755bced82df7fb6ce8169265d0a7bb046ab4e2cb6d0da0cb72b22033e89","affectsGlobalScope":true,"impliedFormat":1},{"version":"e7721c4f69f93c91360c26a0a84ee885997d748237ef78ef665b153e622b36c1","affectsGlobalScope":true,"impliedFormat":1},{"version":"7a93de4ff8a63bafe62ba86b89af1df0ccb5e40bb85b0c67d6bbcfdcf96bf3d4","affectsGlobalScope":true,"impliedFormat":1},{"version":"90e85f9bc549dfe2b5749b45fe734144e96cd5d04b38eae244028794e142a77e","affectsGlobalScope":true,"impliedFormat":1},{"version":"e0a5deeb610b2a50a6350bd23df6490036a1773a8a71d70f2f9549ab009e67ee","affectsGlobalScope":true,"impliedFormat":1},{"version":"435b3711465425770ed2ee2f1cf00ce071835265e0851a7dc4600ab4b007550e","impliedFormat":1},{"version":"7e49f52a159435fc8df4de9dc377ef5860732ca2dc9efec1640531d3cf5da7a3","impliedFormat":1},{"version":"dd4bde4bdc2e5394aed6855e98cf135dfdf5dd6468cad842e03116d31bbcc9bc","impliedFormat":1},{"version":"4d4e879009a84a47c05350b8dca823036ba3a29a3038efed1be76c9f81e45edf","affectsGlobalScope":true,"impliedFormat":1},{"version":"237ba5ac2a95702a114a309e39c53a5bddff5f6333b325db9764df9b34f3502b","impliedFormat":1},{"version":"9ba13b47cb450a438e3076c4a3f6afb9dc85e17eae50f26d4b2d72c0688c9251","impliedFormat":1},{"version":"b64cd4401633ea4ecadfd700ddc8323a13b63b106ac7127c1d2726f32424622c","impliedFormat":1},{"version":"37c6e5fe5715814412b43cc9b50b24c67a63c4e04e753e0d1305970d65417a60","impliedFormat":1},{"version":"1d024184fb57c58c5c91823f9d10b4915a4867b7934e89115fd0d861a9df27c8","impliedFormat":1},{"version":"ee0e4946247f842c6dd483cbb60a5e6b484fee07996e3a7bc7343dfb68a04c5d","impliedFormat":1},{"version":"ef051f42b7e0ef5ca04552f54c4552eac84099d64b6c5ad0ef4033574b6035b8","impliedFormat":1},{"version":"853a43154f1d01b0173d9cbd74063507ece57170bad7a3b68f3fa1229ad0a92f","impliedFormat":1},{"version":"56231e3c39a031bfb0afb797690b20ed4537670c93c0318b72d5180833d98b72","impliedFormat":1},{"version":"5cc7c39031bfd8b00ad58f32143d59eb6ffc24f5d41a20931269011dccd36c5e","impliedFormat":1},{"version":"b0b69c61b0f0ec8ca15db4c8c41f6e77f4cacb784d42bca948f42dea33e8757e","affectsGlobalScope":true,"impliedFormat":1},{"version":"f96a48183254c00d24575401f1a761b4ce4927d927407e7862a83e06ce5d6964","impliedFormat":1},{"version":"cc25940cfb27aa538e60d465f98bb5068d4d7d33131861ace43f04fe6947d68f","impliedFormat":1},{"version":"f83fb2b1338afbb3f9d733c7d6e8b135826c41b0518867df0c0ace18ae1aa270","impliedFormat":1},{"version":"01ff95aa1443e3f7248974e5a771f513cb2ac158c8898f470a1792f817bee497","impliedFormat":1},{"version":"757227c8b345c57d76f7f0e3bbad7a91ffca23f1b2547cbed9e10025816c9cb7","impliedFormat":1},{"version":"42a05d8f239f74587d4926aba8cc54792eed8e8a442c7adc9b38b516642aadfe","impliedFormat":1},{"version":"5d21b58d60383cc6ab9ad3d3e265d7d25af24a2c9b506247e0e50b0a884920be","impliedFormat":1},{"version":"101f482fd48cb4c7c0468dcc6d62c843d842977aea6235644b1edd05e81fbf22","impliedFormat":1},{"version":"ae6757460f37078884b1571a3de3ebaf724d827d7e1d53626c02b3c2a408ac63","affectsGlobalScope":true,"impliedFormat":1},{"version":"9451a46a89ed209e2e08329e6cac59f89356eae79a7230f916d8cc38725407c7","impliedFormat":1},{"version":"3ef397f12387eff17f550bc484ea7c27d21d43816bbe609d495107f44b97e933","impliedFormat":1},{"version":"1023282e2ba810bc07905d3668349fbd37a26411f0c8f94a70ef3c05fe523fcf","impliedFormat":1},{"version":"b214ebcf76c51b115453f69729ee8aa7b7f8eccdae2a922b568a45c2d7ff52f7","impliedFormat":1},{"version":"429c9cdfa7d126255779efd7e6d9057ced2d69c81859bbab32073bad52e9ba76","impliedFormat":1},{"version":"e236b5eba291f51bdf32c231673e6cab81b5410850e61f51a7a524dddadc0f95","impliedFormat":1},{"version":"f7ba0e839daa0702e3ff1a1a871c0d8ea2d586ce684dd8a72c786c36a680b1d9","affectsGlobalScope":true,"impliedFormat":1},{"version":"7f2c62938251b45715fd2a9887060ec4fbc8724727029d1cbce373747252bdd7","impliedFormat":1},{"version":"e3ace08b6bbd84655d41e244677b474fd995923ffef7149ddb68af8848b60b05","impliedFormat":1},{"version":"132580b0e86c48fab152bab850fc57a4b74fe915c8958d2ccb052b809a44b61c","impliedFormat":1},{"version":"af4ab0aa8908fc9a655bb833d3bc28e117c4f0e1038c5a891546158beb25accb","impliedFormat":1},{"version":"69c9a5a9392e8564bd81116e1ed93b13205201fb44cb35a7fde8c9f9e21c4b23","impliedFormat":1},{"version":"5f8fc37f8434691ffac1bfd8fc2634647da2c0e84253ab5d2dd19a7718915b35","impliedFormat":1},{"version":"5981c2340fd8b076cae8efbae818d42c11ffc615994cb060b1cd390795f1be2b","impliedFormat":1},{"version":"f64deb26664af64dc274637343bde8d82f930c77af05a412c7d310b77207a448","impliedFormat":1},{"version":"ed4f674fc8c0c993cc7e145069ac44129e03519b910c62be206a0cc777bdc60b","affectsGlobalScope":true,"impliedFormat":1},{"version":"0250da3eb85c99624f974e77ef355cdf86f43980251bc371475c2b397ba55bcd","impliedFormat":1},{"version":"f1c93e046fb3d9b7f8249629f4b63dc068dd839b824dd0aa39a5e68476dc9420","impliedFormat":1},{"version":"3d3a5f27ffbc06c885dd4d5f9ee20de61faf877fe2c3a7051c4825903d9a7fdc","impliedFormat":1},{"version":"12806f9f085598ef930edaf2467a5fa1789a878fba077cd27e85dc5851e11834","impliedFormat":1},{"version":"bce309f4d9b67c18d4eeff5bba6cf3e67b2b0aead9f03f75d6060c553974d7ba","impliedFormat":1},{"version":"a43fe41c33d0a192a0ecaf9b92e87bef3709c9972e6d53c42c49251ccb962d69","impliedFormat":1},{"version":"a177959203c017fad3ecc4f3d96c8757a840957a4959a3ae00dab9d35961ca6c","affectsGlobalScope":true,"impliedFormat":1},{"version":"6fc727ccf9b36e257ff982ea0badeffbfc2c151802f741bddff00c6af3b784cf","impliedFormat":1},{"version":"2a00d005e3af99cd1cfa75220e60c61b04bfb6be7ca7453bfe2ef6cca37cc03c","impliedFormat":1},{"version":"4844a4c9b4b1e812b257676ed8a80b3f3be0e29bf05e742cc2ea9c3c6865e6c6","impliedFormat":1},{"version":"064878a60367e0407c42fb7ba02a2ea4d83257357dc20088e549bd4d89433e9c","impliedFormat":1},{"version":"14d4bd22d1b05824971b98f7e91b2484c90f1a684805c330476641417c3d9735","impliedFormat":1},{"version":"c3877fef8a43cd434f9728f25a97575b0eb73d92f38b5c87c840daccc3e21d97","impliedFormat":1},{"version":"b484ec11ba00e3a2235562a41898d55372ccabe607986c6fa4f4aba72093749f","impliedFormat":1},{"version":"1dbd83860e7634f9c236647f45dbc5d3c4f9eba8827d87209d6e9826fdf4dbd5","impliedFormat":1},{"version":"41ef7992c555671a8fe54db302788adefa191ded810a50329b79d20a6772d14c","impliedFormat":1},{"version":"041a7781b9127ab568d2cdcce62c58fdea7c7407f40b8c50045d7866a2727130","impliedFormat":1},{"version":"b37f83e7deea729aa9ce5593f78905afb45b7532fdff63041d374f60059e7852","impliedFormat":1},{"version":"e1cb68f3ef3a8dd7b2a9dfb3de482ed6c0f1586ba0db4e7d73c1d2147b6ffc51","impliedFormat":1},{"version":"55cdbeebe76a1fa18bbd7e7bf73350a2173926bd3085bb050cf5a5397025ee4e","impliedFormat":1},{"version":"2beff543f6e9a9701df88daeee3cdd70a34b4a1c11cb4c734472195a5cb2af54","impliedFormat":1},{"version":"2e07abf27aa06353d46f4448c0bbac73431f6065eef7113128a5cd804d0c384d","impliedFormat":1},{"version":"413df52d4ea14472c2fa5bee62f7a40abd1eb49be0b9722ee01ee4e52e63beb2","impliedFormat":1},{"version":"db6d2d9daad8a6d83f281af12ce4355a20b9a3e71b82b9f57cddcca0a8964a96","impliedFormat":1},{"version":"446a50749b24d14deac6f8843e057a6355dd6437d1fac4f9e5ce4a5071f34bff","impliedFormat":1},{"version":"182e9fcbe08ac7c012e0a6e2b5798b4352470be29a64fdc114d23c2bab7d5106","impliedFormat":1},{"version":"5c9b31919ea1cb350a7ae5e71c9ced8f11723e4fa258a8cc8d16ae46edd623c7","impliedFormat":1},{"version":"4aa42ce8383b45823b3a1d3811c0fdd5f939f90254bc4874124393febbaf89f6","impliedFormat":1},{"version":"96ffa70b486207241c0fcedb5d9553684f7fa6746bc2b04c519e7ebf41a51205","impliedFormat":1},{"version":"3677988e03b749874eb9c1aa8dc88cd77b6005e5c4c39d821cda7b80d5388619","impliedFormat":1},{"version":"a86f82d646a739041d6702101afa82dcb935c416dd93cbca7fd754fd0282ce1f","impliedFormat":1},{"version":"ad0d1d75d129b1c80f911be438d6b61bfa8703930a8ff2be2f0e1f8a91841c64","impliedFormat":1},{"version":"ce75b1aebb33d510ff28af960a9221410a3eaf7f18fc5f21f9404075fba77256","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"02436d7e9ead85e09a2f8e27d5f47d9464bced31738dec138ca735390815c9f0","impliedFormat":1},{"version":"f4625edcb57b37b84506e8b276eb59ca30d31f88c6656d29d4e90e3bc58e69df","impliedFormat":1},{"version":"78a2869ad0cbf3f9045dda08c0d4562b7e1b2bfe07b19e0db072f5c3c56e9584","impliedFormat":1},{"version":"f8d5ff8eafd37499f2b6a98659dd9b45a321de186b8db6b6142faed0fea3de77","impliedFormat":1},{"version":"c86fe861cf1b4c46a0fb7d74dffe596cf679a2e5e8b1456881313170f092e3fa","impliedFormat":1},{"version":"c685d9f68c70fe11ce527287526585a06ea13920bb6c18482ca84945a4e433a7","impliedFormat":1},{"version":"540cc83ab772a2c6bc509fe1354f314825b5dba3669efdfbe4693ecd3048e34f","impliedFormat":1},{"version":"121b0696021ab885c570bbeb331be8ad82c6efe2f3b93a6e63874901bebc13e3","impliedFormat":1},{"version":"4e01846df98d478a2a626ec3641524964b38acaac13945c2db198bf9f3df22ee","impliedFormat":1},{"version":"678d6d4c43e5728bf66e92fc2269da9fa709cb60510fed988a27161473c3853f","impliedFormat":1},{"version":"ffa495b17a5ef1d0399586b590bd281056cee6ce3583e34f39926f8dcc6ecdb5","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"aa14cee20aa0db79f8df101fc027d929aec10feb5b8a8da3b9af3895d05b7ba2","impliedFormat":1},{"version":"493c700ac3bd317177b2eb913805c87fe60d4e8af4fb39c41f04ba81fae7e170","impliedFormat":1},{"version":"aeb554d876c6b8c818da2e118d8b11e1e559adbe6bf606cc9a611c1b6c09f670","impliedFormat":1},{"version":"acf5a2ac47b59ca07afa9abbd2b31d001bf7448b041927befae2ea5b1951d9f9","impliedFormat":1},{"version":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881","impliedFormat":1},{"version":"d71291eff1e19d8762a908ba947e891af44749f3a2cbc5bd2ec4b72f72ea795f","impliedFormat":1},{"version":"c0480e03db4b816dff2682b347c95f2177699525c54e7e6f6aa8ded890b76be7","impliedFormat":1},{"version":"e2a37ac938c4bede5bb284b9d2d042da299528f1e61f6f57538f1bd37d760869","impliedFormat":1},{"version":"76def37aff8e3a051cf406e10340ffba0f28b6991c5d987474cc11137796e1eb","impliedFormat":1},{"version":"b620391fe8060cf9bedc176a4d01366e6574d7a71e0ac0ab344a4e76576fcbb8","impliedFormat":1},{"version":"3e7efde639c6a6c3edb9847b3f61e308bf7a69685b92f665048c45132f51c218","impliedFormat":1},{"version":"df45ca1176e6ac211eae7ddf51336dc075c5314bc5c253651bae639defd5eec5","impliedFormat":1},{"version":"106c6025f1d99fd468fd8bf6e5bda724e11e5905a4076c5d29790b6c3745e50c","impliedFormat":1},{"version":"ee8df1cb8d0faaca4013a1b442e99130769ce06f438d18d510fed95890067563","impliedFormat":1},{"version":"bfb7f8475428637bee12bdd31bd9968c1c8a1cc2c3e426c959e2f3a307f8936f","impliedFormat":1},{"version":"6f491d0108927478d3247bbbc489c78c2da7ef552fd5277f1ab6819986fdf0b1","impliedFormat":1},{"version":"594fe24fc54645ab6ccb9dba15d3a35963a73a395b2ef0375ea34bf181ccfd63","impliedFormat":1},{"version":"7cb0ee103671d1e201cd53dda12bc1cd0a35f1c63d6102720c6eeb322cb8e17e","impliedFormat":1},{"version":"15a234e5031b19c48a69ccc1607522d6e4b50f57d308ecb7fe863d44cd9f9eb3","impliedFormat":1},{"version":"148679c6d0f449210a96e7d2e562d589e56fcde87f843a92808b3ff103f1a774","impliedFormat":1},{"version":"6459054aabb306821a043e02b89d54da508e3a6966601a41e71c166e4ea1474f","impliedFormat":1},{"version":"2f9c89cbb29d362290531b48880a4024f258c6033aaeb7e59fbc62db26819650","impliedFormat":1},{"version":"bb37588926aba35c9283fe8d46ebf4e79ffe976343105f5c6d45f282793352b2","impliedFormat":1},{"version":"05c97cddbaf99978f83d96de2d8af86aded9332592f08ce4a284d72d0952c391","impliedFormat":1},{"version":"72179f9dd22a86deaad4cc3490eb0fe69ee084d503b686985965654013f1391b","impliedFormat":1},{"version":"2e6114a7dd6feeef85b2c80120fdbfb59a5529c0dcc5bfa8447b6996c97a69f5","impliedFormat":1},{"version":"7b6ff760c8a240b40dab6e4419b989f06a5b782f4710d2967e67c695ef3e93c4","impliedFormat":1},{"version":"c8f004e6036aa1c764ad4ec543cf89a5c1893a9535c80ef3f2b653e370de45e6","impliedFormat":1},{"version":"dd80b1e600d00f5c6a6ba23f455b84a7db121219e68f89f10552c54ba46e4dc9","impliedFormat":1},{"version":"b064c36f35de7387d71c599bfcf28875849a1dbc733e82bd26cae3d1cd060521","impliedFormat":1},{"version":"05c7280d72f3ed26f346cbe7cbbbb002fb7f15739197cbbee6ab3fd1a6cb9347","impliedFormat":1},{"version":"8de9fe97fa9e00ec00666fa77ab6e91b35d25af8ca75dabcb01e14ad3299b150","impliedFormat":1},{"version":"803cd2aaf1921c218916c2c7ee3fce653e852d767177eb51047ff15b5b253893","impliedFormat":1},{"version":"dba114fb6a32b355a9cfc26ca2276834d72fe0e94cd2c3494005547025015369","impliedFormat":1},{"version":"7ab12b2f1249187223d11a589f5789c75177a0b597b9eb7f8e2e42d045393347","impliedFormat":1},{"version":"ad37fb4be61c1035b68f532b7220f4e8236cf245381ce3b90ac15449ecfe7305","impliedFormat":1},{"version":"93436bd74c66baba229bfefe1314d122c01f0d4c1d9e35081a0c4f0470ac1a6c","impliedFormat":1},{"version":"f974e4a06953682a2c15d5bd5114c0284d5abf8bc0fe4da25cb9159427b70072","impliedFormat":1},{"version":"50256e9c31318487f3752b7ac12ff365c8949953e04568009c8705db802776fb","impliedFormat":1},{"version":"7d73b24e7bf31dfb8a931ca6c4245f6bb0814dfae17e4b60c9e194a631fe5f7b","impliedFormat":1},{"version":"d130c5f73768de51402351d5dc7d1b36eaec980ca697846e53156e4ea9911476","impliedFormat":1},{"version":"413586add0cfe7369b64979d4ec2ed56c3f771c0667fbde1bf1f10063ede0b08","impliedFormat":1},{"version":"06472528e998d152375ad3bd8ebcb69ff4694fd8d2effaf60a9d9f25a37a097a","impliedFormat":1},{"version":"50b5bc34ce6b12eccb76214b51aadfa56572aa6cc79c2b9455cdbb3d6c76af1d","impliedFormat":1},{"version":"b7e16ef7f646a50991119b205794ebfd3a4d8f8e0f314981ebbe991639023d0e","impliedFormat":1},{"version":"42c169fb8c2d42f4f668c624a9a11e719d5d07dacbebb63cbcf7ef365b0a75b3","impliedFormat":1},{"version":"a401617604fa1f6ce437b81689563dfdc377069e4c58465dbd8d16069aede0a5","impliedFormat":1},{"version":"6e9082e91370de5040e415cd9f24e595b490382e8c7402c4e938a8ce4bccc99f","impliedFormat":1},{"version":"8695dec09ad439b0ceef3776ea68a232e381135b516878f0901ed2ea114fd0fe","impliedFormat":1},{"version":"304b44b1e97dd4c94697c3313df89a578dca4930a104454c99863f1784a54357","impliedFormat":1},{"version":"d682336018141807fb602709e2d95a192828fcb8d5ba06dda3833a8ea98f69e3","impliedFormat":1},{"version":"6124e973eab8c52cabf3c07575204efc1784aca6b0a30c79eb85fe240a857efa","impliedFormat":1},{"version":"0d891735a21edc75df51f3eb995e18149e119d1ce22fd40db2b260c5960b914e","impliedFormat":1},{"version":"3b414b99a73171e1c4b7b7714e26b87d6c5cb03d200352da5342ab4088a54c85","impliedFormat":1},{"version":"4fbd3116e00ed3a6410499924b6403cc9367fdca303e34838129b328058ede40","impliedFormat":1},{"version":"b01bd582a6e41457bc56e6f0f9de4cb17f33f5f3843a7cf8210ac9c18472fb0f","impliedFormat":1},{"version":"0a437ae178f999b46b6153d79095b60c42c996bc0458c04955f1c996dc68b971","impliedFormat":1},{"version":"74b2a5e5197bd0f2e0077a1ea7c07455bbea67b87b0869d9786d55104006784f","impliedFormat":1},{"version":"4a7baeb6325920044f66c0f8e5e6f1f52e06e6d87588d837bdf44feb6f35c664","impliedFormat":1},{"version":"12d218a49dbe5655b911e6cc3c13b2c655e4c783471c3b0432137769c79e1b3c","impliedFormat":1},{"version":"7274fbffbd7c9589d8d0ffba68157237afd5cecff1e99881ea3399127e60572f","impliedFormat":1},{"version":"6b0fc04121360f752d196ba35b6567192f422d04a97b2840d7d85f8b79921c92","impliedFormat":1},{"version":"65a15fc47900787c0bd18b603afb98d33ede930bed1798fc984d5ebb78b26cf9","impliedFormat":1},{"version":"9d202701f6e0744adb6314d03d2eb8fc994798fc83d91b691b75b07626a69801","impliedFormat":1},{"version":"a365c4d3bed3be4e4e20793c999c51f5cd7e6792322f14650949d827fbcd170f","impliedFormat":1},{"version":"c5426dbfc1cf90532f66965a7aa8c1136a78d4d0f96d8180ecbfc11d7722f1a5","impliedFormat":1},{"version":"9c82171d836c47486074e4ca8e059735bf97b205e70b196535b5efd40cbe1bc5","impliedFormat":1},{"version":"f374cb24e93e7798c4d9e83ff872fa52d2cdb36306392b840a6ddf46cb925cb6","impliedFormat":1},{"version":"42b81043b00ff27c6bd955aea0f6e741545f2265978bf364b614702b72a027ab","impliedFormat":1},{"version":"de9d2df7663e64e3a91bf495f315a7577e23ba088f2949d5ce9ec96f44fba37d","impliedFormat":1},{"version":"c7af78a2ea7cb1cd009cfb5bdb48cd0b03dad3b54f6da7aab615c2e9e9d570c5","impliedFormat":1},{"version":"1ee45496b5f8bdee6f7abc233355898e5bf9bd51255db65f5ff7ede617ca0027","impliedFormat":1},{"version":"97e5ccc7bb88419005cbdf812243a5b3186cdef81b608540acabe1be163fc3e4","affectsGlobalScope":true,"impliedFormat":1},{"version":"3fbdd025f9d4d820414417eeb4107ffa0078d454a033b506e22d3a23bc3d9c41","affectsGlobalScope":true,"impliedFormat":1},{"version":"a8f8e6ab2fa07b45251f403548b78eaf2022f3c2254df3dc186cb2671fe4996d","affectsGlobalScope":true,"impliedFormat":1},{"version":"fa6c12a7c0f6b84d512f200690bfc74819e99efae69e4c95c4cd30f6884c526e","impliedFormat":1},{"version":"f1c32f9ce9c497da4dc215c3bc84b722ea02497d35f9134db3bb40a8d918b92b","impliedFormat":1},{"version":"b73c319af2cc3ef8f6421308a250f328836531ea3761823b4cabbd133047aefa","affectsGlobalScope":true,"impliedFormat":1},{"version":"e433b0337b8106909e7953015e8fa3f2d30797cea27141d1c5b135365bb975a6","impliedFormat":1},{"version":"9f9bb6755a8ce32d656ffa4763a8144aa4f274d6b69b59d7c32811031467216e","impliedFormat":1},{"version":"5c32bdfbd2d65e8fffbb9fbda04d7165e9181b08dad61154961852366deb7540","impliedFormat":1},{"version":"ddff7fc6edbdc5163a09e22bf8df7bef75f75369ebd7ecea95ba55c4386e2441","impliedFormat":1},{"version":"6b3453eebd474cc8acf6d759f1668e6ce7425a565e2996a20b644c72916ecf75","impliedFormat":1},{"version":"0c05e9842ec4f8b7bfebfd3ca61604bb8c914ba8da9b5337c4f25da427a005f2","impliedFormat":1},{"version":"89cd3444e389e42c56fd0d072afef31387e7f4107651afd2c03950f22dc36f77","impliedFormat":1},{"version":"7f2aa4d4989a82530aaac3f72b3dceca90e9c25bee0b1a327e8a08a1262435ad","impliedFormat":1},{"version":"e39a304f882598138a8022106cb8de332abbbb87f3fee71c5ca6b525c11c51fc","impliedFormat":1},{"version":"faed7a5153215dbd6ebe76dfdcc0af0cfe760f7362bed43284be544308b114cf","impliedFormat":1},{"version":"fcdf3e40e4a01b9a4b70931b8b51476b210c511924fcfe3f0dae19c4d52f1a54","impliedFormat":1},{"version":"345c4327b637d34a15aba4b7091eb068d6ab40a3dedaab9f00986253c9704e53","impliedFormat":1},{"version":"3a788c7fb7b1b1153d69a4d1d9e1d0dfbcf1127e703bdb02b6d12698e683d1fb","impliedFormat":1},{"version":"2e4f37ffe8862b14d8e24ae8763daaa8340c0df0b859d9a9733def0eee7562d9","impliedFormat":1},{"version":"d38530db0601215d6d767f280e3a3c54b2a83b709e8d9001acb6f61c67e965fc","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"4805f6161c2c8cefb8d3b8bd96a080c0fe8dbc9315f6ad2e53238f9a79e528a6","impliedFormat":1},{"version":"b83cb14474fa60c5f3ec660146b97d122f0735627f80d82dd03e8caa39b4388c","impliedFormat":1},{"version":"2b5b70d7782fe028487a80a1c214e67bd610532b9f978b78fa60f5b4a359f77e","impliedFormat":1},{"version":"7ee86fbb3754388e004de0ef9e6505485ddfb3be7640783d6d015711c03d302d","impliedFormat":1},{"version":"1a82deef4c1d39f6882f28d275cad4c01f907b9b39be9cbc472fcf2cf051e05b","impliedFormat":1},{"version":"7580e62139cb2b44a0270c8d01abcbfcba2819a02514a527342447fa69b34ef1","impliedFormat":1},{"version":"b73cbf0a72c8800cf8f96a9acfe94f3ad32ca71342a8908b8ae484d61113f647","impliedFormat":1},{"version":"bae6dd176832f6423966647382c0d7ba9e63f8c167522f09a982f086cd4e8b23","impliedFormat":1},{"version":"20865ac316b8893c1a0cc383ccfc1801443fbcc2a7255be166cf90d03fac88c9","impliedFormat":1},{"version":"c9958eb32126a3843deedda8c22fb97024aa5d6dd588b90af2d7f2bfac540f23","impliedFormat":1},{"version":"461d0ad8ae5f2ff981778af912ba71b37a8426a33301daa00f21c6ccb27f8156","impliedFormat":1},{"version":"e927c2c13c4eaf0a7f17e6022eee8519eb29ef42c4c13a31e81a611ab8c95577","impliedFormat":1},{"version":"fcafff163ca5e66d3b87126e756e1b6dfa8c526aa9cd2a2b0a9da837d81bbd72","impliedFormat":1},{"version":"70246ad95ad8a22bdfe806cb5d383a26c0c6e58e7207ab9c431f1cb175aca657","impliedFormat":1},{"version":"f00f3aa5d64ff46e600648b55a79dcd1333458f7a10da2ed594d9f0a44b76d0b","impliedFormat":1},{"version":"772d8d5eb158b6c92412c03228bd9902ccb1457d7a705b8129814a5d1a6308fc","impliedFormat":1},{"version":"802e797bcab5663b2c9f63f51bdf67eff7c41bc64c0fd65e6da3e7941359e2f7","impliedFormat":1},{"version":"8b4327413e5af38cd8cb97c59f48c3c866015d5d642f28518e3a891c469f240e","impliedFormat":1},{"version":"7e6ac205dcb9714f708354fd863bffa45cee90740706cc64b3b39b23ebb84744","impliedFormat":1},{"version":"61dc6e3ac78d64aa864eedd0a208b97b5887cc99c5ba65c03287bf57d83b1eb9","impliedFormat":1},{"version":"4b20fcf10a5413680e39f5666464859fc56b1003e7dfe2405ced82371ebd49b6","impliedFormat":1},{"version":"c06ef3b2569b1c1ad99fcd7fe5fba8d466e2619da5375dfa940a94e0feea899b","impliedFormat":1},{"version":"f7d628893c9fa52ba3ab01bcb5e79191636c4331ee5667ecc6373cbccff8ae12","impliedFormat":1},{"version":"1d879125d1ec570bf04bc1f362fdbe0cb538315c7ac4bcfcdf0c1e9670846aa6","impliedFormat":1},{"version":"f730b468deecf26188ad62ee8950dc29aa2aea9543bb08ed714c3db019359fd9","impliedFormat":1},{"version":"933aee906d42ea2c53b6892192a8127745f2ec81a90695df4024308ba35a8ff4","impliedFormat":1},{"version":"d663134457d8d669ae0df34eabd57028bddc04fc444c4bc04bc5215afc91e1f4","impliedFormat":1},{"version":"144bc326e90b894d1ec78a2af3ffb2eb3733f4d96761db0ca0b6239a8285f972","impliedFormat":1},{"version":"a3e3f0efcae272ab8ee3298e4e819f7d9dd9ff411101f45444877e77cfeca9a4","impliedFormat":1},{"version":"43e96a3d5d1411ab40ba2f61d6a3192e58177bcf3b133a80ad2a16591611726d","impliedFormat":1},{"version":"58659b06d33fa430bee1105b75cf876c0a35b2567207487c8578aec51ca2d977","impliedFormat":1},{"version":"71d9eb4c4e99456b78ae182fb20a5dfc20eb1667f091dbb9335b3c017dd1c783","impliedFormat":1},{"version":"cfa846a7b7847a1d973605fbb8c91f47f3a0f0643c18ac05c47077ebc72e71c7","impliedFormat":1},{"version":"30e6520444df1a004f46fdc8096f3fe06f7bbd93d09c53ada9dcdde59919ccca","impliedFormat":1},{"version":"6c800b281b9e89e69165fd11536195488de3ff53004e55905e6c0059a2d8591e","impliedFormat":1},{"version":"7d4254b4c6c67a29d5e7f65e67d72540480ac2cfb041ca484847f5ae70480b62","impliedFormat":1},{"version":"a58beefce74db00dbb60eb5a4bb0c6726fb94c7797c721f629142c0ae9c94306","impliedFormat":1},{"version":"41eeb453ccb75c5b2c3abef97adbbd741bd7e9112a2510e12f03f646dc9ad13d","impliedFormat":1},{"version":"502fa5863df08b806dbf33c54bee8c19f7e2ad466785c0fc35465d7c5ff80995","impliedFormat":1},{"version":"c91a2d08601a1547ffef326201be26db94356f38693bb18db622ae5e9b3d7c92","impliedFormat":1},{"version":"888cda0fa66d7f74e985a3f7b1af1f64b8ff03eb3d5e80d051c3cbdeb7f32ab7","impliedFormat":1},{"version":"60681e13f3545be5e9477acb752b741eae6eaf4cc01658a25ec05bff8b82a2ef","impliedFormat":1},{"version":"9586918b63f24124a5ca1d0cc2979821a8a57f514781f09fc5aa9cae6d7c0138","impliedFormat":1},{"version":"a57b1802794433adec9ff3fed12aa79d671faed86c49b09e02e1ac41b4f1d33a","impliedFormat":1},{"version":"ad10d4f0517599cdeca7755b930f148804e3e0e5b5a3847adce0f1f71bbccd74","impliedFormat":1},{"version":"1042064ece5bb47d6aba91648fbe0635c17c600ebdf567588b4ca715602f0a9d","impliedFormat":1},{"version":"c49469a5349b3cc1965710b5b0f98ed6c028686aa8450bcb3796728873eb923e","impliedFormat":1},{"version":"4a889f2c763edb4d55cb624257272ac10d04a1cad2ed2948b10ed4a7fda2a428","impliedFormat":1},{"version":"7bb79aa2fead87d9d56294ef71e056487e848d7b550c9a367523ee5416c44cfa","impliedFormat":1},{"version":"d88ea80a6447d7391f52352ec97e56b52ebec934a4a4af6e2464cfd8b39c3ba8","impliedFormat":1},{"version":"55095860901097726220b6923e35a812afdd49242a1246d7b0942ee7eb34c6e4","impliedFormat":1},{"version":"96171c03c2e7f314d66d38acd581f9667439845865b7f85da8df598ff9617476","impliedFormat":1},{"version":"27ff4196654e6373c9af16b6165120e2dd2169f9ad6abb5c935af5abd8c7938c","impliedFormat":1},{"version":"bb8f2dbc03533abca2066ce4655c119bff353dd4514375beb93c08590c03e023","impliedFormat":1},{"version":"d193c8a86144b3a87b22bc1f5534b9c3e0f5a187873ec337c289a183973a58fe","impliedFormat":1},{"version":"1a6e6ba8a07b74e3ad237717c0299d453f9ceb795dbc2f697d1f2dd07cb782d2","impliedFormat":1},{"version":"58d70c38037fc0f949243388ff7ae20cf43321107152f14a9d36ca79311e0ada","impliedFormat":1},{"version":"f56bdc6884648806d34bc66d31cdb787c4718d04105ce2cd88535db214631f82","impliedFormat":1},{"version":"190da5eac6478d61ab9731ab2146fbc0164af2117a363013249b7e7992f1cccb","impliedFormat":1},{"version":"01479d9d5a5dda16d529b91811375187f61a06e74be294a35ecce77e0b9e8d6c","impliedFormat":1},{"version":"49f95e989b4632c6c2a578cc0078ee19a5831832d79cc59abecf5160ea71abad","impliedFormat":1},{"version":"9666533332f26e8995e4d6fe472bdeec9f15d405693723e6497bf94120c566c8","impliedFormat":1},{"version":"ce0df82a9ae6f914ba08409d4d883983cc08e6d59eb2df02d8e4d68309e7848b","impliedFormat":1},{"version":"796273b2edc72e78a04e86d7c58ae94d370ab93a0ddf40b1aa85a37a1c29ecd7","impliedFormat":1},{"version":"5df15a69187d737d6d8d066e189ae4f97e41f4d53712a46b2710ff9f8563ec9f","impliedFormat":1},{"version":"1a4dc28334a926d90ba6a2d811ba0ff6c22775fcc13679521f034c124269fd40","impliedFormat":1},{"version":"f05315ff85714f0b87cc0b54bcd3dde2716e5a6b99aedcc19cad02bf2403e08c","impliedFormat":1},{"version":"8a8c64dafaba11c806efa56f5c69f611276471bef80a1db1f71316ec4168acef","impliedFormat":1},{"version":"43ba4f2fa8c698f5c304d21a3ef596741e8e85a810b7c1f9b692653791d8d97a","impliedFormat":1},{"version":"5fad3b31fc17a5bc58095118a8b160f5260964787c52e7eb51e3d4fcf5d4a6f0","impliedFormat":1},{"version":"72105519d0390262cf0abe84cf41c926ade0ff475d35eb21307b2f94de985778","impliedFormat":1},{"version":"d0a4cac61fa080f2be5ebb68b82726be835689b35994ba0e22e3ed4d2bc45e3b","impliedFormat":1},{"version":"c857e0aae3f5f444abd791ec81206020fbcc1223e187316677e026d1c1d6fe08","impliedFormat":1},{"version":"ccf6dd45b708fb74ba9ed0f2478d4eb9195c9dfef0ff83a6092fa3cf2ff53b4f","impliedFormat":1},{"version":"2d7db1d73456e8c5075387d4240c29a2a900847f9c1bff106a2e490da8fbd457","impliedFormat":1},{"version":"2b15c805f48e4e970f8ec0b1915f22d13ca6212375e8987663e2ef5f0205e832","impliedFormat":1},{"version":"205a31b31beb7be73b8df18fcc43109cbc31f398950190a0967afc7a12cb478c","impliedFormat":1},{"version":"8fca3039857709484e5893c05c1f9126ab7451fa6c29e19bb8c2411a2e937345","impliedFormat":1},{"version":"35069c2c417bd7443ae7c7cafd1de02f665bf015479fec998985ffbbf500628c","impliedFormat":1},{"version":"dba6c7006e14a98ec82999c6f89fbbbfd1c642f41db148535f3b77b8018829b8","impliedFormat":1},{"version":"7f897b285f22a57a5c4dc14a27da2747c01084a542b4d90d33897216dceeea2e","impliedFormat":1},{"version":"7e0b7f91c5ab6e33f511efc640d36e6f933510b11be24f98836a20a2dc914c2d","impliedFormat":1},{"version":"045b752f44bf9bbdcaffd882424ab0e15cb8d11fa94e1448942e338c8ef19fba","impliedFormat":1},{"version":"2894c56cad581928bb37607810af011764a2f511f575d28c9f4af0f2ef02d1ab","impliedFormat":1},{"version":"0a72186f94215d020cb386f7dca81d7495ab6c17066eb07d0f44a5bf33c1b21a","impliedFormat":1},{"version":"d96b39301d0ded3f1a27b47759676a33a02f6f5049bfcbde81e533fd10f50dcb","impliedFormat":1},{"version":"2ded4f930d6abfaa0625cf55e58f565b7cbd4ab5b574dd2cb19f0a83a2f0be8b","impliedFormat":1},{"version":"0aedb02516baf3e66b2c1db9fef50666d6ed257edac0f866ea32f1aa05aa474f","impliedFormat":1},{"version":"ca0f4d9068d652bad47e326cf6ba424ac71ab866e44b24ddb6c2bd82d129586a","affectsGlobalScope":true,"impliedFormat":1},{"version":"04d36005fcbeac741ac50c421181f4e0316d57d148d37cc321a8ea285472462b","impliedFormat":1},{"version":"9e2739b32f741859263fdba0244c194ca8e96da49b430377930b8f721d77c000","impliedFormat":1},{"version":"56ccb49443bfb72e5952f7012f0de1a8679f9f75fc93a5c1ac0bafb28725fc5f","impliedFormat":1},{"version":"20fa37b636fdcc1746ea0738f733d0aed17890d1cd7cb1b2f37010222c23f13e","impliedFormat":1},{"version":"d90b9f1520366d713a73bd30c5a9eb0040d0fb6076aff370796bc776fd705943","impliedFormat":1},{"version":"bef86adb77316505c6b471da1d9b8c9e428867c2566270e8894d4d773a1c4dc2","impliedFormat":1},{"version":"a46dba563f70f32f9e45ae015f3de979225f668075d7a427f874e0f6db584991","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"2652448ac55a2010a1f71dd141f828b682298d39728f9871e1cdf8696ef443fd","impliedFormat":1},{"version":"02c4fc9e6bb27545fa021f6056e88ff5fdf10d9d9f1467f1d10536c6e749ac50","impliedFormat":1},{"version":"120599fd965257b1f4d0ff794bc696162832d9d8467224f4665f713a3119078b","impliedFormat":1},{"version":"5433f33b0a20300cca35d2f229a7fc20b0e8477c44be2affeb21cb464af60c76","impliedFormat":1},{"version":"db036c56f79186da50af66511d37d9fe77fa6793381927292d17f81f787bb195","impliedFormat":1},{"version":"bd4131091b773973ca5d2326c60b789ab1f5e02d8843b3587effe6e1ea7c9d86","impliedFormat":1},{"version":"c7f6485931085bf010fbaf46880a9b9ec1a285ad9dc8c695a9e936f5a48f34b4","impliedFormat":1},{"version":"14f6b927888a1112d662877a5966b05ac1bf7ed25d6c84386db4c23c95a5363b","impliedFormat":1},{"version":"6ac6715916fa75a1f7ebdfeacac09513b4d904b667d827b7535e84ff59679aff","impliedFormat":1},{"version":"622694a8522b46f6310c2a9b5d2530dde1e2854cb5829354e6d1ff8f371cf469","impliedFormat":1},{"version":"d24ff95760ea2dfcc7c57d0e269356984e7046b7e0b745c80fea71559f15bdd8","impliedFormat":1},{"version":"a9e6c0ff3f8186fccd05752cf75fc94e147c02645087ac6de5cc16403323d870","impliedFormat":1},{"version":"49c346823ba6d4b12278c12c977fb3a31c06b9ca719015978cb145eb86da1c61","impliedFormat":1},{"version":"bfac6e50eaa7e73bb66b7e052c38fdc8ccfc8dbde2777648642af33cf349f7f1","impliedFormat":1},{"version":"92f7c1a4da7fbfd67a2228d1687d5c2e1faa0ba865a94d3550a3941d7527a45d","impliedFormat":1},{"version":"f53b120213a9289d9a26f5af90c4c686dd71d91487a0aa5451a38366c70dc64b","impliedFormat":1},{"version":"83fe880c090afe485a5c02262c0b7cdd76a299a50c48d9bde02be8e908fb4ae6","impliedFormat":1},{"version":"13c1b657932e827a7ed510395d94fc8b743b9d053ab95b7cd829b2bc46fb06db","impliedFormat":1},{"version":"57d67b72e06059adc5e9454de26bbfe567d412b962a501d263c75c2db430f40e","impliedFormat":1},{"version":"6511e4503cf74c469c60aafd6589e4d14d5eb0a25f9bf043dcbecdf65f261972","impliedFormat":1},{"version":"078131f3a722a8ad3fc0b724cd3497176513cdcb41c80f96a3acbda2a143b58e","impliedFormat":1},{"version":"8c70ddc0c22d85e56011d49fddfaae3405eb53d47b59327b9dd589e82df672e7","impliedFormat":1},{"version":"a67b87d0281c97dfc1197ef28dfe397fc2c865ccd41f7e32b53f647184cc7307","impliedFormat":1},{"version":"771ffb773f1ddd562492a6b9aaca648192ac3f056f0e1d997678ff97dbb6bf9b","impliedFormat":1},{"version":"232f70c0cf2b432f3a6e56a8dc3417103eb162292a9fd376d51a3a9ea5fbbf6f","impliedFormat":1},{"version":"9e155d2255348d950b1f65643fb26c0f14f5109daf8bd9ee24a866ad0a743648","affectsGlobalScope":true,"impliedFormat":1},{"version":"0b103e9abfe82d14c0ad06a55d9f91d6747154ef7cacc73cf27ecad2bfb3afcf","impliedFormat":1},{"version":"7a883e9c84e720810f86ef4388f54938a65caa0f4d181a64e9255e847a7c9f51","impliedFormat":1},{"version":"a0ba218ac1baa3da0d5d9c1ec1a7c2f8676c284e6f5b920d6d049b13fa267377","impliedFormat":1},{"version":"8a0e762ceb20c7e72504feef83d709468a70af4abccb304f32d6b9bac1129b2c","impliedFormat":1},{"version":"d408d6f32de8d1aba2ff4a20f1aa6a6edd7d92c997f63b90f8ad3f9017cf5e46","impliedFormat":1},{"version":"9252d498a77517aab5d8d4b5eb9d71e4b225bbc7123df9713e08181de63180f6","impliedFormat":1},{"version":"b1f1d57fde8247599731b24a733395c880a6561ec0c882efaaf20d7df968c5af","impliedFormat":1},{"version":"9d622ea608d43eb463c0c4538fd5baa794bc18ea0bb8e96cd2ab6fd483d55fe2","impliedFormat":1},{"version":"35e6379c3f7cb27b111ad4c1aa69538fd8e788ab737b8ff7596a1b40e96f4f90","impliedFormat":1},{"version":"1fffe726740f9787f15b532e1dc870af3cd964dbe29e191e76121aa3dd8693f2","impliedFormat":1},{"version":"371bf6127c1d427836de95197155132501cb6b69ef8709176ce6e0b85d059264","impliedFormat":1},{"version":"2bafd700e617d3693d568e972d02b92224b514781f542f70d497a8fdf92d52a2","affectsGlobalScope":true,"impliedFormat":1},{"version":"5542d8a7ea13168cb573be0d1ba0d29460d59430fb12bb7bf4674efd5604e14c","impliedFormat":1},{"version":"af48e58339188d5737b608d41411a9c054685413d8ae88b8c1d0d9bfabdf6e7e","impliedFormat":1},{"version":"616775f16134fa9d01fc677ad3f76e68c051a056c22ab552c64cc281a9686790","impliedFormat":1},{"version":"65c24a8baa2cca1de069a0ba9fba82a173690f52d7e2d0f1f7542d59d5eb4db0","impliedFormat":1},{"version":"f9fe6af238339a0e5f7563acee3178f51db37f32a2e7c09f85273098cee7ec49","impliedFormat":1},{"version":"1de8c302fd35220d8f29dea378a4ae45199dc8ff83ca9923aca1400f2b28848a","impliedFormat":1},{"version":"77e71242e71ebf8528c5802993697878f0533db8f2299b4d36aa015bae08a79c","impliedFormat":1},{"version":"98a787be42bd92f8c2a37d7df5f13e5992da0d967fab794adbb7ee18370f9849","impliedFormat":1},{"version":"332248ee37cca52903572e66c11bef755ccc6e235835e63d3c3e60ddda3e9b93","impliedFormat":1},{"version":"94e8cc88ae2ef3d920bb3bdc369f48436db123aa2dc07f683309ad8c9968a1e1","impliedFormat":1},{"version":"4545c1a1ceca170d5d83452dd7c4994644c35cf676a671412601689d9a62da35","impliedFormat":1},{"version":"320f4091e33548b554d2214ce5fc31c96631b513dffa806e2e3a60766c8c49d9","impliedFormat":1},{"version":"a2d648d333cf67b9aeac5d81a1a379d563a8ffa91ddd61c6179f68de724260ff","impliedFormat":1},{"version":"d90d5f524de38889d1e1dbc2aeef00060d779f8688c02766ddb9ca195e4a713d","impliedFormat":1},{"version":"a3f41ed1b4f2fc3049394b945a68ae4fdefd49fa1739c32f149d32c0545d67f5","impliedFormat":1},{"version":"b0309e1eda99a9e76f87c18992d9c3689b0938266242835dd4611f2b69efe456","impliedFormat":1},{"version":"47699512e6d8bebf7be488182427189f999affe3addc1c87c882d36b7f2d0b0e","impliedFormat":1},{"version":"6ceb10ca57943be87ff9debe978f4ab73593c0c85ee802c051a93fc96aaf7a20","impliedFormat":1},{"version":"1de3ffe0cc28a9fe2ac761ece075826836b5a02f340b412510a59ba1d41a505a","impliedFormat":1},{"version":"e46d6cc08d243d8d0d83986f609d830991f00450fb234f5b2f861648c42dc0d8","impliedFormat":1},{"version":"1c0a98de1323051010ce5b958ad47bc1c007f7921973123c999300e2b7b0ecc0","impliedFormat":1},{"version":"ff863d17c6c659440f7c5c536e4db7762d8c2565547b2608f36b798a743606ca","impliedFormat":1},{"version":"5412ad0043cd60d1f1406fc12cb4fb987e9a734decbdd4db6f6acf71791e36fe","impliedFormat":1},{"version":"ad036a85efcd9e5b4f7dd5c1a7362c8478f9a3b6c3554654ca24a29aa850a9c5","impliedFormat":1},{"version":"fedebeae32c5cdd1a85b4e0504a01996e4a8adf3dfa72876920d3dd6e42978e7","impliedFormat":1},{"version":"b6c1f64158da02580f55e8a2728eda6805f79419aed46a930f43e68ad66a38fc","impliedFormat":1},{"version":"cdf21eee8007e339b1b9945abf4a7b44930b1d695cc528459e68a3adc39a622e","impliedFormat":1},{"version":"bc9ee0192f056b3d5527bcd78dc3f9e527a9ba2bdc0a2c296fbc9027147df4b2","impliedFormat":1},{"version":"330896c1a2b9693edd617be24fbf9e5895d6e18c7955d6c08f028f272b37314d","impliedFormat":1},{"version":"1d9c0a9a6df4e8f29dc84c25c5aa0bb1da5456ebede7a03e03df08bb8b27bae6","impliedFormat":1},{"version":"84380af21da938a567c65ef95aefb5354f676368ee1a1cbb4cae81604a4c7d17","impliedFormat":1},{"version":"1af3e1f2a5d1332e136f8b0b95c0e6c0a02aaabd5092b36b64f3042a03debf28","impliedFormat":1},{"version":"30d8da250766efa99490fc02801047c2c6d72dd0da1bba6581c7e80d1d8842a4","impliedFormat":1},{"version":"03566202f5553bd2d9de22dfab0c61aa163cabb64f0223c08431fb3fc8f70280","impliedFormat":1},{"version":"4c0a1233155afb94bd4d7518c75c84f98567cd5f13fc215d258de196cdb40d91","impliedFormat":1},{"version":"e7765aa8bcb74a38b3230d212b4547686eb9796621ffb4367a104451c3f9614f","impliedFormat":1},{"version":"1de80059b8078ea5749941c9f863aa970b4735bdbb003be4925c853a8b6b4450","impliedFormat":1},{"version":"1d079c37fa53e3c21ed3fa214a27507bda9991f2a41458705b19ed8c2b61173d","impliedFormat":1},{"version":"5bf5c7a44e779790d1eb54c234b668b15e34affa95e78eada73e5757f61ed76a","impliedFormat":1},{"version":"5835a6e0d7cd2738e56b671af0e561e7c1b4fb77751383672f4b009f4e161d70","impliedFormat":1},{"version":"5c634644d45a1b6bc7b05e71e05e52ec04f3d73d9ac85d5927f647a5f965181a","impliedFormat":1},{"version":"4b7f74b772140395e7af67c4841be1ab867c11b3b82a51b1aeb692822b76c872","impliedFormat":1},{"version":"27be6622e2922a1b412eb057faa854831b95db9db5035c3f6d4b677b902ab3b7","impliedFormat":1},{"version":"a68d4b3182e8d776cdede7ac9630c209a7bfbb59191f99a52479151816ef9f9e","impliedFormat":99},{"version":"39644b343e4e3d748344af8182111e3bbc594930fff0170256567e13bbdbebb0","impliedFormat":99},{"version":"ed7fd5160b47b0de3b1571c5c5578e8e7e3314e33ae0b8ea85a895774ee64749","impliedFormat":99},{"version":"63a7595a5015e65262557f883463f934904959da563b4f788306f699411e9bac","impliedFormat":1},{"version":"4ba137d6553965703b6b55fd2000b4e07ba365f8caeb0359162ad7247f9707a6","impliedFormat":1},{"version":"6de125ea94866c736c6d58d68eb15272cf7d1020a5b459fea1c660027eca9a90","affectsGlobalScope":true,"impliedFormat":1},{"version":"8fac4a15690b27612d8474fb2fc7cc00388df52d169791b78d1a3645d60b4c8b","affectsGlobalScope":true,"impliedFormat":1},{"version":"064ac1c2ac4b2867c2ceaa74bbdce0cb6a4c16e7c31a6497097159c18f74aa7c","impliedFormat":1},{"version":"3dc14e1ab45e497e5d5e4295271d54ff689aeae00b4277979fdd10fa563540ae","impliedFormat":1},{"version":"d3b315763d91265d6b0e7e7fa93cfdb8a80ce7cdd2d9f55ba0f37a22db00bdb8","impliedFormat":1},{"version":"b789bf89eb19c777ed1e956dbad0925ca795701552d22e68fd130a032008b9f9","impliedFormat":1},{"version":"03ebc05a7963d587a0d9d40a52b59f657097e486b091e40e3f35f53471ec32ca","affectsGlobalScope":true},"083e23c4c5e7761db151134ea1ef7896120c86c5888cdc8a861f534f7e86d6fd",{"version":"c1a2e05eb6d7ca8d7e4a7f4c93ccf0c2857e842a64c98eaee4d85841ee9855e6","impliedFormat":1},{"version":"835fb2909ce458740fb4a49fc61709896c6864f5ce3db7f0a88f06c720d74d02","impliedFormat":1},{"version":"6e5857f38aa297a859cab4ec891408659218a5a2610cd317b6dcbef9979459cc","impliedFormat":1},{"version":"ead8e39c2e11891f286b06ae2aa71f208b1802661fcdb2425cffa4f494a68854","impliedFormat":1},{"version":"82919acbb38870fcf5786ec1292f0f5afe490f9b3060123e48675831bd947192","impliedFormat":1},{"version":"e222701788ec77bd57c28facbbd142eadf5c749a74d586bc2f317db7e33544b1","impliedFormat":1},{"version":"09154713fae0ed7befacdad783e5bd1970c06fc41a5f866f7f933b96312ce764","impliedFormat":1},{"version":"8d67b13da77316a8a2fabc21d340866ddf8a4b99e76a6c951cc45189142df652","impliedFormat":1},{"version":"a91c8d28d10fee7fe717ddf3743f287b68770c813c98f796b6e38d5d164bd459","impliedFormat":1},{"version":"68add36d9632bc096d7245d24d6b0b8ad5f125183016102a3dad4c9c2438ccb0","impliedFormat":1},{"version":"3a819c2928ee06bbcc84e2797fd3558ae2ebb7e0ed8d87f71732fb2e2acc87b4","impliedFormat":1},{"version":"f6f827cd43e92685f194002d6b52a9408309cda1cec46fb7ca8489a95cbd2fd4","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"e0bfe601a9fdf6defe94ed62dc60ac71597566001a1f86e705c95e431a9c816d","impliedFormat":1},{"version":"a270a1a893d1aee5a3c1c8c276cd2778aa970a2741ee2ccf29cc3210d7da80f5","impliedFormat":1},{"version":"add0ce7b77ba5b308492fa68f77f24d1ed1d9148534bdf05ac17c30763fc1a79","impliedFormat":1},{"version":"8926594ee895917e90701d8cbb5fdf77fc238b266ac540f929c7253f8ad6233d","impliedFormat":1},{"version":"2f67911e4bf4e0717dc2ded248ce2d5e4398d945ee13889a6852c1233ea41508","impliedFormat":1},{"version":"d8430c275b0f59417ea8e173cfb888a4477b430ec35b595bf734f3ec7a7d729f","impliedFormat":1},{"version":"69364df1c776372d7df1fb46a6cb3a6bf7f55e700f533a104e3f9d70a32bec18","impliedFormat":1},{"version":"6042774c61ece4ba77b3bf375f15942eb054675b7957882a00c22c0e4fe5865c","impliedFormat":1},{"version":"5a3bd57ed7a9d9afef74c75f77fce79ba3c786401af9810cdf45907c4e93f30e","impliedFormat":1},{"version":"ed8763205f02fb65e84eff7432155258df7f93b7d938f01785cb447d043d53f3","impliedFormat":1},{"version":"30db853bb2e60170ba11e39ab48bacecb32d06d4def89eedf17e58ebab762a65","impliedFormat":1},{"version":"e27451b24234dfed45f6cf22112a04955183a99c42a2691fb4936d63cfe42761","impliedFormat":1},{"version":"2316301dd223d31962d917999acf8e543e0119c5d24ec984c9f22cb23247160c","impliedFormat":1},{"version":"58d65a2803c3b6629b0e18c8bf1bc883a686fcf0333230dd0151ab6e85b74307","impliedFormat":1},{"version":"e818471014c77c103330aee11f00a7a00b37b35500b53ea6f337aefacd6174c9","impliedFormat":1},{"version":"d4a5b1d2ff02c37643e18db302488cd64c342b00e2786e65caac4e12bda9219b","impliedFormat":1},{"version":"29f823cbe0166e10e7176a94afe609a24b9e5af3858628c541ff8ce1727023cd","impliedFormat":1},{"version":"3b2c14992bef93e92900ca1eb5ec14460abd1ec073d1ab60db8fb8b6f71776a5","signature":"4a12d1be53a64e71cc827aad462b605ffeadba445f2de96e125d16caf927b857"},{"version":"a61f1ae31ad652c093e4a0ca1fcce73ab28f08307a661f9bee0e5f05a3264df6","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"156df1956df1b09fe9cef0ab499d979199640de1ce39e752da03f639e201d01f","signature":"04aebff943e6afdfdce920c8f2fa8266058e9653b3647522ca8b74e1d1f843e5"},{"version":"39a2a62addfd6abdeebbd9552146e553eed77a5a4b86a396d38cef5644882fed","signature":"45b7414bcfdd2d420eb761d4e5186860446d3229f55d7b19c2877ec434764860"},{"version":"df5640dbd11715da31aa2b3de23fe886689b760fd309b269f3d8d31ead983407","signature":"82c88184838d7ad2b6568dd57d6310a5fb0c694c6433065581ff81954785445b"},{"version":"0dba7c8c3bfb54fef4280e1c74e6a42f700a14375622ae7e5fd7980ef4adf59a","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"90100592dc80ac01b31e813547080257ed6098cecff4590d21b36961448d1019","signature":"287c8afed902d8ec2e8699aa04250712d03b8918dd4995ed5a78aa43a8939576"},{"version":"d0e8f73a2896e2fc845fcec14d97f134d73b939ad9263918e4824a656b0341de","signature":"c0e37849a0a74071798a361e058fe6e6ba838f4aac35c265da473f4792a7233f"},{"version":"6802979e9c5afc2a0408eb8b8f71229697cf1a8a6ec8aa4983587f0b4f7949f8","signature":"c16a15176846d46e2161b438aa8d7bfc8582cabcb5ae4bfd48b5d97b4a33e191"},{"version":"9d867875a873697f682388cf409a57e50cc0ef4eee1a98c67e0f7916b537809a","signature":"6397eee950b3475537853d32c92f5eaa3183d9b66358bbae93785045021d97c7"},{"version":"75b423966f4dd8650b09bcef0c66c8e2c160347bee0bdf20c103a3b052b62495","signature":"5d2a38896c007ec08978181d9c8e68ad44db016a3b54283ae73f2dbda6e7e43c"},{"version":"2c551dcd83dc6621732420292199ba9e82c736e1835abacf0c51cfa296e79d9a","signature":"892d5662e38dd1fe3eeb68cbdcbbcc49ab0ce771ab99e8b54b4397f1ff9349fc"},{"version":"e3c326ff543e675972a4308da4e2bfa18cdf119f944574c1dfc01930442eae36","signature":"d859d8451e569f2b1baf138da0e55e3f648cf908e4f13fc9df21549615b66c99"},{"version":"490b4ecc5ce76bf946c0b5b4878a27a7db7368ede7c3c3a64b9631cec09c2568","signature":"0bfa308681b4de3c3e334a52657e7f312024b59f2abb98f0a15ab3746805c0a3"},{"version":"4e5d20a3b3a44e6dffbe69f6becaadf521f03e82083e7d93680a799247cbd683","signature":"ef70b313382d8998d58357b883a9add5d87312d5a071d05516ffd398abd13850"},{"version":"fdd8a58d421628aee20699f760dad068893419a8bbf9ffe5f324f71fb4de4fcb","signature":"2d3bfef16acd20db68c8581e891b349ce4206e31ad614b64445ab72c3fac6479"},{"version":"7aa23d86a74172d795067fad829d612fcd8074ca3e07e0ce5ab3eadbe9371fbd","signature":"be3ddf16d572c33a688b39a341f770f9076a91d611785885f9be18632fb1009a"},{"version":"40bf7e4654c0aefb47c76af7596d8b26667c53d77273afc91930266b91a1160e","signature":"bc7052013663747ca394b3231eea152c5f4b7ce8805219d50e7160ca07d169cf"},{"version":"9fc4de6cf030716f29e7d7449e506963953fc46ec52eeaf9e232a703282a4e35","signature":"f1921c0974a27843d7cf7b8cbc366dab3fe7e9e515acd8dd970de6892230054d"},{"version":"543546703d5b282757d7f60163280b8a497ed1c243002367776843fa96be14e2","signature":"6cb7736b1d5735a0d77f6f80ce1cfc21c850c08d86fd695f024bd62bab71e24a"},{"version":"432854c3bc49d12cc63e71d1dafb1fcd3e16ebd4c7addb7aa5e1489c40a6dc1c","signature":"1aa7cf949858c2712139862667c41715010a1a8ea78d7c30f73ee97d095899d4"},{"version":"4d7d964609a07368d076ce943b07106c5ebee8138c307d3273ba1cf3a0c3c751","impliedFormat":99},{"version":"68219da40672405b0632a0a544d1319b5bfe3fa0401f1283d4c9854b0cc114ce","impliedFormat":99},{"version":"80f36ebdba6594b9fd3405fe23571834f28e2da91d6bbf0618387e7bb54886e4","impliedFormat":99},{"version":"7841bca23a8296afd82fd036fc8d3b1fed3c1e0c82ee614254693ccd47e916fc","impliedFormat":99},{"version":"b09c433ed46538d0dc7e40f49a9bf532712221219761a0f389e60349c59b3932","impliedFormat":99},{"version":"0ece7a73f176d90d3776e930c392048ddbf56d8f374b47be5438da343e387113","impliedFormat":99},{"version":"0bb0e644293820a5cc705591150eb1b49ae6b2349636206079aa248333564267","impliedFormat":99},{"version":"4b6a9eda3909125e26a88e76f2906be6735ccff4776a29e68183dd051208273a","impliedFormat":99},{"version":"9f32c96aee57735902b5c294dc8f545fcb76f7adf3deb5cf07c9b70cf238be0e","signature":"7590e1275357e1a4bdd287b237128953fc47fba5fb2e0155a547920d044686d2"},{"version":"0e48c1354203ba2ca366b62a0f22fec9e10c251d9d6420c6d435da1d079e6126","impliedFormat":99},{"version":"0662a451f0584bb3026340c3661c3a89774182976cd373eca502a1d3b5c7b580","impliedFormat":99},{"version":"919b9e870a8ffb7d337656da46e47c151b31fddf3a2dd738bab86b3c2621b70e","signature":"b57d90939f25075459a8c48c0d35497ae7c290b484c96ae5c5778b23854d19a2"},{"version":"bb0e9de7af06f884df1cec15482d8469e51f963db1ece3109b1dc5298008bce5","signature":"d2a441bffd3367af5c5590512d8cc04102a12a0a67ff93156a882a493bcbf258"},{"version":"fe93c474ab38ac02e30e3af073412b4f92b740152cf3a751fdaee8cbea982341","impliedFormat":1},{"version":"f5705d196b442afbdbd971b6e44bad96f4e32afb53cebfa2e5afe3140017bfc6","impliedFormat":1},{"version":"1e00b8bf9e3766c958218cd6144ffe08418286f89ff44ba5a2cc830c03dd22c7","impliedFormat":1},{"version":"9bd21af66ce1c07b186b1c83e3ec03912a9a406a7a9f3c5f09ac6aba7b410fc0","signature":"5147cc21763fa91684763c96bb0b95257dd5b03279fd278b81e491e2d698c08f"},{"version":"39ed50229f8f2388f110a4d7eb6facffd0e917998ba59fbb148e5098cba1712b","signature":"5ad15a76cc94574b12876b9fd1cbf06f017dbf2ac58f3f17a2aa1f9051ff7f91"},{"version":"c65535012157a588ee5966b3526a9005b8185383404fa6f355de5832e5f7c62c","signature":"fde025fc2f0267ff1a10b7ba7e5253b1b886f1b4d4690e8a680a4e0d6f08b949"},{"version":"284b1297261046628f90b4459a2915632c412ff801267c73c1ab61dd26b5b710","signature":"4700694dfabd3f749ec00d345f77a5aa63190cca29e959beb9eca57f7d96d1c6"},{"version":"d7dfba64b7350cb9501c544fe8ceba1b2455b42029d22b1a4fd02e94a6783525","impliedFormat":1},{"version":"89d819533e8122481433aeff2a85b35d114e748dc6a8d11c333bfd4057a48fdb","signature":"8a958e8c6bcf028cc74aeff5fac11781bbaed70dee7cbd7ca29d95189e080c01"},{"version":"25ae842cd02cf0c584e9b545b199ef8bc2674c67f777c58bb5cf266050d9642f","signature":"b1ef2d271870f3c7c06fae62ca5646f6799bf58a9fa9e7a9ff351eec33a258d6"},{"version":"9b1e01eff5a2c63c506459f203487a12fb70690addcd3fe1ed3f09240dedf615","signature":"332d56d78f1e87972a2a427be12c2e4ab481ca0709b4d59ac400c7b1e6fce39b"},{"version":"6d85da28ef11e7f8d4d7f6ee87d4f28c726c75640ae310fea64fbf401afa58e3","signature":"3307ca91efa66337ed5f124c8e7eec8cfe8cf236bc7dadcbfc24e35577d9f9c1"},{"version":"6a9e042b5ea7ec0c322b799752251d5e27996d696e5a7d19d56f4756d0587717","signature":"038cf7fe34455302e192185556008f40e9938f015de094c7c2c7ab217d39d72f"},{"version":"c401bbc85ee58999d47567599d3511498adf10139505be07f2fff061a5b1dd70","signature":"b3ddc19f865fc78b336d06c89bb3b05e74ebe4c51f53445bdb74991f74846938"},{"version":"47a5da1ee52e85b13cc52bead7bac9b6c53db2ee3f520249c7e196b4c2917f59","signature":"239de7357bee058760afe6d8108792c66f3e35cd9f74b288a5317c141e3826a8"},{"version":"35f88fa8aa6616cd3ff231d7ef23e662870edfeeec0c87380132046cb7e37fcf","signature":"95c9fc2db6883f82ff8fb831bff68963c9dcb03c24f01ff042dd164c2d9af95a"},{"version":"c52ff8df0dfac63645aa9fdc68fabce815af9d3240bcb4d47bd93afea380173a","signature":"b284163fc41515c6cfe9530355007a45d4c28470365b99c6183e264217b59579"},{"version":"e2ba525541d5cfd71bbbd97a30bbde2be8dcd11fd4d3a1eee3dad072050075a9","signature":"092374aeb61daadc515a42a6f40c67bdcdde191a08dd664004a4789a48e89f38"},{"version":"0869a9c69393872d8ccee845139b7e72bf2b5d7e2d4a78c40f236e6b194e0791","signature":"25d63bff8a28cded36f0376a12a21696a94acda33d56d99513ad2cf9c4526320"},{"version":"b1a0406b9dfa33c1fcde58ac88359785fb4e5e033b718c89db9277a95db7b33f","signature":"5f281db19dde2a1094deca240d123b07614040ed83755749c23f505f7cb696c3"},{"version":"37c7961117708394f64361ade31a41f96cef7f2a6606300821c72438dd4abda3","impliedFormat":1},{"version":"75f1e4ffacfea9f4baf4c1df6aebf18f7dac028c5e1a1300a7d17f5071e37c14","affectsGlobalScope":true,"impliedFormat":1},{"version":"64d4c41b11c1c817ddd39c4febdba05b560e4bdc4aef196ca48799b732ec8241","impliedFormat":1},{"version":"e4fdefba646eb133e52e30b00b3086f8849be02becb89c98b3ed4e873e40c8fc","impliedFormat":1},{"version":"9371f06c147aa728036fefa172736835c5a087878ad492b36dc7f203e540c894","signature":"409f56fe132fdc2a15a7270b97b8f905c75c7a5f516cd3fd136dda65a197928d"},{"version":"978ab6a6f17c73328140411e81a8555af847731ed84f2ad68f1d92269bec99ba","signature":"c0fb019da30d8017982c74080c2a701cc401f9bf382cef2acaf1a7a880309ee4"},{"version":"ee2cda2a4a6ac466ddc6a12e626cefb5cd978406c8d5749e317d355bf384b88e","signature":"c8595a3028054a81391eb13cbece5282d0dbb37201b4cf386987cf1f4c479541"},{"version":"41be406eb75caacf95f2f0ff2738d91544602c379f4f7d6ab8afb454459fbdc3","signature":"17039ba129dddb79d74c90ca1d24a420d76e3e500ba5aa751c0344eebe8e8d3b"},{"version":"897cd5facfb518de2ecefffde271c745f5d0e69e465ec86e08d1301bd7e4767f","signature":"e28f2da5c41867c69dae276b6b8a11bd26f7a7b77a5b40938a7859845a2015ad"},{"version":"454724f80c39d562d27ef70f6a2939719aabc4a2b0e47356f1fcdaeac5546350","signature":"641eeb4b08169270d3f3468c0324e6489ce451a60039682fbbfe83b1d492bd8d"},{"version":"da9383e3eeca4c154a754ee82de24bb468cc8f9bb04e86336e21c126be5f3370","signature":"2027705428ee4edd00a6e90fc94ce5764dea2bc4a2503b8c9ef5c13715b1e0c6"},{"version":"b8e05ba6a9c67b72879e079c6975de6937f9d171af54704792f1fa7753c95d60","signature":"b2e81e612c43c5e509192571e36e316b5bafa6f5e8c491805785fcb6653a2a34"},{"version":"b7b04a8ddaf0ab9f57987c78ac3f9e4df5d7f9486c68d3d290e71de3235b481f","signature":"ebdca8059ff329904fab7f1569f46e40044c4a16a1f70a80efe2a7b4f570ba3d"},{"version":"d1b860048758404b4b625c6085bb4ac0d5102c24421cdd0e72406d6804d3d67d","signature":"bdba373686ec354f9bc5932fab79386678c6febee1f6bc364bcd955a8611ec36"},{"version":"4ea0f12c7073fbc653339799b449df6a7835ef4baf1a9e0f30cd5703e77c7085","signature":"12044acd16d5b2a5dc81f8df268102683347b1ec93c46e974baa613a7134f0e4"},{"version":"42209b1bf2f29d57eaafce60a245e4f9ad1898eecce7c2f867a8d7d3aa653f7b","signature":"a1419afedcf9d8f154e0e22d498787c29c5993cdb44c69ae2f56dcf6e6346e44"},{"version":"5cd49f590b9caeca60abfea4b6b1a296138b7e492cb02b543b13018057ecc4cc","signature":"225dfb94d13b4642c00604dcc05306d2c19d33d4cfb2aae0aabdc8bddbcb1697"},{"version":"fff5f526e5fb1d6bf487e1095f8c202044c0a65d5c9076a130d28e623974f7a6","signature":"84ca1de61f8b09115d97cfbf2e552ea3fdf17cf6efe0655cd27d5e820209bbde"},{"version":"667746306a6ebab1036187de798a10fee2a2cceacf5dcf8870c9867ef34132e5","signature":"2f328f258c54e121e76f487a41dd5379eebc0bba8da2d0260b777137740deb05"},{"version":"526554383a7790a7447a267f6d623e8fe424616a53d07ca541b14d7eaf330af5","signature":"3acd7ea806d23aa450363c188d8a0eb865c3ccdb4751d6675a39c26d5b3d198d"},{"version":"feedd69e41495686698477d9c1a0411ce98d0a6b3bcad2bf801664a0a8d30f39","signature":"3e4030208e8cc1ec25f1593ecc6a40bfd88c1018b40228a40220a5ebb635314c"},{"version":"29f0fa7951272d9eea2844069cb4ca8751b65e332866dfa077f75b02ccf22548","signature":"da057b5c846f171a91fb976b39efa51cf27ee09edf3f0adad270b6e0a4cd38b6"},{"version":"a66f6f3581022ddea54c2cd14fa82c3a0e54fd0557ccb88c25b7dfc8a4c89335","signature":"eea097e50edac208d755e7768d7984d933ddde333f2565ee150b56fa5acc5797"},{"version":"51954e948be6a5b728fcfaf561f12331b4f54f068934c77adfc8f70eea17d285","impliedFormat":1},{"version":"724a631d72ff710f7e8dabc2e456881bced8ae22f195e25fcc5e2bb16ea3ee19","signature":"c6097d444c511ade3bd3345a0531d5d350a7e0fbe39eab7b8c6de56a67e60af7"},{"version":"06c75bd6d5cd8f1a825fc6c1b90ce2df2142ccc3c8082967bcb50d8fb1bf8c72","signature":"ed963e47702699d4127607ef32e41dde681d5aee87a5a51b171df37fb8a4bccd"},{"version":"bcb327cb6f8b40acd1b017b12c8c70800d3e62363511d249830dea2122d52396","signature":"49848f3a84cca37eb2a94fc7f6fc87c3276d17c48c0a58ad74ae04333700a0fb"},{"version":"35058c2d5e5f84fb98ce45b150c161d6bddc817996006160cb995f3126b67b84","signature":"64c4125837370638fc78107be4e6b5017ea055fd48c58ae7bc3a47d16cc2250d"},{"version":"907f89e2c490a50a1c63dd97926ed0f4b53dae2dd241990c31974b4b7282932f","signature":"f82eba081a99609db284634fc765a58c48cf7f3670ac9581552230d2a34cc897"},{"version":"cb1e04749d64eb1724595f2955096b8cc5b1684cd88874cf324693b79a4488ae","signature":"623deecda9a478cb5162910e5bd4d1d86c410ccb5cb4761d04fb2ca7aec0643c"},{"version":"e83fd6ceddd9eb354f6961e2f438941fd32a4b3b19bc8aece6badad4b2587c57","signature":"2b459d37838b7e053c8c4d33732673e70175e9d43a49622098509b4b43f09ef9"},{"version":"6158191fb8fcbf717c5f3a290ef6ccc183d3aaf6a5aeb9c0f39372578ed7f908","signature":"e89759ecc87619fe926593efb628afb8e81e8b3cdd564e8b31fadb0266fc145a"},{"version":"8f05fa539bb4680427998781bce99fb9f29683f56ef741e7a1f55076114026e4","signature":"78a129e6e078782c745733f077926158f6db6eae74cb59acdf5665d71c6702da"},{"version":"8458243cf37129089f24c4726dca1f07f166c5469b734863401a9220131e4e9a","affectsGlobalScope":true},{"version":"0b0617473b13361f4829b0957e91ca8f7c4baee9285b1aa148366e22e7850d1f","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},"d1986184a09a52db8228cb2bb2a61a8c05c9354e5b93cec8e2628d8579c892d7",{"version":"1881713bd143f422da792853b27761961dea0d5f3654c59be83c3640d2f7afc1","signature":"8e609bb71c20b858c77f0e9f90bb1319db8477b13f9f965f1a1e18524bf50881"},{"version":"151ff381ef9ff8da2da9b9663ebf657eac35c4c9a19183420c05728f31a6761d","impliedFormat":1},{"version":"f3d8c757e148ad968f0d98697987db363070abada5f503da3c06aefd9d4248c1","impliedFormat":1},{"version":"96d14f21b7652903852eef49379d04dbda28c16ed36468f8c9fa08f7c14c9538","impliedFormat":1}],"root":[526,527,[605,625],634,637,638,[642,645],[647,658],[663,681],[683,695]],"options":{"allowJs":true,"esModuleInterop":true,"jsx":4,"module":99,"skipLibCheck":true,"strict":true,"target":1},"referencedMap":[[694,1],[526,2],[695,3],[692,2],[693,4],[527,5],[271,2],[696,2],[697,2],[698,2],[154,6],[155,6],[156,7],[94,8],[157,9],[158,10],[159,11],[92,2],[160,12],[161,13],[162,14],[163,15],[164,16],[165,17],[166,17],[167,18],[168,19],[169,20],[170,21],[95,2],[93,2],[171,22],[172,23],[173,24],[213,25],[174,26],[175,27],[176,26],[177,28],[178,29],[179,30],[180,31],[181,31],[182,31],[183,32],[184,33],[185,34],[186,35],[187,36],[188,37],[189,37],[190,38],[191,2],[192,2],[193,39],[194,40],[195,39],[196,41],[197,42],[198,43],[199,44],[200,45],[201,46],[202,47],[203,48],[204,49],[205,50],[206,51],[207,52],[208,53],[209,54],[210,55],[96,26],[97,2],[98,56],[99,57],[100,2],[101,58],[102,2],[145,59],[146,60],[147,61],[148,61],[149,62],[150,2],[151,9],[152,63],[153,60],[211,64],[212,65],[214,66],[429,2],[215,67],[83,2],[85,68],[428,69],[288,69],[103,2],[84,2],[661,70],[662,71],[646,69],[660,72],[659,2],[475,73],[480,1],[470,74],[235,75],[275,76],[454,77],[270,78],[252,2],[427,2],[233,2],[443,79],[301,80],[234,2],[355,81],[278,82],[279,83],[426,84],[440,85],[337,86],[448,87],[449,88],[447,89],[446,2],[444,90],[277,91],[236,92],[380,2],[381,93],[307,94],[237,95],[308,94],[303,94],[224,94],[273,96],[272,2],[453,97],[465,2],[260,2],[402,98],[403,99],[397,69],[502,2],[405,2],[406,100],[398,101],[507,102],[506,103],[501,2],[322,2],[439,104],[438,2],[500,105],[399,69],[331,106],[327,107],[332,108],[330,2],[329,109],[328,2],[503,2],[499,2],[505,110],[504,2],[326,107],[494,111],[497,112],[316,113],[315,114],[314,115],[510,69],[313,116],[295,2],[513,2],[640,117],[639,2],[516,2],[515,69],[517,118],[217,2],[450,119],[451,120],[452,121],[230,2],[263,2],[229,122],[216,2],[418,69],[222,123],[417,124],[416,125],[407,2],[408,2],[415,2],[410,2],[413,126],[409,2],[411,127],[414,128],[412,127],[232,2],[227,2],[228,94],[283,2],[289,129],[290,130],[287,131],[285,132],[286,133],[281,2],[424,100],[310,100],[474,134],[481,135],[485,136],[457,137],[456,2],[298,2],[518,138],[469,139],[400,140],[401,141],[395,142],[386,2],[423,143],[459,69],[387,144],[425,145],[420,146],[419,2],[421,2],[392,2],[379,147],[458,148],[461,149],[389,150],[393,151],[384,152],[435,153],[468,154],[341,155],[356,156],[225,157],[467,158],[221,159],[291,160],[282,2],[292,161],[368,162],[280,2],[367,163],[91,2],[361,164],[262,2],[382,165],[357,2],[226,2],[256,2],[365,166],[231,2],[293,167],[391,168],[455,169],[390,2],[364,2],[284,2],[370,170],[371,171],[445,2],[373,172],[375,173],[374,174],[265,2],[363,157],[377,175],[340,176],[362,177],[369,178],[240,2],[244,2],[243,2],[242,2],[247,2],[241,2],[250,2],[249,2],[246,2],[245,2],[248,2],[251,179],[239,2],[349,180],[348,2],[353,181],[350,182],[352,183],[354,181],[351,182],[261,184],[311,185],[464,186],[519,2],[489,187],[491,188],[388,189],[490,190],[462,148],[404,148],[238,2],[342,191],[257,192],[258,193],[259,194],[255,195],[434,195],[305,195],[343,196],[306,196],[254,197],[253,2],[347,198],[346,199],[345,200],[344,201],[463,202],[433,203],[432,204],[396,205],[430,206],[431,206],[442,207],[441,208],[437,209],[339,210],[336,211],[338,212],[335,213],[376,214],[366,2],[479,2],[378,215],[436,2],[294,216],[385,119],[383,217],[296,218],[299,219],[514,2],[297,220],[300,220],[477,2],[476,2],[478,2],[512,2],[302,221],[460,2],[333,222],[325,69],[276,2],[220,223],[309,2],[483,69],[219,2],[493,224],[324,69],[487,100],[323,225],[472,226],[321,224],[223,2],[495,227],[319,69],[320,69],[312,2],[218,2],[318,228],[317,229],[264,230],[394,35],[304,35],[372,2],[359,231],[358,2],[422,107],[334,69],[466,122],[473,232],[86,69],[89,233],[90,234],[87,69],[88,2],[274,57],[269,235],[268,2],[267,236],[266,2],[471,237],[482,238],[484,239],[486,240],[641,241],[488,242],[492,243],[525,244],[496,244],[524,245],[498,246],[508,247],[509,248],[511,249],[520,250],[523,122],[522,2],[521,251],[360,252],[682,2],[81,2],[82,2],[13,2],[14,2],[16,2],[15,2],[2,2],[17,2],[18,2],[19,2],[20,2],[21,2],[22,2],[23,2],[24,2],[3,2],[25,2],[26,2],[4,2],[27,2],[31,2],[28,2],[29,2],[30,2],[32,2],[33,2],[34,2],[5,2],[35,2],[36,2],[37,2],[38,2],[6,2],[42,2],[39,2],[40,2],[41,2],[43,2],[7,2],[44,2],[49,2],[50,2],[45,2],[46,2],[47,2],[48,2],[8,2],[54,2],[51,2],[52,2],[53,2],[55,2],[9,2],[56,2],[57,2],[58,2],[60,2],[59,2],[61,2],[62,2],[10,2],[63,2],[64,2],[65,2],[11,2],[66,2],[67,2],[68,2],[69,2],[70,2],[1,2],[71,2],[72,2],[12,2],[76,2],[74,2],[79,2],[78,2],[73,2],[77,2],[75,2],[80,2],[121,253],[133,254],[119,255],[134,256],[143,257],[110,258],[111,259],[109,260],[142,251],[137,261],[141,262],[113,263],[130,264],[112,265],[140,266],[107,267],[108,261],[114,268],[115,2],[120,269],[118,268],[105,270],[144,271],[135,272],[124,273],[123,268],[125,274],[128,275],[122,276],[126,277],[138,251],[116,278],[117,279],[129,280],[106,256],[132,281],[131,268],[127,282],[136,2],[104,2],[139,283],[604,284],[598,285],[602,286],[599,286],[595,285],[603,287],[600,288],[601,286],[596,289],[597,290],[591,291],[535,292],[537,293],[590,2],[536,294],[594,295],[593,296],[592,297],[528,2],[538,292],[539,2],[530,298],[534,299],[529,2],[531,300],[532,301],[533,2],[540,302],[541,302],[542,302],[543,302],[544,302],[545,302],[546,302],[547,302],[548,302],[549,302],[550,302],[551,302],[552,302],[554,302],[553,302],[555,302],[556,302],[557,302],[558,302],[589,303],[559,302],[560,302],[561,302],[562,302],[563,302],[564,302],[565,302],[566,302],[567,302],[568,302],[569,302],[570,302],[571,302],[573,302],[572,302],[574,302],[575,302],[576,302],[577,302],[578,302],[579,302],[580,302],[581,302],[582,302],[583,302],[584,302],[585,302],[588,302],[586,302],[587,302],[636,304],[633,305],[630,306],[628,306],[631,306],[627,306],[632,306],[629,306],[635,306],[626,2],[610,307],[648,308],[651,309],[650,309],[653,310],[645,311],[654,312],[656,313],[655,314],[658,315],[642,316],[644,317],[669,318],[673,319],[681,320],[676,321],[677,317],[652,322],[649,323],[657,324],[647,325],[666,326],[643,327],[675,328],[670,329],[664,330],[687,330],[663,331],[688,329],[689,330],[683,332],[667,333],[684,334],[685,335],[671,336],[672,337],[668,338],[686,339],[665,340],[674,341],[680,342],[690,343],[679,344],[678,100],[691,331],[613,345],[612,346],[611,346],[615,347],[614,346],[616,348],[605,349],[619,350],[620,351],[621,352],[622,346],[624,353],[618,349],[625,354],[623,346],[617,349],[609,355],[607,346],[634,356],[637,357],[608,346],[638,358],[606,359]],"affectedFilesPendingEmit":[695,693,610,648,651,650,653,645,654,656,655,658,642,644,669,673,681,676,677,652,649,657,647,666,643,675,670,664,687,663,688,689,683,667,684,685,671,672,668,686,665,674,680,690,679,678,691,613,612,611,615,614,616,605,619,620,621,622,624,618,625,623,617,609,607,634,637,608,638,606],"version":"5.9.3"}

----------------------------------------------------------------
File: verify_schema.js
----------------------------------------------------------------
const { z } = require('zod');
const fs = require('fs');
const path = require('path');

const TopicSchema = z.object({
  id: z.string().min(1),
  label: z.string().min(1),
  prompt: z.string().min(1),
  order: z.number().int().positive(),
});

const DimensionSchema = z.object({
  id: z.string().min(1),
  title: z.string().min(1),
  order: z.number().int().positive(),
  topics: z.array(TopicSchema).refine((topics) => {
    const ids = topics.map((t) => t.id);
    return new Set(ids).size === ids.length;
  }, {
    message: "Topic IDs must be unique within a dimension",
  }),
});

const AssessmentSchema = z.object({
  version: z.number().int().positive(),
  dimensions: z.array(DimensionSchema).refine((dimensions) => {
    const ids = dimensions.map((d) => d.id);
    return new Set(ids).size === ids.length;
  }, {
    message: "Dimension IDs must be unique",
  }),
});

try {
  const questionsPath = path.join(process.cwd(), 'src/constants/questions.json');
  console.log('Reading:', questionsPath);
  const rawData = fs.readFileSync(questionsPath, 'utf-8');
  const json = JSON.parse(rawData);

  console.log('Validating...');
  const valid = AssessmentSchema.parse(json);
  console.log('Validation SUCCESS');
} catch (error) {
  console.error('Validation FAILED:', error);
  process.exit(1);
}


----------------------------------------------------------------
File: verify_schema.ts
----------------------------------------------------------------
import { validateAssessmentDefinition } from './src/lib/assessment/validate';
import * as fs from 'fs';
import * as path from 'path';

try {
  const questionsPath = path.join(process.cwd(), 'src/constants/questions.json');
  const rawData = fs.readFileSync(questionsPath, 'utf-8');
  const json = JSON.parse(rawData);

  const valid = validateAssessmentDefinition(json);
  console.log('Validation SUCCESS:', JSON.stringify(valid, null, 2));
} catch (error) {
  console.error('Validation FAILED:', error);
  process.exit(1);
}


